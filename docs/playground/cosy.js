var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.inherits=function(k,l){function u(){}u.prototype=l.prototype;k.superClass_=l.prototype;k.prototype=new u;k.prototype.constructor=k;for(var f in l)if("prototype"!=f)if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(l,f);n&&Object.defineProperty(k,f,n)}else k[f]=l[f]};$jscomp.owns=function(k,l){return Object.prototype.hasOwnProperty.call(k,l)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(k,l,u){k!=Array.prototype&&k!=Object.prototype&&(k[l]=u.value)};$jscomp.getGlobal=function(k){return"undefined"!=typeof window&&window===k?k:"undefined"!=typeof global&&null!=global?global:k};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(k,l,u,f){if(l){u=$jscomp.global;k=k.split(".");for(f=0;f<k.length-1;f++){var n=k[f];n in u||(u[n]={});u=u[n]}k=k[k.length-1];f=u[k];l=l(f);l!=f&&null!=l&&$jscomp.defineProperty(u,k,{configurable:!0,writable:!0,value:l})}};$jscomp.polyfill("Object.assign",function(k){return k?k:function(k,u){for(var f=1;f<arguments.length;f++){var n=arguments[f];if(n)for(var d in n)$jscomp.owns(n,d)&&(k[d]=n[d])}return k}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(k){return $jscomp.SYMBOL_PREFIX+(k||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var k=$jscomp.global.Symbol.iterator;k||(k=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[k]&&$jscomp.defineProperty(Array.prototype,k,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(k){var l=0;return $jscomp.iteratorPrototype(function(){return l<k.length?{done:!1,value:k[l++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(k){$jscomp.initSymbolIterator();k={next:k};k[$jscomp.global.Symbol.iterator]=function(){return this};return k};$jscomp.iteratorFromArray=function(k,l){$jscomp.initSymbolIterator();k instanceof String&&(k+="");var u=0,f={next:function(){if(u<k.length){var n=u++;return{value:l(n,k[n]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};
$jscomp.polyfill("Array.prototype.values",function(k){return k?k:function(){return $jscomp.iteratorFromArray(this,function(k,u){return u})}},"es6","es3");
$jscomp.polyfill("String.fromCodePoint",function(k){return k?k:function(k){for(var l="",f=0;f<arguments.length;f++){var n=Number(arguments[f]);if(0>n||1114111<n||n!==Math.floor(n))throw new RangeError("invalid_code_point "+n);65535>=n?l+=String.fromCharCode(n):(n-=65536,l+=String.fromCharCode(n>>>10&1023|55296),l+=String.fromCharCode(n&1023|56320))}return l}},"es6","es3");
$jscomp.polyfill("Array.prototype.keys",function(k){return k?k:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6","es3");$jscomp.checkStringArgs=function(k,l,u){if(null==k)throw new TypeError("The 'this' value for String.prototype."+u+" must not be null or undefined");if(l instanceof RegExp)throw new TypeError("First argument to String.prototype."+u+" must not be a regular expression");return k+""};
$jscomp.polyfill("String.prototype.startsWith",function(k){return k?k:function(k,u){var f=$jscomp.checkStringArgs(this,k,"startsWith");k+="";var n=f.length,d=k.length;u=Math.max(0,Math.min(u|0,f.length));for(var l=0;l<d&&u<n;)if(f[u++]!=k[l++])return!1;return l>=d}},"es6","es3");var $hx_exports="undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this;
(function(k){function l(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=k.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}function u(a){this.push(a)}$hx_exports.cosy=$hx_exports.cosy||{};$hx_exports.cosy.Cosy=$hx_exports.cosy.Cosy||{};var f=function(){return x.Boot.__string_rec(this,"")},n=n||{},d,y=function(a,b){this.r=new RegExp(a,b.split("u").join(""))};y.prototype.match=function(a){this.r.global&&
(this.r.lastIndex=0);this.r.m=this.r.exec(a);this.r.s=a;return null!=this.r.m};y.__name__=!0;Object.assign(y.prototype,{__class__:y});var q=function(){};q.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};q.substr=function(a,b,e){if(null==e)e=a.length;else if(0>e)if(0==b)e=a.length+e;else return"";return a.substr(b,e)};q.now=function(){return Date.now()};q.__name__=!0;Math.__name__=!0;var t=function(){};t.string=function(a){return x.Boot.__string_rec(a,"")};t.parseInt=function(a){if(null!=a)for(var b=
0,e=a.length;b<e;){var m=b++,d=a.charCodeAt(m);if(8>=d||14<=d&&32!=d&&45!=d)if(b=a.charCodeAt(m+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};t.random=function(a){return 0>=a?0:Math.floor(Math.random()*a)};t.__name__=!0;var w=function(){};w.isSpace=function(a,b){a=q.cca(a,b);return 8<a&&14>a?!0:32==a};w.ltrim=function(a){for(var b=a.length,e=0;e<b&&w.isSpace(a,e);)++e;return 0<e?q.substr(a,e,b-e):a};w.rtrim=function(a){for(var b=a.length,e=0;e<b&&w.isSpace(a,b-e-1);)++e;
return 0<e?q.substr(a,0,b-e):a};w.trim=function(a){return w.ltrim(w.rtrim(a))};w.replace=function(a,b,e){return a.split(b).join(e)};w.__name__=!0;var b={Error:function(a){this.message=a}};b.Error.__name__=!0;Object.assign(b.Error.prototype,{__class__:b.Error});var h=function(a){return b.Error.call(this,a)||this};$jscomp.inherits(h,b.Error);b.Break=h;b.Break.__name__=!0;b.Break.__super__=b.Error;Object.assign(b.Break.prototype,{__class__:b.Break});b.Callable=function(){};b.Callable.__name__=!0;Object.assign(b.Callable.prototype,
{__class__:b.Callable});h=function(a){return b.Error.call(this,a)||this};$jscomp.inherits(h,b.Error);b.Continue=h;b.Continue.__name__=!0;b.Continue.__super__=b.Error;Object.assign(b.Continue.prototype,{__class__:b.Continue});b.phases={};h=function(){this.locals=new g.ds.ObjectMap;this.globals=new b.Environment;this.globals.define("clock",new b.phases._Interpreter.ClockCallable);this.globals.define("random",new b.phases._Interpreter.RandomCallable);this.environment=this.globals};h.prototype.interpret=
function(a){try{for(var c=0;c<a.length;)this.execute(a[c++])}catch(e){if(a=g.Exception.caught(e).unwrap(),a instanceof b.RuntimeError)b.Cosy.runtimeError(a);else throw e;}};h.prototype.execute=function(a){switch(a._hx_index){case 0:this.executeBlock(a.statements,new b.Environment(this.environment));break;case 1:throw g.Exception.thrown(new b.Break);case 2:throw g.Exception.thrown(new b.Continue);case 3:this.evaluate(a.e);break;case 4:var c=a.keyword,e=a.name,m=a.body,d=this.evaluate(a.from);"number"!=
typeof d&&b.Cosy.error(b.ErrorDataType.Token(c),'Number expected in "from" clause of loop.');a=this.evaluate(a.to);"number"!=typeof a&&b.Cosy.error(b.ErrorDataType.Token(c),'Number expected in "to" clause of loop.');c=new b.Environment(this.environment);try{for(;d<a;){var p=d++;null!=e&&c.define(e.lexeme,p);try{this.executeBlock(m,c)}catch(r){if(!(g.Exception.caught(r).unwrap()instanceof b.Continue))throw r;}}}catch(r){if(!(g.Exception.caught(r).unwrap()instanceof b.Break))throw r;}break;case 5:p=
a.name;e=a.body;a=this.evaluate(a.array);m=new b.Environment(this.environment);try{for(d=0;d<a.length;){m.define(p.lexeme,a[d++]);try{this.executeBlock(e,m)}catch(r){if(!(g.Exception.caught(r).unwrap()instanceof b.Continue))throw r;}}}catch(r){if(!(g.Exception.caught(r).unwrap()instanceof b.Break))throw r;}break;case 6:p=a.cond;a=a.body;m=new b.Environment(this.environment);try{for(;;){d=void 0;null!=p?(e=this.evaluate(p),d=null==e?!1:"boolean"==typeof e?e:!0):d=!0;if(!d)break;try{this.executeBlock(a,
m)}catch(r){if(!(g.Exception.caught(r).unwrap()instanceof b.Continue))throw r;}}}catch(r){if(!(g.Exception.caught(r).unwrap()instanceof b.Break))throw r;}break;case 7:p=a.name;if(a.foreign){this.environment.define(p.lexeme,b.Cosy.foreignFunctions.h[p.lexeme]);break}this.environment.define(p.lexeme,new b.Function(p,a.params,a.body,this.environment,!1));break;case 8:p=a.el;e=this.evaluate(a.cond);(null==e?0:"boolean"==typeof e?e:1)?this.execute(a.then):null!=p&&this.execute(p);break;case 9:a=this.evaluate(a.e);
b.Cosy.println(null==a?"nil":""+(null==a?"null":t.string(a)));break;case 10:throw a=a.value,g.Exception.thrown(new b.Return(null==a?null:this.evaluate(a)));case 11:p=a.name;a=a.declarations;this.environment.define(p.lexeme,null);e=this.environment;this.environment=new b.Environment(this.environment);m=new g.ds.StringMap;for(d=0;d<a.length;){var f=a[d];++d;12==f._hx_index&&(c=f.init,f=f.name.lexeme,c=null!=c?this.evaluate(c):null,m.h[f]=c)}this.environment=e;this.environment.assign(p,new b.StructInstance(p,
m));break;case 12:p=a.name,e=a.init,a.foreign?this.environment.define(p.lexeme,b.Cosy.foreignVariables.h[p.lexeme]):(a=b.phases.Interpreter.uninitialized,null!=e&&(a=this.evaluate(e)),a instanceof b.StructInstance&&(a=a.clone()),this.environment.define(p.lexeme,a))}};h.prototype.resolve=function(a,b){this.locals.set(a,b)};h.prototype.executeBlock=function(a,b){var c=this.environment;try{this.environment=b;for(b=0;b<a.length;)this.execute(a[b++]);this.environment=c}catch(m){throw a=g.Exception.caught(m).unwrap(),
this.environment=c,g.Exception.thrown(a);}};h.prototype.plusEqual=function(a,c,e){if("number"==typeof a&&"number"==typeof e||"string"==typeof a&&"string"==typeof e)return a+e;throw g.Exception.thrown(new b.RuntimeError(c,"Operands "+this.getPrintableValue(a)+" and "+this.getPrintableValue(e)+" cannot be concatenated."));};h.prototype.getPrintableValue=function(a){return"string"==typeof a?'"'+(null==a?"null":t.string(a))+'"':a};h.prototype.resultingValue=function(a,c,e){switch(c.type._hx_index){case 13:if("number"!=
typeof a||"number"!=typeof e)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return a-e;case 15:return this.plusEqual(a,c,e);case 17:if("number"!=typeof a||"number"!=typeof e)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return a/e;case 19:if("number"!=typeof a||"number"!=typeof e)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return a*e;case 21:if("number"!=typeof a||"number"!=typeof e)throw g.Exception.thrown(new b.RuntimeError(c,
"Operand must be a number"));return a%e;case 24:return e;default:throw g.Exception.thrown("error");}};h.prototype.evaluate=function(a){switch(a._hx_index){case 0:a=a.exprs;for(var c=[],e=0;e<a.length;)c.push(this.evaluate(a[e++]));return c;case 1:c=a.name;e=a.op;var m=this.evaluate(a.value);e=24==e.type._hx_index?m:this.resultingValue(this.lookUpVariable(c,a),e,m);a=this.locals.h[a.__id__];null==a?this.globals.assign(c,e):this.environment.assignAt(a,c,e);return e;case 2:switch(c=a.op,e=this.evaluate(a.left),
a=this.evaluate(a.right),c.type._hx_index){case 12:if("number"!=typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e-a;case 14:return this.plusEqual(e,c,a);case 16:if("number"!=typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e/a;case 18:if("number"!=typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e*a;case 20:if("number"!=
typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e%a;case 23:return!(null==e&&null==a||(null==e?0:e==a));case 25:return null==e&&null==a?!0:null==e?!1:e==a;case 26:if("number"!=typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e>a;case 27:if("number"!=typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e>=a;case 28:if("number"!=
typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e<a;case 29:if("number"!=typeof e||"number"!=typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e<=a;default:throw g.Exception.thrown('Binary op type "'+t.string(c.type)+'" is unhandled!');}case 3:c=a.paren;e=a.$arguments;a=this.evaluate(a.callee);var d=l(this,this.evaluate);m=Array(e.length);for(var p=0,f=e.length;p<f;){var k=p++;m[k]=d(e[k])}if(x.Boot.__implements(a,
b.Callable)){if(!(a instanceof b.ForeignFunction)&&(e=a.arity(),m.length!=e))throw g.Exception.thrown(new b.RuntimeError(c,"Expected "+e+" argument(s) but got "+m.length+"."));return a.call(this,m)}throw g.Exception.thrown(new b.RuntimeError(c,"Can only call functions."));case 4:c=a.name;a=this.evaluate(a.obj);if(a instanceof Array)return this.arrayGet(a,c);if(a instanceof b.StructInstance)return a.get(c);if("string"==typeof a)return this.stringGet(a,c);throw g.Exception.thrown(new b.RuntimeError(c,
"Only instances have properties"));case 5:c=this.evaluate(a.obj);if(c instanceof Array){a=this.evaluate(a.index);if("number"!=typeof a||(a|0)!==a)throw g.Exception.thrown("Index must be an Int.");return c[a]}throw g.Exception.thrown("Bracket operator can only be used on arrays.");case 6:return this.evaluate(a.e);case 7:return a.v;case 8:switch(c=a.right,e=this.evaluate(a.left),a.op.type._hx_index){case 33:return(null==e?0:"boolean"==typeof e?e:1)?this.evaluate(c):e;case 44:return(null==e?0:"boolean"==
typeof e?e:1)?e:this.evaluate(c);default:return this.evaluate(c)}case 9:return this.lookUpVariable(a.name,a);case 10:c=a.name;e=a.value;m=this.evaluate(a.obj);if(m instanceof b.StructInstance)d=this.evaluate(e),m.set(c,this.resultingValue(m.get(c),a.op,d));else throw g.Exception.thrown(new b.RuntimeError(c,"Only instances have fields"));return e;case 11:c=a.op;e=a.value;m=this.evaluate(a.obj);if(m instanceof Array)a=this.evaluate(a.index),m[a]=this.resultingValue(m[a],c,this.evaluate(e));else throw g.Exception.thrown(new b.RuntimeError(c,
"Bracket notion is only allowed on arrays"));return e;case 12:e=a.name;c=a.decls;a=this.lookUpVariable(e,a);if(!(a instanceof b.StructInstance))throw g.Exception.thrown(new b.RuntimeError(e,"Struct initializer on non-struct object."));a=a.clone();for(e=0;e<c.length;)m=c[e],++e,1==m._hx_index&&a.set(m.name,this.evaluate(m.value));return a;case 13:a=a.parts;c=[];for(e=0;e<a.length;)c.push(this.evaluate(a[e++]));return c.join("");case 14:switch(c=a.op,a=this.evaluate(a.right),c.type._hx_index){case 12:if("number"!=
typeof a)throw g.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return-a;case 22:return!(null==a?0:"boolean"==typeof a?a:1);default:return null}case 15:return this.lookUpVariable(a.name,a);case 16:return new b.Function(null,a.params,a.body,this.environment,!1)}};h.prototype.arrayGet=function(a,c){var e=this;switch(c.lexeme){case "concat":return new b.phases._Interpreter.CustomCallable(1,function(b){b=b[0];for(var c=l(a,u),e=Array(b.length),m=0,d=b.length;m<d;){var f=m++;e[f]=c(b[f])}return e});
case "contains":return new b.phases._Interpreter.CustomCallable(1,function(b){return-1!=a.indexOf(b[0])});case "count":return new b.phases._Interpreter.CustomCallable(1,function(b){var c=0;b=b[0];for(var m=0;m<a.length;)b.call(e,[a[m++]])&&++c;return c});case "filter":return new b.phases._Interpreter.CustomCallable(1,function(b){b=b[0];for(var c=[],m=0;m<a.length;){var d=a[m];++m;b.call(e,[d])&&c.push(d)}return c});case "get":return new b.phases._Interpreter.CustomCallable(1,function(e){e=e[0];if(0>
e&&e>=a.length)throw g.Exception.thrown(new b.RuntimeError(c,"Array out of bounds (index "+e+" in array of length "+a.length+")."));return a[e]});case "length":return a.length;case "map":return new b.phases._Interpreter.CustomCallable(1,function(b){b=b[0];for(var c=[],d=0;d<a.length;)c.push(b.call(e,[a[d++]]));return c});case "pop":return new b.phases._Interpreter.CustomCallable(0,function(e){if(0==a.length)throw g.Exception.thrown(new b.RuntimeError(c,"Cannot pop from empty array."));return a.pop()});
case "push":return new b.phases._Interpreter.CustomCallable(1,function(b){for(var c=l(a,u),e=Array(b.length),d=0,m=b.length;d<m;){var f=d++;e[f]=c(b[f])}return e});case "set":return new b.phases._Interpreter.CustomCallable(2,function(e){var d=e[0];e=e[1];if(0>d&&d>=a.length)throw g.Exception.thrown(new b.RuntimeError(c,"Array out of bounds (index "+d+" in array of length "+a.length+")."));return a[d]=e});case "shift":return new b.phases._Interpreter.CustomCallable(0,function(e){if(0==a.length)throw g.Exception.thrown(new b.RuntimeError(c,
"Cannot shift from empty array."));return a.shift()});case "sort":return new b.phases._Interpreter.CustomCallable(1,function(b){var c=b[0];a.sort(function(a,b){return c.call(e,[a,b])});return a});case "sum":return new b.phases._Interpreter.CustomCallable(1,function(b){var c=0;b=b[0];for(var d=0;d<a.length;)c+=b.call(e,[a[d++]]);return c});default:throw g.Exception.thrown(new b.RuntimeError(c,'Undefined method "'+c.lexeme+'".'));}};h.prototype.stringGet=function(a,c){switch(c.lexeme){case "char_at":return new b.phases._Interpreter.CustomCallable(1,
function(b){return a.charAt(b[0])});case "char_code_at":return new b.phases._Interpreter.CustomCallable(1,function(b){return q.cca(a,b[0])});case "length":return a.length;case "replace":return new b.phases._Interpreter.CustomCallable(2,function(b){return w.replace(a,b[0],b[1])});case "split":return new b.phases._Interpreter.CustomCallable(1,function(b){return a.split(b[0])});case "substr":return new b.phases._Interpreter.CustomCallable(2,function(b){return q.substr(a,b[0]|0,b[1]|0)});default:throw g.Exception.thrown(new b.RuntimeError(c,
'Undefined method "'+c.lexeme+'".'));}};h.prototype.lookUpVariable=function(a,c){c=this.locals.h[c.__id__];c=null==c?this.globals.get(a):this.environment.getAt(c,a.lexeme);if(c==b.phases.Interpreter.uninitialized)throw g.Exception.thrown(new b.RuntimeError(a,'Accessing uninitialized variable "'+a.lexeme+'".'));return c};b.phases.Interpreter=h;b.phases.Interpreter.__name__=!0;Object.assign(b.phases.Interpreter.prototype,{__class__:b.phases.Interpreter});h=function(a){this.values=new g.ds.StringMap;
this.enclosing=a};h.prototype.define=function(a,b){this.values.h[a]=b};h.prototype.get=function(a){if(Object.prototype.hasOwnProperty.call(this.values.h,a.lexeme))return this.values.h[a.lexeme];if(null!=this.enclosing)return this.enclosing.get(a);throw g.Exception.thrown(new b.RuntimeError(a,'Undefined variable "'+a.lexeme+'".'));};h.prototype.getAt=function(a,b){return this.ancestor(a).values.h[b]};h.prototype.assign=function(a,c){if(Object.prototype.hasOwnProperty.call(this.values.h,a.lexeme))this.values.h[a.lexeme]=
c;else if(null!=this.enclosing)this.enclosing.assign(a,c);else throw g.Exception.thrown(new b.RuntimeError(a,'Undefined variable "'+a.lexeme+'".'));};h.prototype.assignAt=function(a,b,e){this.ancestor(a).values.h[b.lexeme]=e};h.prototype.ancestor=function(a){for(var b=this,e=0;e<a;)++e,b=b.enclosing;return b};b.Environment=h;b.Environment.__name__=!0;Object.assign(b.Environment.prototype,{__class__:b.Environment});b.phases._Interpreter={};h=function(){};h.prototype.arity=function(){return 0};h.prototype.call=
function(a,b){return q.now()/1E3*1E3};h.prototype.toString=function(){return"<native fn>"};b.phases._Interpreter.ClockCallable=h;b.phases._Interpreter.ClockCallable.__name__=!0;b.phases._Interpreter.ClockCallable.__interfaces__=[b.Callable];Object.assign(b.phases._Interpreter.ClockCallable.prototype,{__class__:b.phases._Interpreter.ClockCallable});h=function(){};h.prototype.arity=function(){return 0};h.prototype.call=function(a,b){return Math.random()};h.prototype.toString=function(){return"<native fn>"};
b.phases._Interpreter.RandomCallable=h;b.phases._Interpreter.RandomCallable.__name__=!0;b.phases._Interpreter.RandomCallable.__interfaces__=[b.Callable];Object.assign(b.phases._Interpreter.RandomCallable.prototype,{__class__:b.phases._Interpreter.RandomCallable});h=function(){};h.main=function(){b.Cosy.setFunction("random_int",function(a){return t.random(a[0])});b.Cosy.setFunction("floor",function(a){return Math.floor(a[0])});b.Cosy.setFunction("string_to_number",function(a){return t.parseInt(a[0])});
b.Cosy.setFunction("string_from_char_code",function(a){return String.fromCodePoint(a[0])})};h.println=function(a){k.console.log(a)};h.validate=function(a){b.Cosy.hadError=!1;a=(new b.phases.Parser((new b.phases.Scanner(a)).scanTokens())).parse();if(!b.Cosy.hadError){var c=new b.phases.Resolver(b.Cosy.interpreter);c.beginScope();c.resolveStmts(a);c.endScope();c=new b.phases.Typer;for(var e=0;e<a.length;)c.typeStmt(a[e++])}};h.setFunction=function(a,c){b.Cosy.foreignFunctions.h[a]=new b.ForeignFunction(c)};
h.setVariable=function(a,c){b.Cosy.foreignVariables.h[a]=c};h.round2=function(a,b){a*=Math.pow(10,b);return a=Math.round(a)/Math.pow(10,b)};h.startMeasure=function(a){b.Cosy.outputTimes&&(b.Cosy.measureStarts.h[a]=q.now()/1E3)};h.endMeasure=function(a){if(b.Cosy.outputTimes){if(!Object.prototype.hasOwnProperty.call(b.Cosy.measureStarts.h,a))throw g.Exception.thrown("Measurement for "+a+" has not been started");for(var c=1E3*(q.now()/1E3-b.Cosy.measureStarts.h[a]);15>a.length;)a+=" ";b.Cosy.measureOutput=
(b.Cosy.measureOutput+="\n\u00b7 ")+b.Cosy.color(""+a+" took\t"+b.Cosy.round2(c,3)+" ms",b.Color.Misc)}};h.run=function(a){b.Cosy.hadError=!1;b.Cosy.measureOutput=b.Cosy.color("Times:",b.Color.Misc);var c=q.now()/1E3;b.Cosy.startMeasure("Scanner");a=(new b.phases.Scanner(a)).scanTokens();b.Cosy.endMeasure("Scanner");b.Cosy.startMeasure("Parser");a=(new b.phases.Parser(a)).parse();b.Cosy.endMeasure("Parser");if(!b.Cosy.hadError){b.Cosy.startMeasure("Optimizer");a=(new b.phases.Optimizer).optimizeStmts(a);
b.Cosy.endMeasure("Optimizer");b.Cosy.startMeasure("Resolver");var e=new b.phases.Resolver(b.Cosy.interpreter);e.beginScope();e.resolveStmts(a);e.endScope();b.Cosy.endMeasure("Resolver");b.Cosy.startMeasure("Typer");e=new b.phases.Typer;for(var d=0;d<a.length;)e.typeStmt(a[d++]);b.Cosy.endMeasure("Typer");if(!b.Cosy.hadError&&!b.Cosy.validateOnly)if(b.Cosy.outputPrettyPrint)for(c=new b.phases.AstPrinter,e=0;e<a.length;)b.Cosy.println(c.printStmt(a[e++]));else if(b.Cosy.outputJavaScript)for(b.Cosy.println("// standard library\nconst clock = Date.now;\nconst string_from_char_code = String.fromCharCode;"),
c=new b.phases.JavaScriptPrinter,e=0;e<a.length;)b.Cosy.println(c.printStmt(a[e++]));else b.Cosy.outputMarkdown?(b.Cosy.println("# Cosy file"),b.Cosy.println("## Functions"),b.Cosy.println((new b.phases.MarkdownPrinter).printStatements(a))):(b.Cosy.startMeasure("AST interpreter"),b.Cosy.interpreter.interpret(a),b.Cosy.endMeasure("AST interpreter"),b.Cosy.outputTimes&&(b.Cosy.println("\n"+b.Cosy.measureOutput),b.Cosy.println(b.Cosy.color("Total: "+b.Cosy.round2(1E3*(q.now()/1E3-c),3)+" ms",b.Color.Misc))))}};
h.reportWarning=function(a,c,e){b.Cosy.println(b.Cosy.color("[line "+a+"] Warning "+c+": "+e,b.Color.Warning))};h.warning=function(a,c){switch(a._hx_index){case 0:b.Cosy.reportWarning(a.v,"",c);break;case 1:a=a.v,a.type==b.TokenType.Eof?b.Cosy.reportWarning(a.line,"at end",c):b.Cosy.reportWarning(a.line,'at "'+a.lexeme+'"',c)}};h.report=function(a,c,e){b.Cosy.println(b.Cosy.color("[line "+a+"] Error "+c+": "+e,b.Color.Error));b.Cosy.hadError=!0};h.error=function(a,c){switch(a._hx_index){case 0:b.Cosy.report(a.v,
"",c);break;case 1:a=a.v,a.type==b.TokenType.Eof?b.Cosy.report(a.line,"at end",c):b.Cosy.report(a.line,'at "'+a.lexeme+'"',c)}};h.hint=function(a,c){b.Cosy.println(b.Cosy.color("[line "+a.line+"] Hint: "+c,b.Color.Hint))};h.runtimeError=function(a){b.Cosy.println(b.Cosy.color("[line "+a.token.line+"] Runtime Error: "+a.message,b.Color.Error));b.Cosy.hadRuntimeError=!0};h.color=function(a,c){if(b.Cosy.noColors)return a;switch(c._hx_index){case 0:return"\u001b[1;31m"+a+"\u001b[0m";case 1:return"\u001b[0;33m"+
a+"\u001b[0m";case 2:return"\u001b[0;36m"+a+"\u001b[0m";case 3:return"\u001b[0;35m"+a+"\u001b[0m"}};b.Cosy=h;$hx_exports.cosy.Cosy.run=b.Cosy.run;$hx_exports.cosy.Cosy.setVariable=b.Cosy.setVariable;$hx_exports.cosy.Cosy.setFunction=b.Cosy.setFunction;$hx_exports.cosy.Cosy.validate=b.Cosy.validate;b.Cosy.__name__=!0;b.Color=n["cosy.Color"]={__ename__:!0,__constructs__:null,Error:{_hx_name:"Error",_hx_index:0,__enum__:"cosy.Color",toString:f},Warning:{_hx_name:"Warning",_hx_index:1,__enum__:"cosy.Color",
toString:f},Hint:{_hx_name:"Hint",_hx_index:2,__enum__:"cosy.Color",toString:f},Misc:{_hx_name:"Misc",_hx_index:3,__enum__:"cosy.Color",toString:f}};b.Color.__constructs__=[b.Color.Error,b.Color.Warning,b.Color.Hint,b.Color.Misc];b.ErrorDataType=n["cosy.ErrorDataType"]={__ename__:!0,__constructs__:null,Line:(d=function(a){return{_hx_index:0,v:a,__enum__:"cosy.ErrorDataType",toString:f}},d._hx_name="Line",d.__params__=["v"],d),Token:(d=function(a){return{_hx_index:1,v:a,__enum__:"cosy.ErrorDataType",
toString:f}},d._hx_name="Token",d.__params__=["v"],d)};b.ErrorDataType.__constructs__=[b.ErrorDataType.Line,b.ErrorDataType.Token];h=function(a){this.method=a};h.prototype.arity=function(){return 0};h.prototype.call=function(a,b){return this.method(b)};h.prototype.toString=function(){return"<foreign fn>"};b.ForeignFunction=h;b.ForeignFunction.__name__=!0;b.ForeignFunction.__interfaces__=[b.Callable];Object.assign(b.ForeignFunction.prototype,{__class__:b.ForeignFunction});h=function(){};h.bestMatches=
function(a,c,e){null==e&&(e=2);for(var d=[],v=0;v<c.length;){var f=c[v];++v;var g=b.EditDistance.editDistance(a,f);g<e?(e=g,d=[f]):g==e&&d.push(f)}d.sort(function(a,b){return a<b?-1:1});return d};h.editDistance=function(a,b){for(var c=[],d=0,v=a.length+1;d<v;){++d;for(var f=[],g=0,k=b.length+1;g<k;)++g,f.push(0);c.push(f)}d=0;for(v=a.length+1;d<v;)f=d++,c[f][0]=f;d=0;for(v=b.length+1;d<v;)f=d++,c[0][f]=f;d=1;for(v=a.length+1;d<v;)for(f=d++,g=1,k=b.length+1;g<k;){var h=g++;if(a.charAt(f-1)==b.charAt(h-
1))c[f][h]=c[f-1][h-1];else{var n=[1+c[f][h-1],1+c[f-1][h],1+c[f-1][h-1]];n.sort(function(a,b){return a-b});c[f][h]=n[0]}}return c[a.length][b.length]};b.EditDistance=h;b.EditDistance.__name__=!0;b.Expr=n["cosy.Expr"]={__ename__:!0,__constructs__:null,ArrayLiteral:(d=function(a,b){return{_hx_index:0,keyword:a,exprs:b,__enum__:"cosy.Expr",toString:f}},d._hx_name="ArrayLiteral",d.__params__=["keyword","exprs"],d),Assign:(d=function(a,b,e){return{_hx_index:1,name:a,op:b,value:e,__enum__:"cosy.Expr",
toString:f}},d._hx_name="Assign",d.__params__=["name","op","value"],d),Binary:(d=function(a,b,e){return{_hx_index:2,left:a,op:b,right:e,__enum__:"cosy.Expr",toString:f}},d._hx_name="Binary",d.__params__=["left","op","right"],d),Call:(d=function(a,b,e){return{_hx_index:3,callee:a,paren:b,$arguments:e,__enum__:"cosy.Expr",toString:f}},d._hx_name="Call",d.__params__=["callee","paren","$arguments"],d),Get:(d=function(a,b){return{_hx_index:4,obj:a,name:b,__enum__:"cosy.Expr",toString:f}},d._hx_name="Get",
d.__params__=["obj","name"],d),GetIndex:(d=function(a,b){return{_hx_index:5,obj:a,index:b,__enum__:"cosy.Expr",toString:f}},d._hx_name="GetIndex",d.__params__=["obj","index"],d),Grouping:(d=function(a){return{_hx_index:6,e:a,__enum__:"cosy.Expr",toString:f}},d._hx_name="Grouping",d.__params__=["e"],d),Literal:(d=function(a){return{_hx_index:7,v:a,__enum__:"cosy.Expr",toString:f}},d._hx_name="Literal",d.__params__=["v"],d),Logical:(d=function(a,b,e){return{_hx_index:8,left:a,op:b,right:e,__enum__:"cosy.Expr",
toString:f}},d._hx_name="Logical",d.__params__=["left","op","right"],d),MutArgument:(d=function(a,b){return{_hx_index:9,keyword:a,name:b,__enum__:"cosy.Expr",toString:f}},d._hx_name="MutArgument",d.__params__=["keyword","name"],d),Set:(d=function(a,b,e,d){return{_hx_index:10,obj:a,name:b,op:e,value:d,__enum__:"cosy.Expr",toString:f}},d._hx_name="Set",d.__params__=["obj","name","op","value"],d),SetIndex:(d=function(a,b,e,d){return{_hx_index:11,obj:a,index:b,op:e,value:d,__enum__:"cosy.Expr",toString:f}},
d._hx_name="SetIndex",d.__params__=["obj","index","op","value"],d),StructInit:(d=function(a,b){return{_hx_index:12,name:a,decls:b,__enum__:"cosy.Expr",toString:f}},d._hx_name="StructInit",d.__params__=["name","decls"],d),StringInterpolation:(d=function(a){return{_hx_index:13,parts:a,__enum__:"cosy.Expr",toString:f}},d._hx_name="StringInterpolation",d.__params__=["parts"],d),Unary:(d=function(a,b){return{_hx_index:14,op:a,right:b,__enum__:"cosy.Expr",toString:f}},d._hx_name="Unary",d.__params__=["op",
"right"],d),Variable:(d=function(a){return{_hx_index:15,name:a,__enum__:"cosy.Expr",toString:f}},d._hx_name="Variable",d.__params__=["name"],d),AnonFunction:(d=function(a,b,e){return{_hx_index:16,params:a,body:b,returnType:e,__enum__:"cosy.Expr",toString:f}},d._hx_name="AnonFunction",d.__params__=["params","body","returnType"],d)};b.Expr.__constructs__=[b.Expr.ArrayLiteral,b.Expr.Assign,b.Expr.Binary,b.Expr.Call,b.Expr.Get,b.Expr.GetIndex,b.Expr.Grouping,b.Expr.Literal,b.Expr.Logical,b.Expr.MutArgument,
b.Expr.Set,b.Expr.SetIndex,b.Expr.StructInit,b.Expr.StringInterpolation,b.Expr.Unary,b.Expr.Variable,b.Expr.AnonFunction];h=function(a,b,e,d,f){this.name=a;this.params=b;this.body=e;this.closure=d;this.isInitializer=f};h.prototype.arity=function(){return this.params.length};h.prototype.call=function(a,c){for(var e=new b.Environment(this.closure),d=0,f=this.params.length;d<f;){var p=d++;e.define(this.params[p].name.lexeme,c[p])}try{a.executeBlock(this.body,e)}catch(z){if(a=g.Exception.caught(z).unwrap(),
a instanceof b.Return){if(!this.isInitializer)return a.value}else throw z;}return this.isInitializer?this.closure.getAt(0,"this"):null};h.prototype.toString=function(){return null!=this.name?"<fn "+this.name.lexeme+">":"<fn>"};b.Function=h;b.Function.__name__=!0;b.Function.__interfaces__=[b.Callable];Object.assign(b.Function.prototype,{__class__:b.Function});h=function(a){var c=b.Error.call(this)||this;c.value=a;return c};$jscomp.inherits(h,b.Error);b.Return=h;b.Return.__name__=!0;b.Return.__super__=
b.Error;Object.assign(b.Return.prototype,{__class__:b.Return});h=function(a,c){c=b.Error.call(this,c)||this;c.token=a;return c};$jscomp.inherits(h,b.Error);b.RuntimeError=h;b.RuntimeError.__name__=!0;b.RuntimeError.__super__=b.Error;Object.assign(b.RuntimeError.prototype,{__class__:b.RuntimeError});b.Stmt=n["cosy.Stmt"]={__ename__:!0,__constructs__:null,Block:(d=function(a){return{_hx_index:0,statements:a,__enum__:"cosy.Stmt",toString:f}},d._hx_name="Block",d.__params__=["statements"],d),Break:(d=
function(a){return{_hx_index:1,keyword:a,__enum__:"cosy.Stmt",toString:f}},d._hx_name="Break",d.__params__=["keyword"],d),Continue:(d=function(a){return{_hx_index:2,keyword:a,__enum__:"cosy.Stmt",toString:f}},d._hx_name="Continue",d.__params__=["keyword"],d),Expression:(d=function(a){return{_hx_index:3,e:a,__enum__:"cosy.Stmt",toString:f}},d._hx_name="Expression",d.__params__=["e"],d),For:(d=function(a,b,e,d,v){return{_hx_index:4,keyword:a,name:b,from:e,to:d,body:v,__enum__:"cosy.Stmt",toString:f}},
d._hx_name="For",d.__params__=["keyword","name","from","to","body"],d),ForArray:(d=function(a,b,e){return{_hx_index:5,name:a,array:b,body:e,__enum__:"cosy.Stmt",toString:f}},d._hx_name="ForArray",d.__params__=["name","array","body"],d),ForCondition:(d=function(a,b,e){return{_hx_index:6,keyword:a,cond:b,body:e,__enum__:"cosy.Stmt",toString:f}},d._hx_name="ForCondition",d.__params__=["keyword","cond","body"],d),Function:(d=function(a,b,e,d,v){return{_hx_index:7,name:a,params:b,body:e,returnType:d,foreign:v,
__enum__:"cosy.Stmt",toString:f}},d._hx_name="Function",d.__params__=["name","params","body","returnType","foreign"],d),If:(d=function(a,b,e,d){return{_hx_index:8,keyword:a,cond:b,then:e,el:d,__enum__:"cosy.Stmt",toString:f}},d._hx_name="If",d.__params__=["keyword","cond","then","el"],d),Print:(d=function(a,b){return{_hx_index:9,keyword:a,e:b,__enum__:"cosy.Stmt",toString:f}},d._hx_name="Print",d.__params__=["keyword","e"],d),Return:(d=function(a,b){return{_hx_index:10,keyword:a,value:b,__enum__:"cosy.Stmt",
toString:f}},d._hx_name="Return",d.__params__=["keyword","value"],d),Struct:(d=function(a,b){return{_hx_index:11,name:a,declarations:b,__enum__:"cosy.Stmt",toString:f}},d._hx_name="Struct",d.__params__=["name","declarations"],d),Var:(d=function(a,b,e,d,v){return{_hx_index:12,name:a,type:b,init:e,mut:d,foreign:v,__enum__:"cosy.Stmt",toString:f}},d._hx_name="Var",d.__params__=["name","type","init","mut","foreign"],d)};b.Stmt.__constructs__=[b.Stmt.Block,b.Stmt.Break,b.Stmt.Continue,b.Stmt.Expression,
b.Stmt.For,b.Stmt.ForArray,b.Stmt.ForCondition,b.Stmt.Function,b.Stmt.If,b.Stmt.Print,b.Stmt.Return,b.Stmt.Struct,b.Stmt.Var];h=function(a,b){this.structName=a;this.fields=b};h.prototype.clone=function(){for(var a=new g.ds.StringMap,c=this.fields.h,e=Object.keys(c),d=e.length,f=0;f<d;){var p=e[f++],h=c[p];h instanceof b.StructInstance&&(h=h.clone());a.h[p]=h}return new b.StructInstance(this.structName,a)};h.prototype.get=function(a){if(Object.prototype.hasOwnProperty.call(this.fields.h,a.lexeme))return this.fields.h[a.lexeme];
throw g.Exception.thrown(new b.RuntimeError(a,'Undefined property "'+a.lexeme+'".'));};h.prototype.set=function(a,c){Object.prototype.hasOwnProperty.call(this.fields.h,a.lexeme)?this.fields.h[a.lexeme]=c:b.Cosy.error(b.ErrorDataType.Token(a),""+a.lexeme+" is not a property of "+a.lexeme)};h.prototype.toString=function(){for(var a=function(a){return"string"==typeof a?'"'+(null==a?"null":t.string(a))+'"':""+(null==a?"null":t.string(a))},b=[],e=this.fields.h,d=Object.keys(e),f=d.length,p=0;p<f;){var g=
d[p++];b.push(""+g+" = "+a(e[g]))}b.sort(function(a,b){return a<b?-1:b<a?1:0});return""+this.structName.lexeme+" { "+b.join(", ")+" }"};b.StructInstance=h;b.StructInstance.__name__=!0;Object.assign(b.StructInstance.prototype,{__class__:b.StructInstance});h=function(a,b,e,d){this.type=a;this.lexeme=b;this.literal=e;this.line=d};h.prototype.toString=function(){return"Token { type: "+t.string(this.type)+', lexeme: "'+this.lexeme+'", line: '+this.line+(null!=this.literal?", literal: "+(null==this.literal?
"null":t.string(this.literal)):"")+" }"};b.Token=h;b.Token.__name__=!0;Object.assign(b.Token.prototype,{__class__:b.Token});b.TokenType=n["cosy.TokenType"]={__ename__:!0,__constructs__:null,LeftParen:{_hx_name:"LeftParen",_hx_index:0,__enum__:"cosy.TokenType",toString:f},RightParen:{_hx_name:"RightParen",_hx_index:1,__enum__:"cosy.TokenType",toString:f},LeftBrace:{_hx_name:"LeftBrace",_hx_index:2,__enum__:"cosy.TokenType",toString:f},RightBrace:{_hx_name:"RightBrace",_hx_index:3,__enum__:"cosy.TokenType",
toString:f},LeftBracket:{_hx_name:"LeftBracket",_hx_index:4,__enum__:"cosy.TokenType",toString:f},RightBracket:{_hx_name:"RightBracket",_hx_index:5,__enum__:"cosy.TokenType",toString:f},StringInterpolationStart:{_hx_name:"StringInterpolationStart",_hx_index:6,__enum__:"cosy.TokenType",toString:f},StringInterpolationEnd:{_hx_name:"StringInterpolationEnd",_hx_index:7,__enum__:"cosy.TokenType",toString:f},Comma:{_hx_name:"Comma",_hx_index:8,__enum__:"cosy.TokenType",toString:f},Dot:{_hx_name:"Dot",_hx_index:9,
__enum__:"cosy.TokenType",toString:f},DotDot:{_hx_name:"DotDot",_hx_index:10,__enum__:"cosy.TokenType",toString:f},Underscore:{_hx_name:"Underscore",_hx_index:11,__enum__:"cosy.TokenType",toString:f},Minus:{_hx_name:"Minus",_hx_index:12,__enum__:"cosy.TokenType",toString:f},MinusEqual:{_hx_name:"MinusEqual",_hx_index:13,__enum__:"cosy.TokenType",toString:f},Plus:{_hx_name:"Plus",_hx_index:14,__enum__:"cosy.TokenType",toString:f},PlusEqual:{_hx_name:"PlusEqual",_hx_index:15,__enum__:"cosy.TokenType",
toString:f},Slash:{_hx_name:"Slash",_hx_index:16,__enum__:"cosy.TokenType",toString:f},SlashEqual:{_hx_name:"SlashEqual",_hx_index:17,__enum__:"cosy.TokenType",toString:f},Star:{_hx_name:"Star",_hx_index:18,__enum__:"cosy.TokenType",toString:f},StarEqual:{_hx_name:"StarEqual",_hx_index:19,__enum__:"cosy.TokenType",toString:f},Percent:{_hx_name:"Percent",_hx_index:20,__enum__:"cosy.TokenType",toString:f},PercentEqual:{_hx_name:"PercentEqual",_hx_index:21,__enum__:"cosy.TokenType",toString:f},Bang:{_hx_name:"Bang",
_hx_index:22,__enum__:"cosy.TokenType",toString:f},BangEqual:{_hx_name:"BangEqual",_hx_index:23,__enum__:"cosy.TokenType",toString:f},Equal:{_hx_name:"Equal",_hx_index:24,__enum__:"cosy.TokenType",toString:f},EqualEqual:{_hx_name:"EqualEqual",_hx_index:25,__enum__:"cosy.TokenType",toString:f},Greater:{_hx_name:"Greater",_hx_index:26,__enum__:"cosy.TokenType",toString:f},GreaterEqual:{_hx_name:"GreaterEqual",_hx_index:27,__enum__:"cosy.TokenType",toString:f},Less:{_hx_name:"Less",_hx_index:28,__enum__:"cosy.TokenType",
toString:f},LessEqual:{_hx_name:"LessEqual",_hx_index:29,__enum__:"cosy.TokenType",toString:f},Identifier:{_hx_name:"Identifier",_hx_index:30,__enum__:"cosy.TokenType",toString:f},String:{_hx_name:"String",_hx_index:31,__enum__:"cosy.TokenType",toString:f},Number:{_hx_name:"Number",_hx_index:32,__enum__:"cosy.TokenType",toString:f},And:{_hx_name:"And",_hx_index:33,__enum__:"cosy.TokenType",toString:f},Break:{_hx_name:"Break",_hx_index:34,__enum__:"cosy.TokenType",toString:f},Continue:{_hx_name:"Continue",
_hx_index:35,__enum__:"cosy.TokenType",toString:f},Else:{_hx_name:"Else",_hx_index:36,__enum__:"cosy.TokenType",toString:f},False:{_hx_name:"False",_hx_index:37,__enum__:"cosy.TokenType",toString:f},Fn:{_hx_name:"Fn",_hx_index:38,__enum__:"cosy.TokenType",toString:f},For:{_hx_name:"For",_hx_index:39,__enum__:"cosy.TokenType",toString:f},Foreign:{_hx_name:"Foreign",_hx_index:40,__enum__:"cosy.TokenType",toString:f},In:{_hx_name:"In",_hx_index:41,__enum__:"cosy.TokenType",toString:f},If:{_hx_name:"If",
_hx_index:42,__enum__:"cosy.TokenType",toString:f},Mut:{_hx_name:"Mut",_hx_index:43,__enum__:"cosy.TokenType",toString:f},Or:{_hx_name:"Or",_hx_index:44,__enum__:"cosy.TokenType",toString:f},Print:{_hx_name:"Print",_hx_index:45,__enum__:"cosy.TokenType",toString:f},Return:{_hx_name:"Return",_hx_index:46,__enum__:"cosy.TokenType",toString:f},Struct:{_hx_name:"Struct",_hx_index:47,__enum__:"cosy.TokenType",toString:f},True:{_hx_name:"True",_hx_index:48,__enum__:"cosy.TokenType",toString:f},Var:{_hx_name:"Var",
_hx_index:49,__enum__:"cosy.TokenType",toString:f},BooleanType:{_hx_name:"BooleanType",_hx_index:50,__enum__:"cosy.TokenType",toString:f},NumberType:{_hx_name:"NumberType",_hx_index:51,__enum__:"cosy.TokenType",toString:f},StringType:{_hx_name:"StringType",_hx_index:52,__enum__:"cosy.TokenType",toString:f},VoidType:{_hx_name:"VoidType",_hx_index:53,__enum__:"cosy.TokenType",toString:f},FunctionType:{_hx_name:"FunctionType",_hx_index:54,__enum__:"cosy.TokenType",toString:f},ArrayType:{_hx_name:"ArrayType",
_hx_index:55,__enum__:"cosy.TokenType",toString:f},Eof:{_hx_name:"Eof",_hx_index:56,__enum__:"cosy.TokenType",toString:f}};b.TokenType.__constructs__=[b.TokenType.LeftParen,b.TokenType.RightParen,b.TokenType.LeftBrace,b.TokenType.RightBrace,b.TokenType.LeftBracket,b.TokenType.RightBracket,b.TokenType.StringInterpolationStart,b.TokenType.StringInterpolationEnd,b.TokenType.Comma,b.TokenType.Dot,b.TokenType.DotDot,b.TokenType.Underscore,b.TokenType.Minus,b.TokenType.MinusEqual,b.TokenType.Plus,b.TokenType.PlusEqual,
b.TokenType.Slash,b.TokenType.SlashEqual,b.TokenType.Star,b.TokenType.StarEqual,b.TokenType.Percent,b.TokenType.PercentEqual,b.TokenType.Bang,b.TokenType.BangEqual,b.TokenType.Equal,b.TokenType.EqualEqual,b.TokenType.Greater,b.TokenType.GreaterEqual,b.TokenType.Less,b.TokenType.LessEqual,b.TokenType.Identifier,b.TokenType.String,b.TokenType.Number,b.TokenType.And,b.TokenType.Break,b.TokenType.Continue,b.TokenType.Else,b.TokenType.False,b.TokenType.Fn,b.TokenType.For,b.TokenType.Foreign,b.TokenType.In,
b.TokenType.If,b.TokenType.Mut,b.TokenType.Or,b.TokenType.Print,b.TokenType.Return,b.TokenType.Struct,b.TokenType.True,b.TokenType.Var,b.TokenType.BooleanType,b.TokenType.NumberType,b.TokenType.StringType,b.TokenType.VoidType,b.TokenType.FunctionType,b.TokenType.ArrayType,b.TokenType.Eof];b.VariableType=n["cosy.VariableType"]={__ename__:!0,__constructs__:null,Unknown:{_hx_name:"Unknown",_hx_index:0,__enum__:"cosy.VariableType",toString:f},Void:{_hx_name:"Void",_hx_index:1,__enum__:"cosy.VariableType",
toString:f},Boolean:{_hx_name:"Boolean",_hx_index:2,__enum__:"cosy.VariableType",toString:f},Number:{_hx_name:"Number",_hx_index:3,__enum__:"cosy.VariableType",toString:f},Text:{_hx_name:"Text",_hx_index:4,__enum__:"cosy.VariableType",toString:f},Instance:{_hx_name:"Instance",_hx_index:5,__enum__:"cosy.VariableType",toString:f},Function:(d=function(a,b){return{_hx_index:6,paramTypes:a,returnType:b,__enum__:"cosy.VariableType",toString:f}},d._hx_name="Function",d.__params__=["paramTypes","returnType"],
d),Array:(d=function(a){return{_hx_index:7,type:a,__enum__:"cosy.VariableType",toString:f}},d._hx_name="Array",d.__params__=["type"],d),Struct:(d=function(a){return{_hx_index:8,variables:a,__enum__:"cosy.VariableType",toString:f}},d._hx_name="Struct",d.__params__=["variables"],d),NamedStruct:(d=function(a){return{_hx_index:9,name:a,__enum__:"cosy.VariableType",toString:f}},d._hx_name="NamedStruct",d.__params__=["name"],d),Mutable:(d=function(a){return{_hx_index:10,type:a,__enum__:"cosy.VariableType",
toString:f}},d._hx_name="Mutable",d.__params__=["type"],d)};b.VariableType.__constructs__=[b.VariableType.Unknown,b.VariableType.Void,b.VariableType.Boolean,b.VariableType.Number,b.VariableType.Text,b.VariableType.Instance,b.VariableType.Function,b.VariableType.Array,b.VariableType.Struct,b.VariableType.NamedStruct,b.VariableType.Mutable];d=function(){};d.formatType=function(a,c){null==c&&(c=!0);switch(a._hx_index){case 0:return c?"":"Unknown";case 2:return"Bool";case 3:return"Num";case 4:return"Str";
case 6:var e=a.paramTypes;a=a.returnType;for(var d=[],f=0;f<e.length;)d.push(b.VariableTypeTools.formatType(e[f++]));return"Fn("+d.join(", ")+") "+b.VariableTypeTools.formatType(a,c);case 7:return w.trim("Array "+b.VariableTypeTools.formatType(a.type));default:return""+t.string(a)}};b.VariableTypeTools=d;b.VariableTypeTools.__name__=!0;d=function(){this.indentAmount=0};d.prototype.indent=function(){for(var a=[],b=0,e=this.indentAmount;b<e;)++b,a.push("    ");return a.join("")};d.prototype.printStmts=
function(a){for(var b=[],e=0;e<a.length;){var d=a[e++];b.push(this.indent()+this.printStmt(d))}return b.join("\n")};d.prototype.printBlock=function(a){this.indentAmount++;a=this.printStmts(a);this.indentAmount--;return"{\n"+a+"\n"+this.indent()+"}"};d.prototype.printExprs=function(a){for(var b=[],e=0;e<a.length;){var d=a[e++];b.push(this.indent()+this.printExpr(d))}return b.join("\n")};d.prototype.printExprBlock=function(a){this.indentAmount++;a=this.printExprs(a);this.indentAmount--;return"{\n"+
a+"\n"+this.indent()+"}"};d.prototype.printStmt=function(a){switch(a._hx_index){case 0:return this.printBlock(a.statements);case 1:return a.keyword.lexeme;case 2:return a.keyword.lexeme;case 3:return""+this.printExpr(a.e);case 4:var c=a.name;return"for "+(null!=c?c.lexeme+" in ":"")+this.printExpr(a.from)+".."+this.printExpr(a.to)+" "+this.printBlock(a.body);case 5:return"for "+a.name.lexeme+" in "+this.printExpr(a.array)+" "+this.printBlock(a.body);case 6:return c=a.cond,""+a.keyword.lexeme+" "+
(null!=c?this.printExpr(c):"")+" "+this.printBlock(a.body);case 7:c=a.foreign;var e=""+(c?"foreign fn":"fn")+" "+a.name.lexeme,d=this.formatParams(a.params),f=b.VariableTypeTools.formatType(a.returnType.annotated,!0);""!=f&&(f=" "+f);return c?""+e+"("+d+")"+f:""+e+"("+d+")"+f+" "+this.printBlock(a.body);case 8:return c=a.el,""+a.keyword.lexeme+" "+this.printExpr(a.cond)+" "+this.printStmt(a.then)+(null!=c?" else "+this.printStmt(c):"");case 9:return""+a.keyword.lexeme+" "+this.printExpr(a.e);case 10:return c=
a.value,a.keyword.lexeme+(null!=c?" "+this.printExpr(c):"");case 11:return"struct "+a.name.lexeme+" "+this.printBlock(a.declarations);case 12:return c=a.init,""+(a.foreign?"foreign ":"")+(a.mut?"mut":"var")+" "+a.name.lexeme+(null!=c?" = "+this.printExpr(c):"")}};d.prototype.printExpr=function(a){switch(a._hx_index){case 0:var c=a.exprs;a=[];for(var e=0;e<c.length;)a.push(this.printExpr(c[e++]));return"["+a.join(",")+"]";case 1:return""+a.name.lexeme+" "+a.op.lexeme+" "+this.printExpr(a.value);case 2:return""+
this.printExpr(a.left)+" "+a.op.lexeme+" "+this.printExpr(a.right);case 3:c=a.$arguments;a=""+this.printExpr(a.callee)+"(";e=[];for(var d=0;d<c.length;)e.push(this.printExpr(c[d++]));return a+e.join(", ")+")";case 4:return""+this.printExpr(a.obj)+"."+a.name.lexeme;case 5:return""+this.printExpr(a.obj)+"["+this.printExpr(a.index)+"]";case 6:return"("+this.printExpr(a.e)+")";case 7:return c=a.v,"string"==typeof c?"'"+(null==c?"null":t.string(c))+"'":""+(null==c?"null":t.string(c));case 8:return""+this.printExpr(a.left)+
" "+(44==a.op.type._hx_index?"or":"and")+" "+this.printExpr(a.right);case 9:return"mut "+a.name.lexeme;case 10:return""+this.printExpr(a.obj)+"."+a.name.lexeme+" "+a.op.lexeme+" "+this.printExpr(a.value);case 11:return""+this.printExpr(a.obj)+"["+this.printExpr(a.index)+"] "+a.op.lexeme+" "+this.printExpr(a.value);case 12:return this.printExprBlock(a.decls);case 13:c=a.parts;a=[];for(e=0;e<c.length;)d=this.printExpr(c[e++]),a.push(0==(e-1)%2?q.substr(d,1,d.length-2):"{"+d+"}");return"'"+a.join("")+
"'";case 14:return""+a.op.lexeme+this.printExpr(a.right);case 15:return a.name.lexeme;case 16:return c=this.formatParams(a.params),e=this.printStmt(b.Stmt.Block(a.body)),a=b.VariableTypeTools.formatType(a.returnType.annotated,!0),""!=a&&(a=" "+a),"fn("+c+")"+a+" "+e}};d.prototype.formatParams=function(a){for(var b=[],e=0;e<a.length;)b.push(this.formatParam(a[e++]));return b.join(", ")};d.prototype.formatParam=function(a){var c=b.VariableTypeTools.formatType(a.type,!0);""!=c&&(c=" "+c);return a.name.lexeme+
c};b.phases.AstPrinter=d;b.phases.AstPrinter.__name__=!0;Object.assign(b.phases.AstPrinter.prototype,{__class__:b.phases.AstPrinter});d=function(a,b){this.arityValue=a;this.method=b};d.prototype.arity=function(){return this.arityValue};d.prototype.call=function(a,b){return this.method(b)};d.prototype.toString=function(){return"<native fn>"};b.phases._Interpreter.CustomCallable=d;b.phases._Interpreter.CustomCallable.__name__=!0;b.phases._Interpreter.CustomCallable.__interfaces__=[b.Callable];Object.assign(b.phases._Interpreter.CustomCallable.prototype,
{__class__:b.phases._Interpreter.CustomCallable});d=function(){this.indentAmount=0};d.prototype.indent=function(){for(var a=[],b=0,e=this.indentAmount;b<e;)++b,a.push("    ");return a.join("")};d.prototype.printBlock=function(a){this.indentAmount++;for(var b=[],e=0;e<a.length;){var d=a[e++];b.push(this.indent()+this.printStmt(d))}a=b.join("\n");this.indentAmount--;return"{\n"+a+"\n"+this.indent()+"}"};d.prototype.printStmt=function(a){switch(a._hx_index){case 0:return this.printBlock(a.statements);
case 1:return"break;";case 2:return"continue;";case 3:return""+this.printExpr(a.e)+";";case 4:var c=a.name;c=null!=c?c.lexeme:"__i";return"for (var "+c+" = "+this.printExpr(a.from)+"; "+c+" < "+this.printExpr(a.to)+"; "+c+"++) "+this.printBlock(a.body);case 5:return"for ("+a.name.lexeme+" of "+this.printExpr(a.array)+") "+this.printBlock(a.body);case 6:return c=a.cond,"while ("+(null!=c?this.printExpr(c):"true")+") "+this.printBlock(a.body);case 7:c=a.params;var e=a.body;if(a.foreign)return"";a="function "+
a.name.lexeme;for(var d=[],f=0;f<c.length;)d.push(c[f++].name.lexeme);return""+a+"("+d.join(",")+") "+this.printStmt(b.Stmt.Block(e));case 8:return c=a.el,"if ("+this.printExpr(a.cond)+") "+this.printStmt(a.then)+(null!=c?" else "+this.printStmt(c):"");case 9:return"console.log("+this.printExpr(a.e)+");";case 10:return a=a.value,"return"+(null!=a?" "+this.printExpr(a):"")+";";case 11:return"// "+a.name.lexeme+" struct";case 12:return c=a.init,a.foreign?"":""+(a.mut?"var":"const")+" "+a.name.lexeme+
(null!=c?" = "+this.printExpr(c):"")+";"}};d.prototype.std_function_get_map=function(a){a=a.lexeme;switch(a){case "char_at":return"charAt";case "char_code_at":return"charCodeAt";default:return a}};d.prototype.std_function_map=function(a){return"floor"==a?"Math.floor":a};d.prototype.printExpr=function(a){switch(a._hx_index){case 0:var c=a.exprs;a=l(this,this.printExpr);for(var e=Array(c.length),d=0,f=c.length;d<f;){var g=d++;e[g]=a(c[g])}return"["+e.join(", ")+"]";case 1:return""+a.name.lexeme+" "+
a.op.lexeme+" "+this.printExpr(a.value);case 2:return c=a.op,""+this.printExpr(a.left)+" "+(25==c.type._hx_index?"===":c.lexeme)+" "+this.printExpr(a.right);case 3:c=a.$arguments;a=""+this.std_function_map(this.printExpr(a.callee))+"(";e=l(this,this.printExpr);d=Array(c.length);f=0;for(g=c.length;f<g;){var h=f++;d[h]=e(c[h])}return a+d.join(",")+")";case 4:return""+this.printExpr(a.obj)+"."+this.std_function_get_map(a.name);case 5:return""+this.printExpr(a.obj)+"["+this.printExpr(a.index)+"]";case 6:return"("+
this.printExpr(a.e)+")";case 7:return c=a.v,null==c?"null":"string"==typeof c?'"'+(null==c?"null":t.string(c))+'"':""+(null==c?"null":t.string(c));case 8:return""+this.printExpr(a.left)+" "+(44==a.op.type._hx_index?"||":"&&")+" "+this.printExpr(a.right);case 9:return a.name.lexeme;case 10:return""+this.printExpr(a.obj)+"."+a.name.lexeme+" "+a.op.lexeme+" "+this.printExpr(a.value);case 11:return""+this.printExpr(a.obj)+"["+this.printExpr(a.index)+"] "+a.op.lexeme+" "+this.printExpr(a.value);case 12:c=
a.decls;a=[];for(e=0;e<c.length;)a.push(w.replace(this.printExpr(c[e++])," = ",": "));return"{ "+a.join(", ")+" }";case 13:c=a.parts;a=[];for(e=0;e<c.length;)d=this.printExpr(c[e++]),a.push(0==(e-1)%2?q.substr(d,1,d.length-2):"${"+d+"}");return"`"+a.join("")+"`";case 14:return""+a.op.lexeme+this.printExpr(a.right);case 15:return a.name.lexeme;case 16:c=a.params;a=a.body;e=[];for(d=0;d<c.length;)e.push(c[d++].name.lexeme);return"function ("+e.join(", ")+") "+this.printStmt(b.Stmt.Block(a))}};b.phases.JavaScriptPrinter=
d;b.phases.JavaScriptPrinter.__name__=!0;Object.assign(b.phases.JavaScriptPrinter.prototype,{__class__:b.phases.JavaScriptPrinter});d=function(){this.astPrinter=new b.phases.AstPrinter};d.prototype.print=function(a){this.result+=""+a+"\n"};d.prototype.printStatements=function(a){this.result="";for(var b=0;b<a.length;)this.printStmt(a[b++]);return this.result};d.prototype.printStmt=function(a){switch(a._hx_index){case 0:for(var c=a.statements,e=0;e<c.length;)this.printStmt(c[e++]);break;case 7:c=a.name;
var d=a.params;e=a.body;var f=a.returnType;if(!a.foreign){a=[];for(var g=0;g<d.length;){var h=d[g];++g;a.push(""+h.name.lexeme+" "+b.VariableTypeTools.formatType(h.type))}d=a.join(", ");this.print("### `"+c.lexeme+"("+d+") "+b.VariableTypeTools.formatType(f.computed)+"`");this.print("Annotated return type: "+b.VariableTypeTools.formatType(f.annotated)+"\n");this.print("Computed return type: "+b.VariableTypeTools.formatType(f.computed)+"\n");this.print("<details>\n<summary>Code</summary>\n\n```js\n"+
this.astPrinter.printStmts(e)+"\n```\n</details>\n\n")}}};b.phases.MarkdownPrinter=d;b.phases.MarkdownPrinter.__name__=!0;Object.assign(b.phases.MarkdownPrinter.prototype,{__class__:b.phases.MarkdownPrinter});d=function(){};d.prototype.optimizeStmts=function(a){for(var b=[],e=0;e<a.length;)b.push(this.optimizeStmt(a[e++]));return b};d.prototype.optimizeStmt=function(a){switch(a._hx_index){case 0:return b.Stmt.Block(this.optimizeStmts(a.statements));case 3:return b.Stmt.Expression(this.optimizeExpr(a.e));
case 8:var c=a.el;return b.Stmt.If(a.keyword,this.optimizeExpr(a.cond),this.optimizeStmt(a.then),null!=c?this.optimizeStmt(c):null);case 9:return b.Stmt.Print(a.keyword,this.optimizeExpr(a.e));case 10:return c=a.value,b.Stmt.Return(a.keyword,null!=c?this.optimizeExpr(c):null);case 12:return c=a.init,b.Stmt.Var(a.name,a.type,null!=c?this.optimizeExpr(c):c,a.mut,a.foreign);default:return a}};d.prototype.optimizeExpr=function(a){switch(a._hx_index){case 2:var c=a.op,e=this.optimizeExpr(a.left);a=this.optimizeExpr(a.right);
if(7==e._hx_index){var d=e.v;if(7==a._hx_index){var f=a.v;if("number"==typeof d&&"number"==typeof f){switch(c.type._hx_index){case 12:c=d-f;break;case 14:c=d+f;break;case 16:c=d/f;break;case 18:c=d*f;break;case 20:c=d%f;break;case 23:c=d!=f;break;case 25:c=d==f;break;case 26:c=d>f;break;case 27:c=d>=f;break;case 28:c=d<f;break;case 29:c=d<=f;break;default:return b.Cosy.error(b.ErrorDataType.Token(c),"Invalid operator."),b.Expr.Binary(e,c,a)}return b.Expr.Literal(c)}return"string"==typeof d&&"string"==
typeof f?b.Expr.Literal(d+f):b.Expr.Binary(e,c,a)}}return b.Expr.Binary(e,c,a);case 8:c=a.op;e=this.optimizeExpr(a.left);a=this.optimizeExpr(a.right);if(7==e._hx_index&&(d=e.v,7==a._hx_index&&(f=a.v,"boolean"==typeof d&&"boolean"==typeof f))){switch(c.type._hx_index){case 33:c=d&&f;break;case 44:c=d||f;break;default:return b.Cosy.error(b.ErrorDataType.Token(c),"Invalid operator."),b.Expr.Binary(e,c,a)}return b.Expr.Literal(c)}return b.Expr.Logical(e,c,a);case 13:c=a.parts;e=l(this,this.optimizeExpr);
a=Array(c.length);d=0;for(f=c.length;d<f;){var g=d++;a[g]=e(c[g])}return b.Expr.StringInterpolation(a);default:return a}};b.phases.Optimizer=d;b.phases.Optimizer.__name__=!0;Object.assign(b.phases.Optimizer.prototype,{__class__:b.phases.Optimizer});d=function(a){this.current=0;this.structNames=[];this.tokens=a};d.prototype.parse=function(){for(var a=[];!this.isAtEnd();)a.push(this.declaration());return a};d.prototype.expression=function(){return this.assignment()};d.prototype.declaration=function(){try{if(this.match([b.TokenType.Struct]))return this.structDeclaration();
var a=this.match([b.TokenType.Foreign]);return this.match([b.TokenType.Fn])?this.func("function",a):this.match([b.TokenType.Var])?this.varDeclaration(!1,a):this.match([b.TokenType.Mut])?this.varDeclaration(!0,a):this.statement()}catch(c){if(g.Exception.caught(c).unwrap()instanceof b.phases._Parser.ParseError)return this.synchronize(),null;throw c;}};d.prototype.statement=function(){return this.match([b.TokenType.For])?this.forStatement():this.match([b.TokenType.If])?this.ifStatement():this.match([b.TokenType.Print])?
this.printStatement():this.match([b.TokenType.Return])?this.returnStatement():this.match([b.TokenType.Break])?b.Stmt.Break(this.previous()):this.match([b.TokenType.Continue])?b.Stmt.Continue(this.previous()):this.match([b.TokenType.LeftBrace])?b.Stmt.Block(this.block()):this.expressionStatement()};d.prototype.forStatement=function(){if(this.checkUntil(b.TokenType.DotDot,b.TokenType.LeftBrace)){var a=this.previous(),c=null;this.check(b.TokenType.Identifier)&&(c=this.consume(b.TokenType.Identifier,
"Expect variable name."),c.lexeme.startsWith("_")&&this.error(c,"Loop counters cannot be marked as unused. Use `for min...max` syntax instead."),this.consume(b.TokenType.In,'Expect "in" after for loop identifier.'));var e=this.expression();this.consume(b.TokenType.DotDot,'Expect ".." between from and to numbers.');var d=this.expression();this.consume(b.TokenType.LeftBrace,'Expect "{" before loop body.');return b.Stmt.For(a,c,e,d,this.block())}if(this.checkUntil(b.TokenType.In,b.TokenType.LeftBrace))return a=
this.consume(b.TokenType.Identifier,"Expect variable name."),this.consume(b.TokenType.In,'Expect "in" after for loop identifier.'),c=this.expression(),this.consume(b.TokenType.LeftBrace,'Expect "{" before loop body.'),b.Stmt.ForArray(a,c,this.block());a=this.previous();c=this.check(b.TokenType.LeftBrace)?null:this.expression();this.consume(b.TokenType.LeftBrace,'Expect "{" before loop body.');return b.Stmt.ForCondition(a,c,this.block())};d.prototype.ifStatement=function(){return b.Stmt.If(this.previous(),
this.expression(),this.statement(),this.match([b.TokenType.Else])?this.statement():null)};d.prototype.printStatement=function(){return b.Stmt.Print(this.previous(),this.expression())};d.prototype.returnStatement=function(){return b.Stmt.Return(this.previous(),this.match([b.TokenType.Underscore])?null:this.expression())};d.prototype.expressionStatement=function(){return b.Stmt.Expression(this.expression())};d.prototype.block=function(){for(var a=[];!this.check(b.TokenType.RightBrace)&&!this.isAtEnd();)a.push(this.declaration());
this.consume(b.TokenType.RightBrace,'Expect "}" after block.');return a};d.prototype.varDeclaration=function(a,c){var e=this.consume(b.TokenType.Identifier,"Expect variable name."),d=this.paramType(),f=null;!c&&this.match([b.TokenType.Equal])&&(f=this.expression());return b.Stmt.Var(e,d,f,a,c)};d.prototype.structDeclaration=function(){var a=this.consume(b.TokenType.Identifier,"Expect struct name");this.consume(b.TokenType.LeftBrace,'Expect "{" before struct body.');for(var c=[];!this.check(b.TokenType.RightBrace)&&
!this.isAtEnd();)if(this.match([b.TokenType.Var]))c.push(this.varDeclaration(!1,!1));else if(this.match([b.TokenType.Mut]))c.push(this.varDeclaration(!0,!1));else{b.Cosy.error(b.ErrorDataType.Token(this.tokens[this.current]),"Structs can only contain variable definitions.");break}this.structNames.push(a.lexeme);this.consume(b.TokenType.RightBrace,'Expect "}" after struct body.');return b.Stmt.Struct(a,c)};d.prototype.func=function(a,c){var e=this.consume(b.TokenType.Identifier,"Expect "+a+" name.");
a=this.funcBody(a,c);if(16==a._hx_index)return b.Stmt.Function(e,a.params,a.body,a.returnType,c);throw g.Exception.thrown(new b.RuntimeError(e,"Invalid function declaration."));};d.prototype.paramType=function(){if(this.match([b.TokenType.BooleanType]))return b.VariableType.Boolean;if(this.match([b.TokenType.NumberType]))return b.VariableType.Number;if(this.match([b.TokenType.StringType]))return b.VariableType.Text;if(this.match([b.TokenType.VoidType]))return b.VariableType.Void;if(this.match([b.TokenType.FunctionType])){this.consume(b.TokenType.LeftParen,
'Expect "(" after Fun.');for(var a=[];!this.check(b.TokenType.RightParen)&&(a.push(this.paramType()),this.match([b.TokenType.Comma])););this.consume(b.TokenType.RightParen,'Expect ")" after parameters.');var c=this.paramType();0==c._hx_index&&(c=b.VariableType.Void);return b.VariableType.Function(a,c)}return this.match([b.TokenType.ArrayType])?b.VariableType.Array(this.paramType()):this.check(b.TokenType.Identifier)&&-1!=this.structNames.indexOf(this.peek().lexeme)?b.VariableType.NamedStruct(this.advance().lexeme):
b.VariableType.Unknown};d.prototype.funcBody=function(a,c){this.consume(b.TokenType.LeftParen,'Expect "(" after '+a+" name.");var e=[];if(!this.check(b.TokenType.RightParen))for(;;){255<=e.length&&this.error(this.peek(),"Cannot have more than 255 parameters.");var d=this.match([b.TokenType.Mut]),f=this.consume(b.TokenType.Identifier,"Expect parameter name."),g=this.paramType();if(d){switch(g._hx_index){case 0:break;case 7:break;case 9:break;default:this.error(f,"Only struct and array parameters can be marked as `mut`.")}g=
b.VariableType.Mutable(g)}e.push({name:f,type:g});if(!this.match([b.TokenType.Comma]))break}this.consume(b.TokenType.RightParen,'Expect ")" after parameters.');d=this.paramType();if(c)return b.Expr.AnonFunction(e,[],{annotated:d});this.consume(b.TokenType.LeftBrace,'Expect "{" before '+a+" body");return b.Expr.AnonFunction(e,this.block(),{annotated:d})};d.prototype.assignment=function(){var a=this.or();if(this.match([b.TokenType.Equal,b.TokenType.PlusEqual,b.TokenType.MinusEqual,b.TokenType.SlashEqual,
b.TokenType.StarEqual,b.TokenType.PercentEqual])){var c=this.previous(),e=this.assignment();switch(a._hx_index){case 4:return b.Expr.Set(a.obj,a.name,c,e);case 5:return b.Expr.SetIndex(a.obj,a.index,c,e);case 15:return b.Expr.Assign(a.name,c,e)}this.error(c,"Invalid assignment target.")}return a};d.prototype.or=function(){for(var a=this.and();this.match([b.TokenType.Or]);)a=b.Expr.Logical(a,this.previous(),this.and());return a};d.prototype.and=function(){for(var a=this.equality();this.match([b.TokenType.And]);)a=
b.Expr.Logical(a,this.previous(),this.equality());return a};d.prototype.equality=function(){for(var a=this.comparison();this.match([b.TokenType.BangEqual,b.TokenType.EqualEqual]);)a=b.Expr.Binary(a,this.previous(),this.comparison());return a};d.prototype.comparison=function(){for(var a=this.addition();this.match([b.TokenType.Greater,b.TokenType.GreaterEqual,b.TokenType.Less,b.TokenType.LessEqual]);)a=b.Expr.Binary(a,this.previous(),this.addition());return a};d.prototype.addition=function(){for(var a=
this.multiplication();this.match([b.TokenType.Minus,b.TokenType.Plus]);)a=b.Expr.Binary(a,this.previous(),this.multiplication());return a};d.prototype.multiplication=function(){for(var a=this.unary();this.match([b.TokenType.Star,b.TokenType.Slash,b.TokenType.Percent]);)a=b.Expr.Binary(a,this.previous(),this.multiplication());return a};d.prototype.unary=function(){return this.match([b.TokenType.Bang,b.TokenType.Minus])?b.Expr.Unary(this.previous(),this.unary()):this.call()};d.prototype.call=function(){for(var a=
this.primary();;)if(this.match([b.TokenType.LeftParen]))a=this.finishCall(a);else if(this.match([b.TokenType.Dot]))a=b.Expr.Get(a,this.consume(b.TokenType.Identifier,'Expect property name after ".".'));else if(this.match([b.TokenType.LeftBracket]))a=b.Expr.GetIndex(a,this.expression()),this.consume(b.TokenType.RightBracket,'Expect "}" after array indexing.');else break;return a};d.prototype.finishCall=function(a){var c=[];if(!this.check(b.TokenType.RightParen))for(;255<=c.length&&this.error(this.peek(),
"Cannot have more than 255 arguments"),c.push(this.expression()),this.match([b.TokenType.Comma]););return b.Expr.Call(a,this.consume(b.TokenType.RightParen,'Expect ")" after arguments.'),c)};d.prototype.primary=function(){if(this.match([b.TokenType.False]))return b.Expr.Literal(!1);if(this.match([b.TokenType.True]))return b.Expr.Literal(!0);if(this.match([b.TokenType.Number]))return b.Expr.Literal(this.previous().literal);if(this.match([b.TokenType.String]))return this.string();if(this.match([b.TokenType.Fn]))return this.funcBody("function",
!1);if(this.match([b.TokenType.Identifier]))return this.identifier();if(this.match([b.TokenType.Mut]))return b.Expr.MutArgument(this.previous(),this.consume(b.TokenType.Identifier,'Expect variable name after "mut".'));if(this.match([b.TokenType.LeftParen])){var a=this.expression();this.consume(b.TokenType.RightParen,'Expect ")" after expression.');return b.Expr.Grouping(a)}if(this.match([b.TokenType.LeftBracket]))return this.arrayLiteral();throw g.Exception.thrown(this.error(this.peek(),"Expect expression."));
};d.prototype.arrayLiteral=function(){for(var a=this.previous(),c=[];!this.check(b.TokenType.RightBracket)&&!this.isAtEnd();)c.push(this.expression()),this.check(b.TokenType.RightBracket)||this.consume(b.TokenType.Comma,'Expect "," between array values.');this.consume(b.TokenType.RightBracket,'Expect "]" after array literal.');return b.Expr.ArrayLiteral(a,c)};d.prototype.identifier=function(){var a=this.previous();if(this.check(b.TokenType.LeftBrace)&&-1!=this.structNames.indexOf(a.lexeme)){this.consume(b.TokenType.LeftBrace,
'Expect "{" after struct name.');for(var c=[];!this.match([b.TokenType.RightBrace])&&!this.isAtEnd();)c.push(this.assignment()),this.check(b.TokenType.RightBrace)||this.consume(b.TokenType.Comma,'Expect "," between variable initializers.');return b.Expr.StructInit(a,c)}return b.Expr.Variable(a)};d.prototype.string=function(){var a=b.Expr.Literal(this.previous().literal);if(this.check(b.TokenType.StringInterpolationStart)){for(a=[a];this.match([b.TokenType.StringInterpolationStart])?(a.push(this.expression()),
this.consume(b.TokenType.StringInterpolationEnd,'Expect "}" after string interpolation start.')):this.match([b.TokenType.String])?a.push(this.string()):this.error(this.peek(),"Unexpected token in string interpolation."),this.check(b.TokenType.StringInterpolationStart)||this.check(b.TokenType.String););return b.Expr.StringInterpolation(a)}return a};d.prototype.consume=function(a,b){if(this.check(a))return this.advance();throw g.Exception.thrown(this.error(this.peek(),b));};d.prototype.match=function(a){for(var b=
0;b<a.length;)if(this.check(a[b++]))return this.advance(),!0;return!1};d.prototype.check=function(a){return this.isAtEnd()?!1:this.peek().type==a};d.prototype.checkUntil=function(a,c){for(var e=this.current;;){if(this.tokens[e].type==a)return!0;++e;if(this.tokens[e].type==c||this.tokens[e].type==b.TokenType.Eof)break}return!1};d.prototype.advance=function(){this.isAtEnd()||this.current++;return this.previous()};d.prototype.isAtEnd=function(){return this.peek().type==b.TokenType.Eof};d.prototype.peek=
function(){return this.tokens[this.current]};d.prototype.previous=function(){return this.tokens[this.current-1]};d.prototype.error=function(a,c){b.Cosy.error(b.ErrorDataType.Token(a),c);return new b.phases._Parser.ParseError};d.prototype.synchronize=function(){for(this.advance();!this.isAtEnd();)switch(this.peek().type._hx_index){case 34:case 35:case 38:case 39:case 40:case 42:case 45:case 46:case 47:case 49:return;default:this.advance()}};b.phases.Parser=d;b.phases.Parser.__name__=!0;Object.assign(b.phases.Parser.prototype,
{__class__:b.phases.Parser});b.phases._Parser={};d=function(a){return b.Error.call(this,a)||this};$jscomp.inherits(d,b.Error);b.phases._Parser.ParseError=d;b.phases._Parser.ParseError.__name__=!0;b.phases._Parser.ParseError.__super__=b.Error;Object.assign(b.phases._Parser.ParseError.prototype,{__class__:b.phases._Parser.ParseError});d=function(a){this.currentStruct=b.phases._Resolver.StructType.None;this.currentFunction=b.phases._Resolver.FunctionType.None;this.scopes=[];this.snakeCaseRegex=new y("^[_a-z0-9]*$",
"");this.interpreter=a};d.prototype.resolveStmts=function(a){for(var c=null,e=0;e<a.length;){var d=a[e];++e;switch(d._hx_index){case 1:c=d.keyword;break;case 2:c=d.keyword;break;case 10:c=d.keyword;break;default:null!=c&&(b.Cosy.error(b.ErrorDataType.Token(c),"Unreachable code after return statement."),c=null)}this.resolveStmt(d)}};d.prototype.resolveStmt=function(a){switch(a._hx_index){case 0:this.beginScope();this.resolveStmts(a.statements);this.endScope();break;case 3:this.resolveExpr(a.e);break;
case 4:var c=a.name,e=a.body;this.resolveExpr(a.from);this.resolveExpr(a.to);this.beginScope();null!=c&&(this.snakeCaseRegex.match(c.lexeme)||b.Cosy.error(b.ErrorDataType.Token(c),"Loop variable names must use snake_case."),this.declare(c),this.define(c));0==e.length&&b.Cosy.error(b.ErrorDataType.Token(a.keyword),"Loop body is empty.");this.resolveStmts(e);this.endScope();break;case 5:c=a.name;e=a.body;this.resolveExpr(a.array);this.beginScope();this.declare(c);this.define(c);0==e.length&&b.Cosy.error(b.ErrorDataType.Token(c),
"Loop body is empty.");this.resolveStmts(e);this.endScope();break;case 6:c=a.cond;null!=c&&this.resolveExpr(c);this.beginScope();this.resolveStmts(a.body);this.endScope();break;case 7:c=a.name;(e=a.foreign)&&!Object.prototype.hasOwnProperty.call(b.Cosy.foreignFunctions.h,c.lexeme)&&b.Cosy.error(b.ErrorDataType.Token(c),"Foreign function not set.");this.snakeCaseRegex.match(c.lexeme)||b.Cosy.error(b.ErrorDataType.Token(c),"Function names must use snake_case.");this.declare(c);this.define(c);this.resolveFunction(c,
a.params,a.body,b.phases._Resolver.FunctionType.Function,e);break;case 8:c=a.cond;e=a.el;if(7==c._hx_index){var d=c.v;"boolean"==typeof d&&b.Cosy.error(b.ErrorDataType.Token(a.keyword),"This condition is always "+(null==d?"null":t.string(d))+".")}this.resolveExpr(c);this.resolveStmt(a.then);null!=e&&this.resolveStmt(e);break;case 9:this.resolveExpr(a.e);break;case 10:c=a.keyword;a=a.value;this.currentFunction==b.phases._Resolver.FunctionType.None&&b.Cosy.error(b.ErrorDataType.Token(c),"Cannot return from top-level code.");
null!=a&&(this.currentFunction==b.phases._Resolver.FunctionType.Initializer&&b.Cosy.error(b.ErrorDataType.Token(c),"Cannot return value from an initializer."),this.resolveExpr(a));break;case 11:c=a.name;this.declare(c);this.define(c);this.currentStruct=b.phases._Resolver.StructType.Struct;this.beginScope();this.resolveStmts(a.declarations);this.endScope();this.currentStruct=b.phases._Resolver.StructType.None;break;case 12:c=a.name;e=a.init;d=a.mut;a.foreign&&!Object.prototype.hasOwnProperty.call(b.Cosy.foreignVariables.h,
c.lexeme)&&b.Cosy.error(b.ErrorDataType.Token(c),"Foreign variable not set.");this.snakeCaseRegex.match(c.lexeme)||b.Cosy.error(b.ErrorDataType.Token(c),"Variable names must use snake_case.");var f=1==this.currentStruct._hx_index;this.markTypeAsRead(a.type);this.declare(c,d,f);null!=e?this.resolveExpr(e):d||f||b.Cosy.error(b.ErrorDataType.Token(c),"Non-mutable variables must be initialized.");this.define(c,d,f)}};d.prototype.resolveExpr=function(a){switch(a._hx_index){case 0:a=a.exprs;for(var c=0;c<
a.length;)this.resolveExpr(a[c++]);break;case 1:c=a.name;var e=this.findInScopes(c);null==e||e.mutable||b.Cosy.error(b.ErrorDataType.Token(c),"Cannot reassign non-mutable variable.");this.resolveExpr(a.value);this.resolveLocal(a,c,!1);break;case 2:this.resolveExpr(a.left);this.resolveExpr(a.right);break;case 3:c=a.$arguments;this.resolveExpr(a.callee);for(a=0;a<c.length;)this.resolveExpr(c[a++]);break;case 4:this.resolveExpr(a.obj);break;case 5:this.resolveExpr(a.obj);this.resolveExpr(a.index);break;
case 6:this.resolveExpr(a.e);break;case 8:this.resolveExpr(a.left);this.resolveExpr(a.right);break;case 9:this.resolveLocal(a,a.name,!0);break;case 10:e=a.obj;c=a.name;this.resolveExpr(a.value);this.resolveExpr(e);switch(e._hx_index){case 4:break;case 15:a=this.findInScopes(e.name);null==a||a.mutable||b.Cosy.error(b.ErrorDataType.Token(c),"Cannot reassign properties on non-mutable struct.");break;default:throw g.Exception.thrown("this is unexpected");}break;case 11:this.resolveExpr(a.obj);this.resolveExpr(a.index);
this.resolveExpr(a.value);break;case 12:c=a.name;e=a.decls;for(var d=0;d<e.length;){var f=e[d];++d;1==f._hx_index&&this.resolveExpr(f.value)}this.resolveLocal(a,c,!0);break;case 13:a=a.parts;for(c=0;c<a.length;)this.resolveExpr(a[c++]);break;case 14:this.resolveExpr(a.right);break;case 15:c=a.name;e=this.scopes;Object.prototype.hasOwnProperty.call(e[e.length-1].h,c.lexeme)?(e=this.scopes,e=0==e[e.length-1].h[c.lexeme].state._hx_index):e=!1;e&&b.Cosy.error(b.ErrorDataType.Token(c),"Cannot read local variable in its own initializer");
c.lexeme.startsWith("_")&&b.Cosy.error(b.ErrorDataType.Token(c),"Variables starting with _ are considered unused.");this.resolveLocal(a,c,!0);break;case 16:this.resolveFunction(null,a.params,a.body,b.phases._Resolver.FunctionType.Function,!1)}};d.prototype.markTypeAsRead=function(a){switch(a._hx_index){case 7:this.markTypeAsRead(a.type);break;case 9:a=a.name;for(var c=this.scopes.length-1;0<=c;){var e=this.scopes[c];if(Object.prototype.hasOwnProperty.call(e.h,a)){e.h[a].state=b.phases._Resolver.VariableState.Read;
break}--c}}};d.prototype.resolveFunction=function(a,b,e,d,f){a=this.currentFunction;this.currentFunction=d;this.beginScope();for(d=0;d<b.length;){var c=b[d];++d;var m=10==c.type._hx_index;this.declare(c.name,m);f||this.define(c.name,m)}this.resolveStmts(e);this.endScope();this.currentFunction=a};d.prototype.beginScope=function(){this.scopes.push(new g.ds.StringMap)};d.prototype.endScope=function(){for(var a=this.scopes.pop().h,c=Object.keys(a),e=c.length,d=0;d<e;){var f=a[c[d++]];f.name.lexeme.startsWith("_")||
f.member||1!=f.state._hx_index||b.Cosy.error(b.ErrorDataType.Token(f.name),"Local variable is not used.")}};d.prototype.declare=function(a,c,e){null==e&&(e=!1);null==c&&(c=!1);var d=this.scopes;d=d[d.length-1];Object.prototype.hasOwnProperty.call(d.h,a.lexeme)?b.Cosy.error(b.ErrorDataType.Token(a),"Variable with this name already declared in this scope."):null!=this.findInScopes(a)&&b.Cosy.error(b.ErrorDataType.Token(a),"Shadows existing variable.");d.h[a.lexeme]={name:a,state:b.phases._Resolver.VariableState.Declared,
mutable:c,member:e}};d.prototype.define=function(a,c,e){null==e&&(e=!1);null==c&&(c=!1);var d=this.scopes;d[d.length-1].h[a.lexeme]={name:a,state:b.phases._Resolver.VariableState.Defined,mutable:c,member:e}};d.prototype.resolveLocal=function(a,c,e){for(var d=[],f=this.scopes.length-1;0<=f;){var g=this.scopes[f];if(Object.prototype.hasOwnProperty.call(g.h,c.lexeme)){this.interpreter.resolve(a,this.scopes.length-1-f);e&&(g.h[c.lexeme].state=b.phases._Resolver.VariableState.Read);return}g=Object.keys(g.h);
for(var h=g.length,k=0;k<h;)d.push(g[k++]);--f}if("clock"!=c.lexeme&&"random"!=c.lexeme){a=b.EditDistance.bestMatches(c.lexeme,d);e="Variable not declared in this scope.";if(0<a.length){e=Array(a.length);d=0;for(f=a.length;d<f;)g=d++,e[g]='"'+a[g]+'"';a=e.pop();e="Variable not declared in this scope."+(" Did you mean "+(0<e.length?e.join(", ")+" or "+a:a)+"?")}b.Cosy.error(b.ErrorDataType.Token(c),e)}};d.prototype.findInScopes=function(a){a=a.lexeme;for(var b=this.scopes.length-1;0<=b;){var e=this.scopes[b];
if(Object.prototype.hasOwnProperty.call(e.h,a))return e.h[a];--b}return null};b.phases.Resolver=d;b.phases.Resolver.__name__=!0;Object.assign(b.phases.Resolver.prototype,{__class__:b.phases.Resolver});b.phases._Resolver={};b.phases._Resolver.VariableState=n["cosy.phases._Resolver.VariableState"]={__ename__:!0,__constructs__:null,Declared:{_hx_name:"Declared",_hx_index:0,__enum__:"cosy.phases._Resolver.VariableState",toString:f},Defined:{_hx_name:"Defined",_hx_index:1,__enum__:"cosy.phases._Resolver.VariableState",
toString:f},Read:{_hx_name:"Read",_hx_index:2,__enum__:"cosy.phases._Resolver.VariableState",toString:f}};b.phases._Resolver.VariableState.__constructs__=[b.phases._Resolver.VariableState.Declared,b.phases._Resolver.VariableState.Defined,b.phases._Resolver.VariableState.Read];b.phases._Resolver.FunctionType=n["cosy.phases._Resolver.FunctionType"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"cosy.phases._Resolver.FunctionType",toString:f},Method:{_hx_name:"Method",
_hx_index:1,__enum__:"cosy.phases._Resolver.FunctionType",toString:f},Initializer:{_hx_name:"Initializer",_hx_index:2,__enum__:"cosy.phases._Resolver.FunctionType",toString:f},Function:{_hx_name:"Function",_hx_index:3,__enum__:"cosy.phases._Resolver.FunctionType",toString:f}};b.phases._Resolver.FunctionType.__constructs__=[b.phases._Resolver.FunctionType.None,b.phases._Resolver.FunctionType.Method,b.phases._Resolver.FunctionType.Initializer,b.phases._Resolver.FunctionType.Function];b.phases._Resolver.StructType=
n["cosy.phases._Resolver.StructType"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"cosy.phases._Resolver.StructType",toString:f},Struct:{_hx_name:"Struct",_hx_index:1,__enum__:"cosy.phases._Resolver.StructType",toString:f}};b.phases._Resolver.StructType.__constructs__=[b.phases._Resolver.StructType.None,b.phases._Resolver.StructType.Struct];d=function(a){this.interpolationMode=!1;this.line=1;this.start=this.current=0;this.tokens=[];this.source=a};d.prototype.scanTokens=
function(){for(;this.current<this.source.length;){this.start=this.current;var a=this.advance();switch(a){case 10:this.line++;break;case 9:case 13:case 32:break;case 33:a=this.match(61)?b.TokenType.BangEqual:b.TokenType.Bang;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 37:a=this.match(61)?b.TokenType.PercentEqual:b.TokenType.Percent;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 39:this.string();
break;case 40:this.tokens.push(new b.Token(b.TokenType.LeftParen,this.source.substring(this.start,this.current),null,this.line));break;case 41:this.tokens.push(new b.Token(b.TokenType.RightParen,this.source.substring(this.start,this.current),null,this.line));break;case 42:a=this.match(61)?b.TokenType.StarEqual:b.TokenType.Star;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 43:a=this.match(61)?b.TokenType.PlusEqual:b.TokenType.Plus;this.tokens.push(new b.Token(a,
this.source.substring(this.start,this.current),null,this.line));break;case 44:this.tokens.push(new b.Token(b.TokenType.Comma,this.source.substring(this.start,this.current),null,this.line));break;case 45:a=this.match(61)?b.TokenType.MinusEqual:b.TokenType.Minus;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 46:a=this.match(46)?b.TokenType.DotDot:b.TokenType.Dot;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,
this.line));break;case 47:if(this.match(47))for(;10!=(this.current>=this.source.length?0:q.cca(this.source,this.current))&&this.current<this.source.length;)this.advance();else a=this.match(61)?b.TokenType.SlashEqual:b.TokenType.Slash,this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 60:a=this.match(61)?b.TokenType.LessEqual:b.TokenType.Less;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 61:a=
this.match(61)?b.TokenType.EqualEqual:b.TokenType.Equal;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 62:a=this.match(61)?b.TokenType.GreaterEqual:b.TokenType.Greater;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 91:this.tokens.push(new b.Token(b.TokenType.LeftBracket,this.source.substring(this.start,this.current),null,this.line));break;case 93:this.tokens.push(new b.Token(b.TokenType.RightBracket,
this.source.substring(this.start,this.current),null,this.line));break;case 95:var c=this.current>=this.source.length?0:q.cca(this.source,this.current);97<=c&&122>=c||65<=c&&90>=c||95==c?48<=a&&57>=a?this.number():97<=a&&122>=a||65<=a&&90>=a||95==a?this.identifier():b.Cosy.error(b.ErrorDataType.Line(this.line),"Unexpected character: "+String.fromCodePoint(a)):this.tokens.push(new b.Token(b.TokenType.Underscore,this.source.substring(this.start,this.current),null,this.line));break;case 123:this.tokens.push(new b.Token(this.interpolationMode?
b.TokenType.StringInterpolationEnd:b.TokenType.LeftBrace,this.source.substring(this.start,this.current),null,this.line));break;case 125:this.interpolationMode?(this.tokens.push(new b.Token(b.TokenType.StringInterpolationEnd,this.source.substring(this.start,this.current),null,this.line)),this.interpolationMode=!1,this.string()):this.tokens.push(new b.Token(b.TokenType.RightBrace,this.source.substring(this.start,this.current),null,this.line));break;default:48<=a&&57>=a?this.number():97<=a&&122>=a||
65<=a&&90>=a||95==a?this.identifier():b.Cosy.error(b.ErrorDataType.Line(this.line),"Unexpected character: "+String.fromCodePoint(a))}}this.tokens.push(new b.Token(b.TokenType.Eof,"",null,this.line));return this.tokens};d.prototype.identifier=function(){for(;;){var a=this.current>=this.source.length?0:q.cca(this.source,this.current);if(!(97<=a&&122>=a||65<=a&&90>=a||95==a||48<=a&&57>=a))break;this.advance()}a=b.phases.Scanner.keywords.h[this.source.substring(this.start,this.current)];this.tokens.push(new b.Token(null==
a?b.TokenType.Identifier:a,this.source.substring(this.start,this.current),null,this.line))};d.prototype.string=function(){for(;(39!=(this.current>=this.source.length?0:q.cca(this.source,this.current))||92==(this.current-1>=this.source.length?0:q.cca(this.source,this.current-1)))&&this.current<this.source.length;){if(123==(this.current>=this.source.length?0:q.cca(this.source,this.current))){var a=this.source.substring(this.start+1,this.current);a=w.replace(a,"\\n","\n");a=w.replace(a,"\\'","'");this.tokens.push(new b.Token(b.TokenType.String,
this.source.substring(this.start,this.current),a,this.line));this.start=this.current;this.advance();this.tokens.push(new b.Token(b.TokenType.StringInterpolationStart,this.source.substring(this.start,this.current),null,this.line));this.start=this.current;this.interpolationMode=!0;return}10==(this.current>=this.source.length?0:q.cca(this.source,this.current))&&this.line++;this.advance()}this.current>=this.source.length?b.Cosy.error(b.ErrorDataType.Line(this.line),"Unterminated string."):(this.advance(),
a=this.source.substring(this.start+1,this.current-1),a=w.replace(a,"\\n","\n"),a=w.replace(a,"\\'","'"),this.tokens.push(new b.Token(b.TokenType.String,this.source.substring(this.start,this.current),a,this.line)))};d.prototype.number=function(){for(;;){var a=this.current>=this.source.length?0:q.cca(this.source,this.current);if(!(48<=a&&57>=a))break;this.advance()}46==(this.current>=this.source.length?0:q.cca(this.source,this.current))?(a=this.current+1>=this.source.length?0:q.cca(this.source,this.current+
1),a=48<=a&&57>=a):a=!1;if(a)for(this.advance();;){a=this.current>=this.source.length?0:q.cca(this.source,this.current);if(!(48<=a&&57>=a))break;this.advance()}a=parseFloat(this.source.substring(this.start,this.current));this.tokens.push(new b.Token(b.TokenType.Number,this.source.substring(this.start,this.current),a,this.line))};d.prototype.match=function(a){if(this.current>=this.source.length||q.cca(this.source,this.current)!=a)return!1;this.current++;return!0};d.prototype.advance=function(){this.current++;
return q.cca(this.source,this.current-1)};b.phases.Scanner=d;b.phases.Scanner.__name__=!0;Object.assign(b.phases.Scanner.prototype,{__class__:b.phases.Scanner});d=function(){this.currentFunctionReturnType=[];this.variableTypes=new g.ds.StringMap;this.structsMeta=new g.ds.StringMap;this.variableTypes.h.clock=b.VariableType.Function([],b.VariableType.Number);this.variableTypes.h.random=b.VariableType.Function([],b.VariableType.Number)};d.prototype.typeStmt=function(a){switch(a._hx_index){case 0:a=a.statements;
for(var c=0;c<a.length;)this.typeStmt(a[c++]);break;case 3:this.typeExpr(a.e);break;case 4:var e=a.keyword,d=a.name,f=a.to;c=a.body;switch(this.typeExpr(a.from)._hx_index){case 0:b.Cosy.warning(b.ErrorDataType.Token(e),'"From" clause has type Unknown');break;case 3:break;default:b.Cosy.error(b.ErrorDataType.Token(e),'"From" clause must evaluate to a number')}switch(this.typeExpr(f)._hx_index){case 0:b.Cosy.warning(b.ErrorDataType.Token(e),'"To" clause has type Unknown');break;case 3:break;default:b.Cosy.error(b.ErrorDataType.Token(e),
'"To" clause must evaluate to a number')}null!=d&&(this.variableTypes.h[d.lexeme]=b.VariableType.Number);for(a=0;a<c.length;)this.typeStmt(c[a++]);break;case 5:e=a.name;c=a.body;a=this.typeExpr(a.array);switch(a._hx_index){case 0:this.variableTypes.h[e.lexeme]=b.VariableType.Unknown;break;case 7:this.variableTypes.h[e.lexeme]=a.type;break;case 10:a=a.type;7==a._hx_index?this.variableTypes.h[e.lexeme]=a.type:b.Cosy.error(b.ErrorDataType.Token(e),"Can only loop over value of type array.");break;default:b.Cosy.error(b.ErrorDataType.Token(e),
"Can only loop over value of type array.")}for(a=0;a<c.length;)this.typeStmt(c[a++]);break;case 6:a=a.body;for(c=0;c<a.length;)this.typeStmt(a[c++]);break;case 7:this.handleFunc(a.name,a.params,a.body,a.returnType,a.foreign);break;case 8:c=a.keyword;e=a.then;d=a.el;a=this.typeExpr(a.cond);switch(a._hx_index){case 2:break;case 10:2!=a.type._hx_index&&b.Cosy.error(b.ErrorDataType.Token(c),"The condition must evaluate to a be boolean value (instead of "+this.formatType(a)+").");break;default:b.Cosy.error(b.ErrorDataType.Token(c),
"The condition must evaluate to a be boolean value (instead of "+this.formatType(a)+").")}this.typeStmt(e);null!=d&&this.typeStmt(d);break;case 9:1==this.typeExpr(a.e)._hx_index&&b.Cosy.error(b.ErrorDataType.Token(a.keyword),"Cannot print values of type void.");break;case 10:c=a.value;if(0==this.currentFunctionReturnType.length)break;e=this.currentFunctionReturnType;e=e[e.length-1];d=e.annotated;e.computed=null!=c?this.typeExpr(c):b.VariableType.Void;this.matchType(e.computed,d)||b.Cosy.error(b.ErrorDataType.Token(a.keyword),
"Function expected to return "+this.formatType(d)+" but got "+this.formatType(e.computed));break;case 11:c=a.name;a=a.declarations;e={members:new g.ds.StringMap};d=new g.ds.StringMap;for(f=0;f<a.length;){var p=a[f];++f;if(12==p._hx_index){var h=p.name,k=p.init,n=p.mut;e.members.h[h.lexeme]={mutable:n,initialized:null!=k};p=this.typeVar(h,p.type,k);n&&(p=b.VariableType.Mutable(p));d.h[h.lexeme]=p}else throw g.Exception.thrown("structs can only have var and mut");}this.structsMeta.h[c.lexeme]=e;this.variableTypes.h[c.lexeme]=
b.VariableType.Struct(d);break;case 12:c=a.name,e=this.typeVar(c,a.type,a.init),a.mut&&(e=b.VariableType.Mutable(e)),this.variableTypes.h[c.lexeme]=e}};d.prototype.typeVar=function(a,c,e){var d=null!=e?this.typeExpr(e):b.VariableType.Unknown;1==d._hx_index&&b.Cosy.error(b.ErrorDataType.Token(a),"Cannot assign Void to a variable");null==e||this.matchType(d,c)||b.Cosy.error(b.ErrorDataType.Token(a),"Expected variable to have type "+this.formatType(c)+" but got "+this.formatType(d)+".");return 0!=c._hx_index?
c:d};d.prototype.typeExpr=function(a){switch(a._hx_index){case 0:var c=a.keyword;a=a.exprs;for(var e=b.VariableType.Unknown,d=0,f=a.length;d<f;){var h=d++,k=this.typeExpr(a[h]);0!=k._hx_index&&(0==e._hx_index?e=k:this.matchType(k,e)||b.Cosy.error(b.ErrorDataType.Token(c),"Array values expected to be "+this.formatType(e)+" but got "+this.formatType(k)+" at index "+h+"."))}return b.VariableType.Array(e);case 1:return c=a.name,a=this.typeExpr(a.value),e=this.variableTypes.h[c.lexeme],(null==e?0:0==e._hx_index)||
(null==e?0:10==e._hx_index&&0==e.type._hx_index)?this.variableTypes.h[c.lexeme]=a:this.matchType(e,a)||b.Cosy.error(b.ErrorDataType.Token(c),"Cannot assign "+this.formatType(a)+" to "+this.formatType(e,!1)),a;case 2:e=a.left;c=a.op;d=a.right;switch(c.type._hx_index){case 14:e=this.typeExpr(e);d=this.typeExpr(d);f=3==e._hx_index||10==e._hx_index&&3==e.type._hx_index;h=3==d._hx_index||10==d._hx_index&&3==d.type._hx_index;if(f&&h)return b.VariableType.Number;k=4==e._hx_index||10==e._hx_index&&4==e.type._hx_index;
var r=4==d._hx_index||10==d._hx_index&&4==d.type._hx_index;if(k&&r)return b.VariableType.Text;var l=0!=e._hx_index,q=0!=d._hx_index;b.Cosy.strict&&(l||b.Cosy.error(b.ErrorDataType.Token(c),'Left side of "+" has unknown type.'),q||b.Cosy.error(b.ErrorDataType.Token(c),'Right side of "+" has unknown type.'));l&&q&&(k||r?(b.Cosy.error(b.ErrorDataType.Token(c),"Values of type "+this.formatType(e)+" and "+this.formatType(d)+" cannot be concatinated."),b.Cosy.hint(c,"Use string interpolation, e.g. {value}, to add non-string types to a string.")):
(f||h)&&b.Cosy.error(b.ErrorDataType.Token(c),"Values of types "+this.formatType(e)+" and "+this.formatType(d)+" cannot be added."));c=b.VariableType.Unknown;break;case 12:case 16:case 18:case 20:c=b.VariableType.Number;break;case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:c=b.VariableType.Boolean;break;default:throw g.Exception.thrown("should never happen");}break;case 3:c=a.paren;h=a.$arguments;f=this.typeExpr(a.callee);10==f._hx_index&&(f=f.type);e=b.VariableType.Unknown;switch(f._hx_index){case 0:b.Cosy.strict&&
b.Cosy.error(b.ErrorDataType.Token(c),"[strict] Undefined type.");break;case 6:d=f.paramTypes;e=f.returnType;f=[];for(k=0;k<h.length;)f.push(this.typeExpr(h[k++]));if(h.length!=d.length)b.Cosy.error(b.ErrorDataType.Token(c),"Expected "+d.length+" argument(s) but got "+h.length+".");else for(h=0,k=d.length;h<k;)r=h++,0==f[r]._hx_index&&b.Cosy.warning(b.ErrorDataType.Token(c),"Argument "+(r+1)+" has type Unknown."),this.matchType(f[r],d[r])||b.Cosy.error(b.ErrorDataType.Token(c),"Expected argument "+
(r+1)+" to be "+this.formatType(d[r])+" but got "+this.formatType(f[r])+".")}c=e;break;case 4:switch(c=a.name,a=this.typeExpr(a.obj),a._hx_index){case 4:switch(c.lexeme){case "char_at":return b.VariableType.Function([b.VariableType.Number],b.VariableType.Text);case "char_code_at":return b.VariableType.Function([b.VariableType.Number],b.VariableType.Number);case "length":return b.VariableType.Number;case "replace":return b.VariableType.Function([b.VariableType.Text,b.VariableType.Text],b.VariableType.Text);
case "split":return b.VariableType.Function([b.VariableType.Text],b.VariableType.Array(b.VariableType.Text));case "substr":return b.VariableType.Function([b.VariableType.Number,b.VariableType.Number],b.VariableType.Text);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),b.VariableType.Void}case 7:switch(a=a.type,c.lexeme){case "concat":return b.Cosy.error(b.ErrorDataType.Token(c),"Cannot call mutating method on immutable array."),b.VariableType.Void;case "count":return b.VariableType.Function([b.VariableType.Function([a],
b.VariableType.Boolean)],b.VariableType.Number);case "filter":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Boolean)],b.VariableType.Array(a));case "length":return b.VariableType.Number;case "map":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Unknown)],b.VariableType.Array(b.VariableType.Unknown));case "pop":return b.Cosy.error(b.ErrorDataType.Token(c),"Cannot call mutating method on immutable array."),b.VariableType.Void;case "push":return b.Cosy.error(b.ErrorDataType.Token(c),
"Cannot call mutating method on immutable array."),b.VariableType.Void;case "shift":return b.Cosy.error(b.ErrorDataType.Token(c),"Cannot call mutating method on immutable array."),b.VariableType.Void;case "sort":return b.VariableType.Function([b.VariableType.Function([a,a],b.VariableType.Number)],b.VariableType.Array(a));case "sum":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Number)],b.VariableType.Number);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),
b.VariableType.Void}case 8:e=a.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 9:e=this.variableTypes.h[a.name];if(null==e)throw g.Exception.thrown("Get on unknown type "+t.string(a));switch(e._hx_index){case 8:e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),
'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 10:e=e.type;if(8==e._hx_index){e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown}throw g.Exception.thrown("Get on unknown type "+t.string(a));default:throw g.Exception.thrown("Get on unknown type "+t.string(a));
}case 10:switch(e=a.type,e._hx_index){case 4:switch(c.lexeme){case "char_at":return b.VariableType.Function([b.VariableType.Number],b.VariableType.Text);case "char_code_at":return b.VariableType.Function([b.VariableType.Number],b.VariableType.Number);case "length":return b.VariableType.Number;case "replace":return b.VariableType.Function([b.VariableType.Text,b.VariableType.Text],b.VariableType.Text);case "split":return b.VariableType.Function([b.VariableType.Text],b.VariableType.Array(b.VariableType.Text));
case "substr":return b.VariableType.Function([b.VariableType.Number,b.VariableType.Number],b.VariableType.Text);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),b.VariableType.Void}case 7:switch(a=e.type,c.lexeme){case "concat":return b.VariableType.Function([b.VariableType.Array(a)],b.VariableType.Void);case "count":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Boolean)],b.VariableType.Number);case "filter":return b.VariableType.Function([b.VariableType.Function([a],
b.VariableType.Boolean)],b.VariableType.Array(a));case "length":return b.VariableType.Number;case "map":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Unknown)],b.VariableType.Array(b.VariableType.Unknown));case "pop":return b.VariableType.Function([],a);case "push":return b.VariableType.Function([a],b.VariableType.Void);case "shift":return b.VariableType.Function([],a);case "sort":return b.VariableType.Function([b.VariableType.Function([a,a],b.VariableType.Number)],b.VariableType.Array(a));
case "sum":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Number)],b.VariableType.Number);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),b.VariableType.Void}case 8:e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 9:e=this.variableTypes.h[e.name];
if(null==e)throw g.Exception.thrown("Get on unknown type "+t.string(a));switch(e._hx_index){case 8:e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 10:e=e.type;if(8==e._hx_index){e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+
c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown}throw g.Exception.thrown("Get on unknown type "+t.string(a));default:throw g.Exception.thrown("Get on unknown type "+t.string(a));}default:throw g.Exception.thrown('Get "'+c.lexeme+'" on unknown type '+t.string(a));}default:throw g.Exception.thrown('Get "'+c.lexeme+'" on unknown type '+t.string(a));}case 5:switch(a=this.typeExpr(a.obj),a._hx_index){case 7:return a.type;case 10:c=a.type;if(7==c._hx_index)return c.type;
throw g.Exception.thrown("Get index of unknown type "+t.string(a));default:throw g.Exception.thrown("Get index of unknown type "+t.string(a));}case 6:c=this.typeExpr(a.e);break;case 7:c=a.v;c="number"==typeof c?b.VariableType.Number:"string"==typeof c?b.VariableType.Text:"boolean"==typeof c?b.VariableType.Boolean:b.VariableType.Unknown;break;case 8:c=b.VariableType.Boolean;break;case 9:c=a.name;e=b.VariableType.Mutable(this.variableTypes.h[c.lexeme]);d=e.type;if(10==d._hx_index)switch(d.type._hx_index){case 7:break;
case 8:break;default:b.Cosy.error(b.ErrorDataType.Token(c),'Only mutable structs and arrays can be passed as "mut". You passed '+this.formatType(e,!1)+".")}else b.Cosy.error(b.ErrorDataType.Token(c),'Only mutable structs and arrays can be passed as "mut". You passed '+this.formatType(e,!1)+".");c=e;break;case 10:c=a.name;e=a.value;d=this.typeExpr(a.obj);switch(d._hx_index){case 9:d=this.variableTypes.h[d.name];break;case 10:switch(f=d.type,f._hx_index){case 8:d=b.VariableType.Struct(f.variables);
break;case 9:d=this.variableTypes.h[f.name]}}8==d._hx_index&&(f=d.variables,Object.prototype.hasOwnProperty.call(f.h,c.lexeme)?(d=this.typeExpr(e),f=f.h[c.lexeme],h=null==f?f:10==f._hx_index?f.type:f,(null==f?0:10==f._hx_index)?this.matchType(d,h)||b.Cosy.error(b.ErrorDataType.Token(c),"Expected value of type "+this.formatType(h)+" but got "+this.formatType(d)):b.Cosy.error(b.ErrorDataType.Token(c),"Member is not mutable.")):b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+
this.formatType(d,!1)));c=this.typeExpr(e);break;case 11:c=a.op;e=a.value;f=this.typeExpr(a.obj);d=this.typeExpr(e);switch(f._hx_index){case 7:b.Cosy.error(b.ErrorDataType.Token(c),"Cannot set value on immutable array.");break;case 10:f=f.type;if(7==f._hx_index)f=f.type,this.matchType(d,f)||b.Cosy.error(b.ErrorDataType.Token(c),"Cannot assign "+this.formatType(d)+" to "+this.formatType(f));else throw g.Exception.thrown("unexpected");break;default:throw g.Exception.thrown("unexpected");}c=this.typeExpr(e);
break;case 12:c=a.name;f=a.decls;e=this.variableTypes.h[c.lexeme];d=[];if(null==e)throw g.Exception.thrown("unexpected");if(8==e._hx_index)h=e.variables;else throw g.Exception.thrown("unexpected");for(k=0;k<f.length;)if(l=f[k],++k,1==l._hx_index){r=l.name;if(!Object.prototype.hasOwnProperty.call(h.h,r.lexeme)){b.Cosy.error(b.ErrorDataType.Token(r),'No member named "'+r.lexeme+'" in struct '+c.lexeme);break}else if(-1!=d.indexOf(r.lexeme)){b.Cosy.error(b.ErrorDataType.Token(r),"Member already assigned in initializer.");
break}l=this.typeExpr(l.value);q=h.h[r.lexeme];q=null==q?q:10==q._hx_index?q.type:q;d.push(r.lexeme);this.matchType(l,q)||b.Cosy.error(b.ErrorDataType.Token(r),"Expected value to be of type "+this.formatType(q)+" but got "+this.formatType(l))}else throw g.Exception.thrown("unexpected");f=this.structsMeta.h[c.lexeme].members.h;h=Object.keys(f);k=h.length;for(r=0;r<k;)l=h[r++],f[l].initialized||-1==d.indexOf(l)&&b.Cosy.error(b.ErrorDataType.Token(c),'Member "'+l+'" not initialized.');c=e;break;case 13:c=
b.VariableType.Text;break;case 14:switch(a.op.type._hx_index){case 12:c=b.VariableType.Number;break;case 22:c=b.VariableType.Boolean;break;default:throw g.Exception.thrown("should never happen");}break;case 15:return a=a.name,Object.prototype.hasOwnProperty.call(this.variableTypes.h,a.lexeme)?this.variableTypes.h[a.lexeme]:b.VariableType.Unknown;case 16:c=this.handleFunc(null,a.params,a.body,a.returnType,!1)}b.Cosy.strict&&(null==c?0:0==c._hx_index)&&(3==a._hx_index?b.Cosy.error(b.ErrorDataType.Token(a.paren),
"[strict] "+n[a.__enum__].__constructs__[a._hx_index]._hx_name+" has unknown type."):b.Cosy.warning(b.ErrorDataType.Line(-1),"[strict] "+n[a.__enum__].__constructs__[a._hx_index]._hx_name+" has unknown type."));return c};d.prototype.handleFunc=function(a,c,e,d,f){if(b.Cosy.strict)for(var g=0,h=c.length;g<h;){var k=g++;0==c[k].type._hx_index&&b.Cosy.error(b.ErrorDataType.Token(c[k].name),"[strict] Parameter has unknown type.")}g=[];for(h=0;h<c.length;)g.push(c[h++].type);for(h=0;h<c.length;)k=c[h],
++h,this.variableTypes.h[k.name.lexeme]=k.type;this.currentFunctionReturnType.push({annotated:d.annotated,computed:b.VariableType.Void});for(c=0;c<e.length;)this.typeStmt(e[c++]);e=this.currentFunctionReturnType.pop().computed;d.computed=0==d.annotated._hx_index?f?d.annotated:e:d.annotated;null!=a&&(this.variableTypes.h[a.lexeme]=b.VariableType.Function(g,d.computed));return b.VariableType.Function(g,d.computed)};d.prototype.matchType=function(a,b){switch(b._hx_index){case 0:return!0;case 6:var c=
b.paramTypes,d=b.returnType;switch(a._hx_index){case 0:return!0;case 6:b=a.paramTypes;a=a.returnType;if(b.length!=c.length)return!1;for(var f=0,g=b.length;f<g;){var h=f++;if(!this.matchType(b[h],c[h]))return!1}return this.matchType(a,d);case 10:return this.matchType(a.type,b);default:return a==b}case 7:switch(c=b.type,a._hx_index){case 0:return!0;case 7:return a=a.type,0==a._hx_index?!0:this.matchType(a,c);case 10:return this.matchType(a.type,b);default:return a==b}case 8:switch(c=b.variables,a._hx_index){case 0:return!0;
case 8:a=a.variables;d=a.h;b=Object.keys(d);f=b.length;for(g=0;g<f;){h=b[g++];var k=d[h];if(!Object.prototype.hasOwnProperty.call(c.h,h)||c.h[h]!=k)return!1}c=c.h;d=Object.keys(c);b=d.length;for(f=0;f<b;)if(g=d[f++],h=c[g],!Object.prototype.hasOwnProperty.call(a.h,g)||a.h[g]!=h)return!1;return!0;case 10:return this.matchType(a.type,b);default:return a==b}case 9:switch(c=b.name,a._hx_index){case 0:return!0;case 9:return this.matchType(this.variableTypes.h[a.name],this.variableTypes.h[c]);case 10:return this.matchType(a,
this.variableTypes.h[c]);default:return this.matchType(a,this.variableTypes.h[c])}case 10:switch(c=b.type,a._hx_index){case 0:return!0;case 10:return this.matchType(a.type,c);default:return a==b}default:switch(a._hx_index){case 0:return!0;case 10:return this.matchType(a.type,b);default:return a==b}}};d.prototype.formatType=function(a,b){null==b&&(b=!0);switch(a._hx_index){case 2:return"Bool";case 3:return"Num";case 4:return"Str";case 6:var c=a.paramTypes;b=a.returnType;a=[];for(var d=0;d<c.length;)a.push(this.formatType(c[d++]));
c=1==b._hx_index?"":" -> "+this.formatType(b);c="Fn("+a.join(", ")+")"+c;return 1==b._hx_index?c:"("+c+")";case 7:return b=a.type,0==b._hx_index?"Array":"Array("+this.formatType(b)+")";case 8:b=[];c=a.variables.h;a=Object.keys(c);d=a.length;for(var f=0;f<d;){var g=a[f++];b.push(""+g+" "+this.formatType(c[g]))}b.sort(function(a,b){return a<b?-1:b<a?1:0});return"Struct { "+b.join(", ")+" }";case 9:return this.formatType(this.variableTypes.h[a.name]);case 10:return c=a.type,b?"Mut("+this.formatType(c)+
")":this.formatType(c);default:return""+t.string(a)}};b.phases.Typer=d;b.phases.Typer.__name__=!0;Object.assign(b.phases.Typer.prototype,{__class__:b.phases.Typer});var g={IMap:function(){}};g.IMap.__name__=!0;d=function(a,b,d){var c=Error.call(this,a);this.message=c.message;"stack"in c&&(this.stack=c.stack);this.message=a;this.__previousException=b;this.__nativeException=null!=d?d:this};$jscomp.inherits(d,Error);d.prototype.unwrap=function(){return this.__nativeException};d.prototype.get_native=
function(){return this.__nativeException};d.caught=function(a){return a instanceof g.Exception?a:a instanceof Error?new g.Exception(a.message,null,a):new g.ValueException(a,null,a)};d.thrown=function(a){return a instanceof g.Exception?a.get_native():a instanceof Error?a:new g.ValueException(a)};g.Exception=d;g.Exception.__name__=!0;g.Exception.__super__=Error;Object.assign(g.Exception.prototype,{__class__:g.Exception});d=function(a,b,d){b=g.Exception.call(this,String(a),b,d)||this;b.value=a;return b};
$jscomp.inherits(d,g.Exception);d.__super__=g.Exception.__super__;d.prototype.unwrap=function(){return this.value};g.ValueException=d;g.ValueException.__name__=!0;g.ValueException.__super__=g.Exception;Object.assign(g.ValueException.prototype,{__class__:g.ValueException});g.ds={};d=function(){this.h={__keys__:{}}};d.prototype.set=function(a,b){var c=a.__id__;null==c&&(c=a.__id__=k.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a};g.ds.ObjectMap=d;g.ds.ObjectMap.__name__=!0;g.ds.ObjectMap.__interfaces__=
[g.IMap];Object.assign(g.ds.ObjectMap.prototype,{__class__:g.ds.ObjectMap});g.ds.StringMap=function(){this.h=Object.create(null)};g.ds.StringMap.__name__=!0;g.ds.StringMap.__interfaces__=[g.IMap];Object.assign(g.ds.StringMap.prototype,{__class__:g.ds.StringMap});g.iterators={};d=function(a){this.current=0;this.array=a};d.prototype.hasNext=function(){return this.current<this.array.length};d.prototype.next=function(){return this.array[this.current++]};g.iterators.ArrayIterator=d;g.iterators.ArrayIterator.__name__=
!0;Object.assign(g.iterators.ArrayIterator.prototype,{__class__:g.iterators.ArrayIterator});var x={};d=function(){};d.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=x.Boot.__nativeClassName(a);return null!=a?x.Boot.__resolveNativeClass(a):null};d.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";
case "object":if(a.__enum__){var d=n[a.__enum__].__constructs__[a._hx_index];c=d._hx_name;if(d.__params__){b+="\t";var f=[],g=0;for(d=d.__params__;g<d.length;){var h=d[g];g+=1;f.push(x.Boot.__string_rec(a[h],b))}return c+"("+f.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";f=0;for(g=a.length;f<g;)d=f++,c+=(0<d?",":"")+x.Boot.__string_rec(a[d],b);return c+"]"}try{f=a.toString}catch(r){return"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f&&(c=a.toString(),"[object Object]"!=
c))return c;c="{\n";b+="\t";f=null!=a.hasOwnProperty;g=null;for(g in a)f&&!a.hasOwnProperty(g)||"prototype"==g||"__class__"==g||"__super__"==g||"__interfaces__"==g||"__properties__"==g||(2!=c.length&&(c+=", \n"),c+=b+g+" : "+x.Boot.__string_rec(a[g],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};d.__interfLoop=function(a,b){for(;;){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c&&(null==a.__super__||a.__super__.__interfaces__!=c))for(var d=
0,f=c.length;d<f;){var g=c[d++];if(g==b||x.Boot.__interfLoop(g,b))return!0}a=a.__super__}};d.__implements=function(a,b){return x.Boot.__interfLoop(x.Boot.getClass(a),b)};d.__nativeClassName=function(a){a=x.Boot.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};d.__resolveNativeClass=function(a){return k[a]};x.Boot=d;x.Boot.__name__=!0;k.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(q.now=performance.now.bind(performance));
null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;g.ds.ObjectMap.count=0;x.Boot.__toStr={}.toString;b.phases.Interpreter.__meta__={fields:{evaluate:{SuppressWarnings:["checkstyle:CyclomaticComplexity","checkstyle:NestedControlFlow","checkstyle:MethodLength"]}}};b.phases.Interpreter.uninitialized={};b.Cosy.interpreter=
new b.phases.Interpreter;b.Cosy.foreignFunctions=new g.ds.StringMap;b.Cosy.foreignVariables=new g.ds.StringMap;b.Cosy.hadError=!1;b.Cosy.hadRuntimeError=!1;b.Cosy.outputPrettyPrint=!1;b.Cosy.outputJavaScript=!1;b.Cosy.outputMarkdown=!1;b.Cosy.validateOnly=!1;b.Cosy.outputTimes=!1;b.Cosy.noColors=!1;b.Cosy.strict=!1;b.Cosy.measureStarts=new g.ds.StringMap;b.Cosy.measureOutput="";b.phases.Scanner.keywords=function(a){a=new g.ds.StringMap;a.h.and=b.TokenType.And;a.h["break"]=b.TokenType.Break;a.h["continue"]=
b.TokenType.Continue;a.h["else"]=b.TokenType.Else;a.h["false"]=b.TokenType.False;a.h["for"]=b.TokenType.For;a.h.foreign=b.TokenType.Foreign;a.h.fn=b.TokenType.Fn;a.h["in"]=b.TokenType.In;a.h["if"]=b.TokenType.If;a.h.mut=b.TokenType.Mut;a.h.or=b.TokenType.Or;a.h.print=b.TokenType.Print;a.h["return"]=b.TokenType.Return;a.h.struct=b.TokenType.Struct;a.h["true"]=b.TokenType.True;a.h["var"]=b.TokenType.Var;a.h.Bool=b.TokenType.BooleanType;a.h.Num=b.TokenType.NumberType;a.h.Str=b.TokenType.StringType;a.h.Void=
b.TokenType.VoidType;a.h.Fn=b.TokenType.FunctionType;a.h.Array=b.TokenType.ArrayType;return a}(this);b.Cosy.main()})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);var cosy=$hx_exports.cosy;
