var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.inherits=function(d,n){function p(){}p.prototype=n.prototype;d.superClass_=n.prototype;d.prototype=new p;d.prototype.constructor=d;for(var u in n)if("prototype"!=u)if(Object.defineProperties){var g=Object.getOwnPropertyDescriptor(n,u);g&&Object.defineProperty(d,u,g)}else d[u]=n[u]};$jscomp.owns=function(d,n){return Object.prototype.hasOwnProperty.call(d,n)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,n,p){d!=Array.prototype&&d!=Object.prototype&&(d[n]=p.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,n,p,u){if(n){p=$jscomp.global;d=d.split(".");for(u=0;u<d.length-1;u++){var g=d[u];g in p||(p[g]={});p=p[g]}d=d[d.length-1];u=p[d];n=n(u);n!=u&&null!=n&&$jscomp.defineProperty(p,d,{configurable:!0,writable:!0,value:n})}};$jscomp.polyfill("Object.assign",function(d){return d?d:function(d,p){for(var n=1;n<arguments.length;n++){var g=arguments[n];if(g)for(var v in g)$jscomp.owns(g,v)&&(d[v]=g[v])}return d}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(d){return $jscomp.SYMBOL_PREFIX+(d||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var d=$jscomp.global.Symbol.iterator;d||(d=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[d]&&$jscomp.defineProperty(Array.prototype,d,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(d){var n=0;return $jscomp.iteratorPrototype(function(){return n<d.length?{done:!1,value:d[n++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(d){$jscomp.initSymbolIterator();d={next:d};d[$jscomp.global.Symbol.iterator]=function(){return this};return d};$jscomp.iteratorFromArray=function(d,n){$jscomp.initSymbolIterator();d instanceof String&&(d+="");var p=0,u={next:function(){if(p<d.length){var g=p++;return{value:n(g,d[g]),done:!1}}u.next=function(){return{done:!0,value:void 0}};return u.next()}};u[Symbol.iterator]=function(){return u};return u};
$jscomp.polyfill("Array.prototype.values",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d,p){return p})}},"es6","es3");$jscomp.polyfill("Array.prototype.keys",function(d){return d?d:function(){return $jscomp.iteratorFromArray(this,function(d){return d})}},"es6","es3");
$jscomp.checkStringArgs=function(d,n,p){if(null==d)throw new TypeError("The 'this' value for String.prototype."+p+" must not be null or undefined");if(n instanceof RegExp)throw new TypeError("First argument to String.prototype."+p+" must not be a regular expression");return d+""};
$jscomp.polyfill("String.prototype.startsWith",function(d){return d?d:function(d,p){var n=$jscomp.checkStringArgs(this,d,"startsWith");d+="";var g=n.length,v=d.length;p=Math.max(0,Math.min(p|0,n.length));for(var f=0;f<v&&p<g;)if(n[p++]!=d[f++])return!1;return f>=v}},"es6","es3");
$jscomp.polyfill("String.fromCodePoint",function(d){return d?d:function(d){for(var p="",n=0;n<arguments.length;n++){var g=Number(arguments[n]);if(0>g||1114111<g||g!==Math.floor(g))throw new RangeError("invalid_code_point "+g);65535>=g?p+=String.fromCharCode(g):(g-=65536,p+=String.fromCharCode(g>>>10&1023|55296),p+=String.fromCharCode(g&1023|56320))}return p}},"es6","es3");
(function(d,n){function p(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=n.$haxeUID++);var c;null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__];null==c&&(c=b.bind(a),a.hx__closures__[b.__id__]=c);return c}function u(a){this.push(a)}d.cosy=d.cosy||{};d.cosy.Cosy=d.cosy.Cosy||{};var g=function(){return w.Boot.__string_rec(this,"")},v=v||{},f,r=function(){};r.cca=function(a,b){a=a.charCodeAt(b);if(a==a)return a};r.substr=function(a,b,e){if(null==e)e=a.length;else if(0>e)if(0==
b)e=a.length+e;else return"";return a.substr(b,e)};r.now=function(){return Date.now()};r.__name__=!0;Math.__name__=!0;var t=function(){};t.string=function(a){return w.Boot.__string_rec(a,"")};t.parseInt=function(a){if(null!=a)for(var b=0,e=a.length;b<e;){var l=b++,d=a.charCodeAt(l);if(8>=d||14<=d&&32!=d&&45!=d)if(b=a.charCodeAt(l+1),a=parseInt(a,120==b||88==b?16:10),isNaN(a))break;else return a}return null};t.random=function(a){return 0>=a?0:Math.floor(Math.random()*a)};t.__name__=!0;var x=function(){};
x.isSpace=function(a,b){a=r.cca(a,b);return 8<a&&14>a?!0:32==a};x.ltrim=function(a){for(var b=a.length,e=0;e<b&&x.isSpace(a,e);)++e;return 0<e?r.substr(a,e,b-e):a};x.rtrim=function(a){for(var b=a.length,e=0;e<b&&x.isSpace(a,b-e-1);)++e;return 0<e?r.substr(a,0,b-e):a};x.trim=function(a){return x.ltrim(x.rtrim(a))};x.replace=function(a,b,e){return a.split(b).join(e)};x.__name__=!0;var b={Error:function(a){this.message=a}};b.Error.__name__=!0;Object.assign(b.Error.prototype,{__class__:b.Error});var k=
function(a){return b.Error.call(this,a)||this};$jscomp.inherits(k,b.Error);b.Break=k;b.Break.__name__=!0;b.Break.__super__=b.Error;Object.assign(b.Break.prototype,{__class__:b.Break});b.Callable=function(){};b.Callable.__name__=!0;Object.assign(b.Callable.prototype,{__class__:b.Callable});k=function(a){return b.Error.call(this,a)||this};$jscomp.inherits(k,b.Error);b.Continue=k;b.Continue.__name__=!0;b.Continue.__super__=b.Error;Object.assign(b.Continue.prototype,{__class__:b.Continue});b.phases={};
k=function(){this.locals=new h.ds.ObjectMap;this.globals=new b.Environment;this.globals.define("clock",new b.phases._Interpreter.ClockCallable);this.globals.define("random",new b.phases._Interpreter.RandomCallable);this.environment=this.globals};k.prototype.interpret=function(a){try{for(var c=0;c<a.length;)this.execute(a[c++])}catch(e){if(a=h.Exception.caught(e).unwrap(),a instanceof b.RuntimeError)b.Cosy.runtimeError(a);else if(!(a instanceof h.io.Eof))throw e;}};k.prototype.execute=function(a){switch(a._hx_index){case 0:this.executeBlock(a.statements,
new b.Environment(this.environment));break;case 1:throw h.Exception.thrown(new b.Break);case 2:throw h.Exception.thrown(new b.Continue);case 3:this.evaluate(a.e);break;case 4:var c=a.keyword,e=a.name,l=a.body,d=this.evaluate(a.from);"number"!=typeof d&&b.Cosy.error(b.ErrorDataType.Token(c),'Number expected in "from" clause of loop.');a=this.evaluate(a.to);"number"!=typeof a&&b.Cosy.error(b.ErrorDataType.Token(c),'Number expected in "to" clause of loop.');c=new b.Environment(this.environment);try{for(;d<
a;){var m=d++;null!=e&&c.define(e.lexeme,m);try{this.executeBlock(l,c)}catch(q){if(!(h.Exception.caught(q).unwrap()instanceof b.Continue))throw q;}}}catch(q){if(!(h.Exception.caught(q).unwrap()instanceof b.Break))throw q;}break;case 5:m=a.name;e=a.body;a=this.evaluate(a.array);l=new b.Environment(this.environment);try{for(d=0;d<a.length;){l.define(m.lexeme,a[d++]);try{this.executeBlock(e,l)}catch(q){if(!(h.Exception.caught(q).unwrap()instanceof b.Continue))throw q;}}}catch(q){if(!(h.Exception.caught(q).unwrap()instanceof
b.Break))throw q;}break;case 6:m=a.cond;a=a.body;l=new b.Environment(this.environment);try{for(;;){d=void 0;null!=m?(e=this.evaluate(m),d=null==e?!1:"boolean"==typeof e?e:!0):d=!0;if(!d)break;try{this.executeBlock(a,l)}catch(q){if(!(h.Exception.caught(q).unwrap()instanceof b.Continue))throw q;}}}catch(q){if(!(h.Exception.caught(q).unwrap()instanceof b.Break))throw q;}break;case 7:m=a.name;if(a.foreign){this.environment.define(m.lexeme,b.Cosy.foreignFunctions.h[m.lexeme]);break}this.environment.define(m.lexeme,
new b.Function(m,a.params,a.body,this.environment,!1));break;case 8:m=a.el;e=this.evaluate(a.cond);(null==e?0:"boolean"==typeof e?e:1)?this.execute(a.then):null!=m&&this.execute(m);break;case 9:a=this.evaluate(a.e);b.Cosy.println(null==a?"nil":""+(null==a?"null":t.string(a)));break;case 10:throw a=a.value,h.Exception.thrown(new b.Return(null==a?null:this.evaluate(a)));case 11:m=a.name;a=a.declarations;this.environment.define(m.lexeme,null);e=this.environment;this.environment=new b.Environment(this.environment);
l=new h.ds.StringMap;for(d=0;d<a.length;){var f=a[d];++d;12==f._hx_index&&(c=f.init,f=f.name.lexeme,c=null!=c?this.evaluate(c):null,l.h[f]=c)}this.environment=e;this.environment.assign(m,new b.StructInstance(m,l));break;case 12:m=a.name,e=a.init,a.foreign?this.environment.define(m.lexeme,b.Cosy.foreignVariables.h[m.lexeme]):(a=b.phases.Interpreter.uninitialized,null!=e&&(a=this.evaluate(e)),a instanceof b.StructInstance&&(a=a.clone()),this.environment.define(m.lexeme,a))}};k.prototype.resolve=function(a,
b){this.locals.set(a,b)};k.prototype.executeBlock=function(a,b){var c=this.environment;try{this.environment=b;for(b=0;b<a.length;)this.execute(a[b++]);this.environment=c}catch(l){throw a=h.Exception.caught(l).unwrap(),this.environment=c,h.Exception.thrown(a);}};k.prototype.evaluate=function(a){switch(a._hx_index){case 0:a=a.exprs;for(var c=[],e=0;e<a.length;)c.push(this.evaluate(a[e++]));return c;case 1:c=a.name;e=a.op;var l=a.value;switch(e.type._hx_index){case 11:var d=this.lookUpVariable(c,a);
l=this.evaluate(l);if("number"!=typeof d||"number"!=typeof l)throw h.Exception.thrown(new b.RuntimeError(e,"Operand must be a number"));e=d-l;break;case 13:d=this.lookUpVariable(c,a);l=this.evaluate(l);if("number"==typeof d&&"number"==typeof l)e=d+l;else if("number"==typeof d&&"string"==typeof l)e=d+l;else if("string"==typeof d&&"number"==typeof l)e=d+l;else if("string"==typeof d&&"string"==typeof l)e=d+l;else if("boolean"==typeof d&&"string"==typeof l)e=d+l;else if("string"==typeof d&&"boolean"==
typeof l)e=d+l;else throw h.Exception.thrown(new b.RuntimeError(e,"Operands cannot be concatinated."));break;case 15:d=this.lookUpVariable(c,a);l=this.evaluate(l);if("number"!=typeof d||"number"!=typeof l)throw h.Exception.thrown(new b.RuntimeError(e,"Operand must be a number"));e=d/l;break;case 17:d=this.lookUpVariable(c,a);l=this.evaluate(l);if("number"!=typeof d||"number"!=typeof l)throw h.Exception.thrown(new b.RuntimeError(e,"Operand must be a number"));e=d*l;break;case 20:e=this.evaluate(l);
break;default:throw h.Exception.thrown("error");}a=this.locals.h[a.__id__];null==a?this.globals.assign(c,e):this.environment.assignAt(a,c,e);return e;case 2:switch(c=a.op,e=this.evaluate(a.left),a=this.evaluate(a.right),c.type._hx_index){case 10:if("number"!=typeof e||"number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e-a;case 12:if("number"==typeof e&&"number"==typeof a||"number"==typeof e&&"string"==typeof a||"string"==typeof e&&"number"==typeof a||
"string"==typeof e&&"string"==typeof a||"boolean"==typeof e&&"string"==typeof a||"string"==typeof e&&"boolean"==typeof a)return e+a;throw h.Exception.thrown(new b.RuntimeError(c,"Operands cannot be concatinated."));case 14:if("number"!=typeof e||"number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e/a;case 16:if("number"!=typeof e||"number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e*a;case 19:return!(null==
e&&null==a||(null==e?0:e==a));case 21:return null==e&&null==a?!0:null==e?!1:e==a;case 22:if("number"!=typeof e||"number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e>a;case 23:if("number"!=typeof e||"number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e>=a;case 24:if("number"!=typeof e||"number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e<a;case 25:if("number"!=
typeof e||"number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return e<=a;default:return null}case 3:c=a.paren;e=a.$arguments;a=this.evaluate(a.callee);d=p(this,this.evaluate);l=Array(e.length);for(var m=0,f=e.length;m<f;){var g=m++;l[g]=d(e[g])}if(w.Boot.__implements(a,b.Callable)){if(!(a instanceof b.ForeignFunction)&&(e=a.arity(),l.length!=e))throw h.Exception.thrown(new b.RuntimeError(c,"Expected "+e+" argument(s) but got "+l.length+"."));return a.call(this,
l)}throw h.Exception.thrown(new b.RuntimeError(c,"Can only call functions."));case 4:c=a.name;a=this.evaluate(a.obj);if(a instanceof Array)return this.arrayGet(a,c);if(a instanceof b.StructInstance)return a.get(c);if("string"==typeof a)return this.stringGet(a,c);throw h.Exception.thrown(new b.RuntimeError(c,"Only instances have properties"));case 5:return this.evaluate(a.e);case 6:return a.v;case 7:switch(c=a.right,e=this.evaluate(a.left),a.op.type._hx_index){case 29:return(null==e?0:"boolean"==typeof e?
e:1)?this.evaluate(c):e;case 40:return(null==e?0:"boolean"==typeof e?e:1)?e:this.evaluate(c);default:return this.evaluate(c)}case 8:return this.lookUpVariable(a.name,a);case 9:c=a.name;e=this.evaluate(a.obj);a=this.evaluate(a.value);if(e instanceof b.StructInstance)e.set(c,a);else throw h.Exception.thrown(new b.RuntimeError(c,"Only instances have fields"));return a;case 10:e=a.name;c=a.decls;a=this.lookUpVariable(e,a);if(!(a instanceof b.StructInstance))throw h.Exception.thrown(new b.RuntimeError(e,
"Struct initializer on non-struct object."));a=a.clone();for(e=0;e<c.length;)l=c[e],++e,1==l._hx_index&&a.set(l.name,this.evaluate(l.value));return a;case 11:switch(c=a.op,a=this.evaluate(a.right),c.type._hx_index){case 10:if("number"!=typeof a)throw h.Exception.thrown(new b.RuntimeError(c,"Operand must be a number"));return-a;case 18:return!(null==a?0:"boolean"==typeof a?a:1);default:return null}case 12:return this.lookUpVariable(a.name,a);case 13:return new b.Function(null,a.params,a.body,this.environment,
!1)}};k.prototype.arrayGet=function(a,c){var e=this;switch(c.lexeme){case "concat":return new b.phases._Interpreter.CustomCallable(1,function(b){b=b[0];for(var c=p(a,u),e=Array(b.length),l=0,d=b.length;l<d;){var f=l++;e[f]=c(b[f])}return e});case "contains":return new b.phases._Interpreter.CustomCallable(1,function(b){return-1!=a.indexOf(b[0])});case "count":return new b.phases._Interpreter.CustomCallable(1,function(b){var c=0;b=b[0];for(var l=0;l<a.length;)b.call(e,[a[l++]])&&++c;return c});case "filter":return new b.phases._Interpreter.CustomCallable(1,
function(b){b=b[0];for(var c=[],l=0;l<a.length;){var d=a[l];++l;b.call(e,[d])&&c.push(d)}return c});case "get":return new b.phases._Interpreter.CustomCallable(1,function(e){e=e[0];if(0>e&&e>=a.length)throw h.Exception.thrown(new b.RuntimeError(c,"Array out of bounds (index "+e+" in array of length "+a.length+")."));return a[e]});case "length":return a.length;case "map":return new b.phases._Interpreter.CustomCallable(1,function(b){b=b[0];for(var c=[],d=0;d<a.length;)c.push(b.call(e,[a[d++]]));return c});
case "pop":return new b.phases._Interpreter.CustomCallable(0,function(e){if(0==a.length)throw h.Exception.thrown(new b.RuntimeError(c,"Cannot pop from empty array."));return a.pop()});case "push":return new b.phases._Interpreter.CustomCallable(1,function(b){for(var c=p(a,u),e=Array(b.length),d=0,l=b.length;d<l;){var f=d++;e[f]=c(b[f])}return e});case "sort":return new b.phases._Interpreter.CustomCallable(1,function(b){var c=b[0];a.sort(function(a,b){return c.call(e,[a,b])});return a});case "sum":return new b.phases._Interpreter.CustomCallable(1,
function(b){var c=0;b=b[0];for(var d=0;d<a.length;)c+=b.call(e,[a[d++]]);return c});default:throw h.Exception.thrown(new b.RuntimeError(c,'Undefined method "'+c.lexeme+'".'));}};k.prototype.stringGet=function(a,c){switch(c.lexeme){case "charAt":return new b.phases._Interpreter.CustomCallable(1,function(b){return a.charAt(b[0])});case "length":return a.length;case "replace":return new b.phases._Interpreter.CustomCallable(2,function(b){return x.replace(a,b[0],b[1])});case "split":return new b.phases._Interpreter.CustomCallable(1,
function(b){return a.split(b[0])});case "substr":return new b.phases._Interpreter.CustomCallable(2,function(b){return r.substr(a,b[0]|0,b[1]|0)});default:throw h.Exception.thrown(new b.RuntimeError(c,'Undefined method "'+c.lexeme+'".'));}};k.prototype.lookUpVariable=function(a,c){c=this.locals.h[c.__id__];c=null==c?this.globals.get(a):this.environment.getAt(c,a.lexeme);if(c==b.phases.Interpreter.uninitialized)throw h.Exception.thrown(new b.RuntimeError(a,'Accessing uninitialized variable "'+a.lexeme+
'".'));return c};b.phases.Interpreter=k;b.phases.Interpreter.__name__=!0;Object.assign(b.phases.Interpreter.prototype,{__class__:b.phases.Interpreter});k=function(a){this.values=new h.ds.StringMap;this.enclosing=a};k.prototype.define=function(a,b){this.values.h[a]=b};k.prototype.get=function(a){if(Object.prototype.hasOwnProperty.call(this.values.h,a.lexeme))return this.values.h[a.lexeme];if(null!=this.enclosing)return this.enclosing.get(a);throw h.Exception.thrown(new b.RuntimeError(a,'Undefined variable "'+
a.lexeme+'".'));};k.prototype.getAt=function(a,b){return this.ancestor(a).values.h[b]};k.prototype.assign=function(a,c){if(Object.prototype.hasOwnProperty.call(this.values.h,a.lexeme))this.values.h[a.lexeme]=c;else if(null!=this.enclosing)this.enclosing.assign(a,c);else throw h.Exception.thrown(new b.RuntimeError(a,'Undefined variable "'+a.lexeme+'".'));};k.prototype.assignAt=function(a,b,e){this.ancestor(a).values.h[b.lexeme]=e};k.prototype.ancestor=function(a){for(var b=this,e=0;e<a;)++e,b=b.enclosing;
return b};b.Environment=k;b.Environment.__name__=!0;Object.assign(b.Environment.prototype,{__class__:b.Environment});b.phases._Interpreter={};k=function(){};k.prototype.arity=function(){return 0};k.prototype.call=function(a,b){return r.now()/1E3*1E3};k.prototype.toString=function(){return"<native fn>"};b.phases._Interpreter.ClockCallable=k;b.phases._Interpreter.ClockCallable.__name__=!0;b.phases._Interpreter.ClockCallable.__interfaces__=[b.Callable];Object.assign(b.phases._Interpreter.ClockCallable.prototype,
{__class__:b.phases._Interpreter.ClockCallable});k=function(){};k.prototype.arity=function(){return 0};k.prototype.call=function(a,b){return Math.random()};k.prototype.toString=function(){return"<native fn>"};b.phases._Interpreter.RandomCallable=k;b.phases._Interpreter.RandomCallable.__name__=!0;b.phases._Interpreter.RandomCallable.__interfaces__=[b.Callable];Object.assign(b.phases._Interpreter.RandomCallable.prototype,{__class__:b.phases._Interpreter.RandomCallable});k=function(){};k.main=function(){b.Cosy.setFunction("randomInt",
function(a){return t.random(a[0])});b.Cosy.setFunction("stringToNumber",function(a){return t.parseInt(a[0])})};k.printlines=function(a){for(var c=0;c<a.length;)b.Cosy.println(a[c++])};k.println=function(a){n.console.log(a)};k.validate=function(a){b.Cosy.hadError=!1;a=(new b.phases.Parser((new b.phases.Scanner(a)).scanTokens())).parse();if(!b.Cosy.hadError){var c=new b.phases.Resolver(b.Cosy.interpreter);c.beginScope();c.resolveStmts(a);c.endScope();c=new b.phases.Typer;for(var e=0;e<a.length;)c.typeStmt(a[e++])}};
k.setFunction=function(a,c){b.Cosy.foreignFunctions.h[a]=new b.ForeignFunction(c)};k.setVariable=function(a,c){b.Cosy.foreignVariables.h[a]=c};k.round2=function(a,b){a*=Math.pow(10,b);return a=Math.round(a)/Math.pow(10,b)};k.startMeasure=function(a){b.Cosy.outputTimes&&(b.Cosy.measureStarts.h[a]=r.now()/1E3)};k.endMeasure=function(a){if(b.Cosy.outputTimes){if(!Object.prototype.hasOwnProperty.call(b.Cosy.measureStarts.h,a))throw h.Exception.thrown("Measurement for "+a+" has not been started");for(var c=
1E3*(r.now()/1E3-b.Cosy.measureStarts.h[a]);15>a.length;)a+=" ";b.Cosy.measureOutput=(b.Cosy.measureOutput+="\n\u00b7 ")+b.Cosy.color(""+a+" took\t"+b.Cosy.round2(c,3)+" ms",b.Color.Misc)}};k.run=function(a){b.Cosy.hadError=!1;b.Cosy.measureOutput=b.Cosy.color("Times:",b.Color.Misc);var c=r.now()/1E3;b.Cosy.startMeasure("Scanner");a=(new b.phases.Scanner(a)).scanTokens();b.Cosy.endMeasure("Scanner");b.Cosy.startMeasure("Parser");a=(new b.phases.Parser(a)).parse();b.Cosy.endMeasure("Parser");if(!b.Cosy.hadError){b.Cosy.startMeasure("Resolver");
var e=new b.phases.Resolver(b.Cosy.interpreter);e.beginScope();e.resolveStmts(a);e.endScope();b.Cosy.endMeasure("Resolver");b.Cosy.startMeasure("Typer");e=new b.phases.Typer;for(var d=0;d<a.length;)e.typeStmt(a[d++]);b.Cosy.endMeasure("Typer");if(!b.Cosy.hadError&&!b.Cosy.validateOnly)if(b.Cosy.startMeasure("Optimizer"),a=(new b.phases.Optimizer).optimizeStmts(a),b.Cosy.endMeasure("Optimizer"),b.Cosy.outputPrettyPrint){c=(f=new b.phases.AstPrinter,p(f,f.printStmt));e=Array(a.length);d=0;for(var y=
a.length;d<y;){var m=d++;e[m]=c(a[m])}b.Cosy.printlines(e)}else if(b.Cosy.outputJavaScript){b.Cosy.println("// standard library\nlet clock = Date.now;\n");c=(f=new b.phases.JavaScriptPrinter,p(f,f.printStmt));e=Array(a.length);d=0;for(y=a.length;d<y;)m=d++,e[m]=c(a[m]);b.Cosy.printlines(e)}else if(b.Cosy.outputMarkdown){b.Cosy.println("# Cosy file");b.Cosy.println("## Functions");c=(f=new b.phases.MarkdownPrinter,p(f,f.printStmt));e=Array(a.length);d=0;for(y=a.length;d<y;)m=d++,e[m]=c(a[m]);b.Cosy.printlines([e.join("")])}else b.Cosy.startMeasure("AST interpreter"),
b.Cosy.interpreter.interpret(a),b.Cosy.endMeasure("AST interpreter"),b.Cosy.outputTimes&&(b.Cosy.println("\n"+b.Cosy.measureOutput),b.Cosy.println(b.Cosy.color("Total: "+b.Cosy.round2(1E3*(r.now()/1E3-c),3)+" ms",b.Color.Misc)))}};k.reportWarning=function(a,c,e){b.Cosy.println(b.Cosy.color("[line "+a+"] Warning "+c+": "+e,b.Color.Warning))};k.warning=function(a,c){switch(a._hx_index){case 0:b.Cosy.reportWarning(a.v,"",c);break;case 1:a=a.v,a.type==b.TokenType.Eof?b.Cosy.reportWarning(a.line,"at end",
c):b.Cosy.reportWarning(a.line,'at "'+a.lexeme+'"',c)}};k.report=function(a,c,e){b.Cosy.println(b.Cosy.color("[line "+a+"] Error "+c+": "+e,b.Color.Error));b.Cosy.hadError=!0};k.error=function(a,c){switch(a._hx_index){case 0:b.Cosy.report(a.v,"",c);break;case 1:a=a.v,a.type==b.TokenType.Eof?b.Cosy.report(a.line,"at end",c):b.Cosy.report(a.line,'at "'+a.lexeme+'"',c)}};k.runtimeError=function(a){b.Cosy.println(b.Cosy.color("[line "+a.token.line+"] Runtime Error: "+a.message,b.Color.Error));b.Cosy.hadRuntimeError=
!0};k.color=function(a,c){if(b.Cosy.noColors)return a;switch(c._hx_index){case 0:return"\u001b[1;31m"+a+"\u001b[0m";case 1:return"\u001b[0;33m"+a+"\u001b[0m";case 2:return"\u001b[0;35m"+a+"\u001b[0m"}};b.Cosy=k;d.cosy.Cosy.run=b.Cosy.run;d.cosy.Cosy.setVariable=b.Cosy.setVariable;d.cosy.Cosy.setFunction=b.Cosy.setFunction;d.cosy.Cosy.validate=b.Cosy.validate;b.Cosy.__name__=!0;b.Color=v["cosy.Color"]={__ename__:!0,__constructs__:null,Error:{_hx_name:"Error",_hx_index:0,__enum__:"cosy.Color",toString:g},
Warning:{_hx_name:"Warning",_hx_index:1,__enum__:"cosy.Color",toString:g},Misc:{_hx_name:"Misc",_hx_index:2,__enum__:"cosy.Color",toString:g}};b.Color.__constructs__=[b.Color.Error,b.Color.Warning,b.Color.Misc];b.ErrorDataType=v["cosy.ErrorDataType"]={__ename__:!0,__constructs__:null,Line:(f=function(a){return{_hx_index:0,v:a,__enum__:"cosy.ErrorDataType",toString:g}},f._hx_name="Line",f.__params__=["v"],f),Token:(f=function(a){return{_hx_index:1,v:a,__enum__:"cosy.ErrorDataType",toString:g}},f._hx_name=
"Token",f.__params__=["v"],f)};b.ErrorDataType.__constructs__=[b.ErrorDataType.Line,b.ErrorDataType.Token];d=function(a){this.method=a};d.prototype.arity=function(){return 0};d.prototype.call=function(a,b){return this.method(b)};d.prototype.toString=function(){return"<foreign fn>"};b.ForeignFunction=d;b.ForeignFunction.__name__=!0;b.ForeignFunction.__interfaces__=[b.Callable];Object.assign(b.ForeignFunction.prototype,{__class__:b.ForeignFunction});d=function(){};d.bestMatches=function(a,c,e){null==
e&&(e=2);for(var d=[],f=0;f<c.length;){var m=c[f];++f;var g=b.EditDistance.editDistance(a,m);g<e?(e=g,d=[m]):g==e&&d.push(m)}d.sort(function(a,b){return a<b?-1:1});return d};d.editDistance=function(a,b){for(var c=[],d=0,f=a.length+1;d<f;){++d;for(var m=[],g=0,h=b.length+1;g<h;)++g,m.push(0);c.push(m)}d=0;for(f=a.length+1;d<f;)m=d++,c[m][0]=m;d=0;for(f=b.length+1;d<f;)m=d++,c[0][m]=m;d=1;for(f=a.length+1;d<f;)for(m=d++,g=1,h=b.length+1;g<h;){var k=g++;if(a.charAt(m-1)==b.charAt(k-1))c[m][k]=c[m-1][k-
1];else{var n=[1+c[m][k-1],1+c[m-1][k],1+c[m-1][k-1]];n.sort(function(a,b){return a-b});c[m][k]=n[0]}}return c[a.length][b.length]};b.EditDistance=d;b.EditDistance.__name__=!0;b.Expr=v["cosy.Expr"]={__ename__:!0,__constructs__:null,ArrayLiteral:(f=function(a,b){return{_hx_index:0,keyword:a,exprs:b,__enum__:"cosy.Expr",toString:g}},f._hx_name="ArrayLiteral",f.__params__=["keyword","exprs"],f),Assign:(f=function(a,b,e){return{_hx_index:1,name:a,op:b,value:e,__enum__:"cosy.Expr",toString:g}},f._hx_name=
"Assign",f.__params__=["name","op","value"],f),Binary:(f=function(a,b,e){return{_hx_index:2,left:a,op:b,right:e,__enum__:"cosy.Expr",toString:g}},f._hx_name="Binary",f.__params__=["left","op","right"],f),Call:(f=function(a,b,e){return{_hx_index:3,callee:a,paren:b,$arguments:e,__enum__:"cosy.Expr",toString:g}},f._hx_name="Call",f.__params__=["callee","paren","$arguments"],f),Get:(f=function(a,b){return{_hx_index:4,obj:a,name:b,__enum__:"cosy.Expr",toString:g}},f._hx_name="Get",f.__params__=["obj",
"name"],f),Grouping:(f=function(a){return{_hx_index:5,e:a,__enum__:"cosy.Expr",toString:g}},f._hx_name="Grouping",f.__params__=["e"],f),Literal:(f=function(a){return{_hx_index:6,v:a,__enum__:"cosy.Expr",toString:g}},f._hx_name="Literal",f.__params__=["v"],f),Logical:(f=function(a,b,e){return{_hx_index:7,left:a,op:b,right:e,__enum__:"cosy.Expr",toString:g}},f._hx_name="Logical",f.__params__=["left","op","right"],f),MutArgument:(f=function(a,b){return{_hx_index:8,keyword:a,name:b,__enum__:"cosy.Expr",
toString:g}},f._hx_name="MutArgument",f.__params__=["keyword","name"],f),Set:(f=function(a,b,e){return{_hx_index:9,obj:a,name:b,value:e,__enum__:"cosy.Expr",toString:g}},f._hx_name="Set",f.__params__=["obj","name","value"],f),StructInit:(f=function(a,b){return{_hx_index:10,name:a,decls:b,__enum__:"cosy.Expr",toString:g}},f._hx_name="StructInit",f.__params__=["name","decls"],f),Unary:(f=function(a,b){return{_hx_index:11,op:a,right:b,__enum__:"cosy.Expr",toString:g}},f._hx_name="Unary",f.__params__=
["op","right"],f),Variable:(f=function(a){return{_hx_index:12,name:a,__enum__:"cosy.Expr",toString:g}},f._hx_name="Variable",f.__params__=["name"],f),AnonFunction:(f=function(a,b,e){return{_hx_index:13,params:a,body:b,returnType:e,__enum__:"cosy.Expr",toString:g}},f._hx_name="AnonFunction",f.__params__=["params","body","returnType"],f)};b.Expr.__constructs__=[b.Expr.ArrayLiteral,b.Expr.Assign,b.Expr.Binary,b.Expr.Call,b.Expr.Get,b.Expr.Grouping,b.Expr.Literal,b.Expr.Logical,b.Expr.MutArgument,b.Expr.Set,
b.Expr.StructInit,b.Expr.Unary,b.Expr.Variable,b.Expr.AnonFunction];d=function(a,b,e,d,f){this.name=a;this.params=b;this.body=e;this.closure=d;this.isInitializer=f};d.prototype.arity=function(){return this.params.length};d.prototype.call=function(a,c){for(var e=new b.Environment(this.closure),d=0,f=this.params.length;d<f;){var m=d++;e.define(this.params[m].name.lexeme,c[m])}try{a.executeBlock(this.body,e)}catch(z){if(a=h.Exception.caught(z).unwrap(),a instanceof b.Return){if(!this.isInitializer)return a.value}else throw z;
}return this.isInitializer?this.closure.getAt(0,"this"):null};d.prototype.toString=function(){return null!=this.name?"<fn "+this.name.lexeme+">":"<fn>"};b.Function=d;b.Function.__name__=!0;b.Function.__interfaces__=[b.Callable];Object.assign(b.Function.prototype,{__class__:b.Function});d=function(a){var c=b.Error.call(this)||this;c.value=a;return c};$jscomp.inherits(d,b.Error);b.Return=d;b.Return.__name__=!0;b.Return.__super__=b.Error;Object.assign(b.Return.prototype,{__class__:b.Return});d=function(a,
c){c=b.Error.call(this,c)||this;c.token=a;return c};$jscomp.inherits(d,b.Error);b.RuntimeError=d;b.RuntimeError.__name__=!0;b.RuntimeError.__super__=b.Error;Object.assign(b.RuntimeError.prototype,{__class__:b.RuntimeError});b.Stmt=v["cosy.Stmt"]={__ename__:!0,__constructs__:null,Block:(f=function(a){return{_hx_index:0,statements:a,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Block",f.__params__=["statements"],f),Break:(f=function(a){return{_hx_index:1,keyword:a,__enum__:"cosy.Stmt",toString:g}},
f._hx_name="Break",f.__params__=["keyword"],f),Continue:(f=function(a){return{_hx_index:2,keyword:a,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Continue",f.__params__=["keyword"],f),Expression:(f=function(a){return{_hx_index:3,e:a,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Expression",f.__params__=["e"],f),For:(f=function(a,b,e,d,f){return{_hx_index:4,keyword:a,name:b,from:e,to:d,body:f,__enum__:"cosy.Stmt",toString:g}},f._hx_name="For",f.__params__=["keyword","name","from","to","body"],f),ForArray:(f=
function(a,b,e){return{_hx_index:5,name:a,array:b,body:e,__enum__:"cosy.Stmt",toString:g}},f._hx_name="ForArray",f.__params__=["name","array","body"],f),ForCondition:(f=function(a,b){return{_hx_index:6,cond:a,body:b,__enum__:"cosy.Stmt",toString:g}},f._hx_name="ForCondition",f.__params__=["cond","body"],f),Function:(f=function(a,b,e,d,f){return{_hx_index:7,name:a,params:b,body:e,returnType:d,foreign:f,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Function",f.__params__=["name","params","body","returnType",
"foreign"],f),If:(f=function(a,b,e){return{_hx_index:8,cond:a,then:b,el:e,__enum__:"cosy.Stmt",toString:g}},f._hx_name="If",f.__params__=["cond","then","el"],f),Print:(f=function(a,b){return{_hx_index:9,keyword:a,e:b,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Print",f.__params__=["keyword","e"],f),Return:(f=function(a,b){return{_hx_index:10,keyword:a,value:b,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Return",f.__params__=["keyword","value"],f),Struct:(f=function(a,b){return{_hx_index:11,name:a,
declarations:b,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Struct",f.__params__=["name","declarations"],f),Var:(f=function(a,b,e,d,f){return{_hx_index:12,name:a,type:b,init:e,mut:d,foreign:f,__enum__:"cosy.Stmt",toString:g}},f._hx_name="Var",f.__params__=["name","type","init","mut","foreign"],f)};b.Stmt.__constructs__=[b.Stmt.Block,b.Stmt.Break,b.Stmt.Continue,b.Stmt.Expression,b.Stmt.For,b.Stmt.ForArray,b.Stmt.ForCondition,b.Stmt.Function,b.Stmt.If,b.Stmt.Print,b.Stmt.Return,b.Stmt.Struct,b.Stmt.Var];
d=function(a,b){this.structName=a;this.fields=b};d.prototype.clone=function(){for(var a=new h.ds.StringMap,c=this.fields.h,e=Object.keys(c),d=e.length,f=0;f<d;){var m=e[f++],g=c[m];g instanceof b.StructInstance&&(g=g.clone());a.h[m]=g}return new b.StructInstance(this.structName,a)};d.prototype.get=function(a){if(Object.prototype.hasOwnProperty.call(this.fields.h,a.lexeme))return this.fields.h[a.lexeme];throw h.Exception.thrown(new b.RuntimeError(a,'Undefined property "'+a.lexeme+'".'));};d.prototype.set=
function(a,c){Object.prototype.hasOwnProperty.call(this.fields.h,a.lexeme)?this.fields.h[a.lexeme]=c:b.Cosy.error(b.ErrorDataType.Token(a),""+a.lexeme+" is not a property of "+a.lexeme)};d.prototype.toString=function(){for(var a=function(a){return"string"==typeof a?'"'+(null==a?"null":t.string(a))+'"':""+(null==a?"null":t.string(a))},b=[],e=this.fields.h,d=Object.keys(e),f=d.length,m=0;m<f;){var g=d[m++];b.push(""+g+" = "+a(e[g]))}b.sort(function(a,b){return a<b?-1:b<a?1:0});return""+this.structName.lexeme+
" { "+b.join(", ")+" }"};b.StructInstance=d;b.StructInstance.__name__=!0;Object.assign(b.StructInstance.prototype,{__class__:b.StructInstance});d=function(a,b,e,d){this.type=a;this.lexeme=b;this.literal=e;this.line=d};d.prototype.toString=function(){return"Token { type: "+t.string(this.type)+', lexeme: "'+this.lexeme+'"'+(null!=this.literal?", literal: "+(null==this.literal?"null":t.string(this.literal)):"")+" }"};b.Token=d;b.Token.__name__=!0;Object.assign(b.Token.prototype,{__class__:b.Token});
b.TokenType=v["cosy.TokenType"]={__ename__:!0,__constructs__:null,LeftParen:{_hx_name:"LeftParen",_hx_index:0,__enum__:"cosy.TokenType",toString:g},RightParen:{_hx_name:"RightParen",_hx_index:1,__enum__:"cosy.TokenType",toString:g},LeftBrace:{_hx_name:"LeftBrace",_hx_index:2,__enum__:"cosy.TokenType",toString:g},RightBrace:{_hx_name:"RightBrace",_hx_index:3,__enum__:"cosy.TokenType",toString:g},LeftBracket:{_hx_name:"LeftBracket",_hx_index:4,__enum__:"cosy.TokenType",toString:g},RightBracket:{_hx_name:"RightBracket",
_hx_index:5,__enum__:"cosy.TokenType",toString:g},Comma:{_hx_name:"Comma",_hx_index:6,__enum__:"cosy.TokenType",toString:g},Dot:{_hx_name:"Dot",_hx_index:7,__enum__:"cosy.TokenType",toString:g},DotDot:{_hx_name:"DotDot",_hx_index:8,__enum__:"cosy.TokenType",toString:g},Underscore:{_hx_name:"Underscore",_hx_index:9,__enum__:"cosy.TokenType",toString:g},Minus:{_hx_name:"Minus",_hx_index:10,__enum__:"cosy.TokenType",toString:g},MinusEqual:{_hx_name:"MinusEqual",_hx_index:11,__enum__:"cosy.TokenType",
toString:g},Plus:{_hx_name:"Plus",_hx_index:12,__enum__:"cosy.TokenType",toString:g},PlusEqual:{_hx_name:"PlusEqual",_hx_index:13,__enum__:"cosy.TokenType",toString:g},Slash:{_hx_name:"Slash",_hx_index:14,__enum__:"cosy.TokenType",toString:g},SlashEqual:{_hx_name:"SlashEqual",_hx_index:15,__enum__:"cosy.TokenType",toString:g},Star:{_hx_name:"Star",_hx_index:16,__enum__:"cosy.TokenType",toString:g},StarEqual:{_hx_name:"StarEqual",_hx_index:17,__enum__:"cosy.TokenType",toString:g},Bang:{_hx_name:"Bang",
_hx_index:18,__enum__:"cosy.TokenType",toString:g},BangEqual:{_hx_name:"BangEqual",_hx_index:19,__enum__:"cosy.TokenType",toString:g},Equal:{_hx_name:"Equal",_hx_index:20,__enum__:"cosy.TokenType",toString:g},EqualEqual:{_hx_name:"EqualEqual",_hx_index:21,__enum__:"cosy.TokenType",toString:g},Greater:{_hx_name:"Greater",_hx_index:22,__enum__:"cosy.TokenType",toString:g},GreaterEqual:{_hx_name:"GreaterEqual",_hx_index:23,__enum__:"cosy.TokenType",toString:g},Less:{_hx_name:"Less",_hx_index:24,__enum__:"cosy.TokenType",
toString:g},LessEqual:{_hx_name:"LessEqual",_hx_index:25,__enum__:"cosy.TokenType",toString:g},Identifier:{_hx_name:"Identifier",_hx_index:26,__enum__:"cosy.TokenType",toString:g},String:{_hx_name:"String",_hx_index:27,__enum__:"cosy.TokenType",toString:g},Number:{_hx_name:"Number",_hx_index:28,__enum__:"cosy.TokenType",toString:g},And:{_hx_name:"And",_hx_index:29,__enum__:"cosy.TokenType",toString:g},Break:{_hx_name:"Break",_hx_index:30,__enum__:"cosy.TokenType",toString:g},Continue:{_hx_name:"Continue",
_hx_index:31,__enum__:"cosy.TokenType",toString:g},Else:{_hx_name:"Else",_hx_index:32,__enum__:"cosy.TokenType",toString:g},False:{_hx_name:"False",_hx_index:33,__enum__:"cosy.TokenType",toString:g},Fn:{_hx_name:"Fn",_hx_index:34,__enum__:"cosy.TokenType",toString:g},For:{_hx_name:"For",_hx_index:35,__enum__:"cosy.TokenType",toString:g},Foreign:{_hx_name:"Foreign",_hx_index:36,__enum__:"cosy.TokenType",toString:g},In:{_hx_name:"In",_hx_index:37,__enum__:"cosy.TokenType",toString:g},If:{_hx_name:"If",
_hx_index:38,__enum__:"cosy.TokenType",toString:g},Mut:{_hx_name:"Mut",_hx_index:39,__enum__:"cosy.TokenType",toString:g},Or:{_hx_name:"Or",_hx_index:40,__enum__:"cosy.TokenType",toString:g},Print:{_hx_name:"Print",_hx_index:41,__enum__:"cosy.TokenType",toString:g},Return:{_hx_name:"Return",_hx_index:42,__enum__:"cosy.TokenType",toString:g},Struct:{_hx_name:"Struct",_hx_index:43,__enum__:"cosy.TokenType",toString:g},True:{_hx_name:"True",_hx_index:44,__enum__:"cosy.TokenType",toString:g},Var:{_hx_name:"Var",
_hx_index:45,__enum__:"cosy.TokenType",toString:g},BooleanType:{_hx_name:"BooleanType",_hx_index:46,__enum__:"cosy.TokenType",toString:g},NumberType:{_hx_name:"NumberType",_hx_index:47,__enum__:"cosy.TokenType",toString:g},StringType:{_hx_name:"StringType",_hx_index:48,__enum__:"cosy.TokenType",toString:g},VoidType:{_hx_name:"VoidType",_hx_index:49,__enum__:"cosy.TokenType",toString:g},FunctionType:{_hx_name:"FunctionType",_hx_index:50,__enum__:"cosy.TokenType",toString:g},ArrayType:{_hx_name:"ArrayType",
_hx_index:51,__enum__:"cosy.TokenType",toString:g},Eof:{_hx_name:"Eof",_hx_index:52,__enum__:"cosy.TokenType",toString:g}};b.TokenType.__constructs__=[b.TokenType.LeftParen,b.TokenType.RightParen,b.TokenType.LeftBrace,b.TokenType.RightBrace,b.TokenType.LeftBracket,b.TokenType.RightBracket,b.TokenType.Comma,b.TokenType.Dot,b.TokenType.DotDot,b.TokenType.Underscore,b.TokenType.Minus,b.TokenType.MinusEqual,b.TokenType.Plus,b.TokenType.PlusEqual,b.TokenType.Slash,b.TokenType.SlashEqual,b.TokenType.Star,
b.TokenType.StarEqual,b.TokenType.Bang,b.TokenType.BangEqual,b.TokenType.Equal,b.TokenType.EqualEqual,b.TokenType.Greater,b.TokenType.GreaterEqual,b.TokenType.Less,b.TokenType.LessEqual,b.TokenType.Identifier,b.TokenType.String,b.TokenType.Number,b.TokenType.And,b.TokenType.Break,b.TokenType.Continue,b.TokenType.Else,b.TokenType.False,b.TokenType.Fn,b.TokenType.For,b.TokenType.Foreign,b.TokenType.In,b.TokenType.If,b.TokenType.Mut,b.TokenType.Or,b.TokenType.Print,b.TokenType.Return,b.TokenType.Struct,
b.TokenType.True,b.TokenType.Var,b.TokenType.BooleanType,b.TokenType.NumberType,b.TokenType.StringType,b.TokenType.VoidType,b.TokenType.FunctionType,b.TokenType.ArrayType,b.TokenType.Eof];b.VariableType=v["cosy.VariableType"]={__ename__:!0,__constructs__:null,Unknown:{_hx_name:"Unknown",_hx_index:0,__enum__:"cosy.VariableType",toString:g},Void:{_hx_name:"Void",_hx_index:1,__enum__:"cosy.VariableType",toString:g},Boolean:{_hx_name:"Boolean",_hx_index:2,__enum__:"cosy.VariableType",toString:g},Number:{_hx_name:"Number",
_hx_index:3,__enum__:"cosy.VariableType",toString:g},Text:{_hx_name:"Text",_hx_index:4,__enum__:"cosy.VariableType",toString:g},Instance:{_hx_name:"Instance",_hx_index:5,__enum__:"cosy.VariableType",toString:g},Function:(f=function(a,b){return{_hx_index:6,paramTypes:a,returnType:b,__enum__:"cosy.VariableType",toString:g}},f._hx_name="Function",f.__params__=["paramTypes","returnType"],f),Array:(f=function(a){return{_hx_index:7,type:a,__enum__:"cosy.VariableType",toString:g}},f._hx_name="Array",f.__params__=
["type"],f),Struct:(f=function(a){return{_hx_index:8,variables:a,__enum__:"cosy.VariableType",toString:g}},f._hx_name="Struct",f.__params__=["variables"],f),NamedStruct:(f=function(a){return{_hx_index:9,name:a,__enum__:"cosy.VariableType",toString:g}},f._hx_name="NamedStruct",f.__params__=["name"],f),Mutable:(f=function(a){return{_hx_index:10,type:a,__enum__:"cosy.VariableType",toString:g}},f._hx_name="Mutable",f.__params__=["type"],f)};b.VariableType.__constructs__=[b.VariableType.Unknown,b.VariableType.Void,
b.VariableType.Boolean,b.VariableType.Number,b.VariableType.Text,b.VariableType.Instance,b.VariableType.Function,b.VariableType.Array,b.VariableType.Struct,b.VariableType.NamedStruct,b.VariableType.Mutable];d=function(){this.indentAmount=0};d.prototype.indent=function(){for(var a=[],b=0,e=this.indentAmount;b<e;)++b,a.push("  ");return a.join("")};d.prototype.printStmts=function(a){for(var b=[],e=0;e<a.length;){var d=a[e++];b.push(this.indent()+this.printStmt(d))}return b.join("\n")};d.prototype.printBlock=
function(a){this.indentAmount++;a=this.printStmts(a);this.indentAmount--;return"{\n"+a+"\n"+this.indent()+"}"};d.prototype.printExprs=function(a){for(var b=[],e=0;e<a.length;){var d=a[e++];b.push(this.indent()+this.printExpr(d))}return b.join("\n")};d.prototype.printExprBlock=function(a){this.indentAmount++;a=this.printExprs(a);this.indentAmount--;return"{\n"+a+"\n"+this.indent()+"}"};d.prototype.printStmt=function(a){switch(a._hx_index){case 0:return this.printBlock(a.statements);case 1:return a.keyword.lexeme;
case 2:return a.keyword.lexeme;case 3:return""+this.printExpr(a.e);case 4:var b=a.name;return"for "+(null!=b?b.lexeme+" in ":"")+this.printExpr(a.from)+".."+this.printExpr(a.to)+" "+this.printBlock(a.body);case 5:return"for "+a.name.lexeme+" in "+this.printExpr(a.array)+" "+this.printBlock(a.body);case 6:return b=a.cond,"for "+(null!=b?this.printExpr(b):"")+" "+this.printBlock(a.body);case 7:b=a.foreign;var e=""+(b?"foreign fn":"fn")+" "+a.name.lexeme,d=this.formatParams(a.params);return b?""+e+"("+
d+")":""+e+"("+d+") "+this.printBlock(a.body);case 8:return b=a.el,"if "+this.printExpr(a.cond)+" "+this.printStmt(a.then)+(null!=b?" else "+this.printStmt(b):"");case 9:return""+a.keyword.lexeme+" "+this.printExpr(a.e);case 10:return b=a.value,a.keyword.lexeme+(null!=b?" "+this.printExpr(b):"");case 11:return"struct "+a.name.lexeme+" "+this.printBlock(a.declarations);case 12:return b=a.init,""+(a.foreign?"foreign ":"")+(a.mut?"mut":"var")+" "+a.name.lexeme+(null!=b?" = "+this.printExpr(b):"")}};
d.prototype.printExpr=function(a){switch(a._hx_index){case 0:var c=a.exprs;a=[];for(var e=0;e<c.length;)a.push(this.printExpr(c[e++]));return"["+a.join(",")+"]";case 1:return""+a.name.lexeme+" "+a.op.lexeme+" "+this.printExpr(a.value);case 2:return""+this.printExpr(a.left)+" "+a.op.lexeme+" "+this.printExpr(a.right);case 3:c=a.$arguments;a=""+this.printExpr(a.callee)+"(";e=[];for(var d=0;d<c.length;)e.push(this.printExpr(c[d++]));return a+e.join(", ")+")";case 4:return""+this.printExpr(a.obj)+"."+
a.name.lexeme;case 5:return"("+this.printExpr(a.e)+")";case 6:return c=a.v,"string"==typeof c?"'"+(null==c?"null":t.string(c))+"'":""+(null==c?"null":t.string(c));case 7:return""+this.printExpr(a.left)+" "+(40==a.op.type._hx_index?"or":"and")+" "+this.printExpr(a.right);case 8:return"mut "+a.name.lexeme;case 9:return""+this.printExpr(a.obj)+"."+a.name.lexeme+" = "+this.printExpr(a.value);case 10:return this.printExprBlock(a.decls);case 11:return""+a.op.lexeme+this.printExpr(a.right);case 12:return a.name.lexeme;
case 13:return"fn ("+this.formatParams(a.params)+") "+this.printStmt(b.Stmt.Block(a.body))}};d.prototype.formatType=function(a){switch(a._hx_index){case 0:return"";case 2:return"Bool";case 3:return"Num";case 4:return"Str";case 6:a=a.paramTypes;for(var b=[],e=0;e<a.length;)b.push(this.formatType(a[e++]));return"Fn("+b.join(", ")+")";case 7:return x.trim("Array "+this.formatType(a.type));default:return""+t.string(a)}};d.prototype.formatParams=function(a){for(var b=[],e=0;e<a.length;)b.push(this.formatParam(a[e++]));
return b.join(", ")};d.prototype.formatParam=function(a){var b=this.formatType(a.type);return a.name.lexeme+(""!=b?" "+b:"")};b.phases.AstPrinter=d;b.phases.AstPrinter.__name__=!0;Object.assign(b.phases.AstPrinter.prototype,{__class__:b.phases.AstPrinter});d=function(a,b){this.arityValue=a;this.method=b};d.prototype.arity=function(){return this.arityValue};d.prototype.call=function(a,b){return this.method(b)};d.prototype.toString=function(){return"<native fn>"};b.phases._Interpreter.CustomCallable=
d;b.phases._Interpreter.CustomCallable.__name__=!0;b.phases._Interpreter.CustomCallable.__interfaces__=[b.Callable];Object.assign(b.phases._Interpreter.CustomCallable.prototype,{__class__:b.phases._Interpreter.CustomCallable});d=function(){this.indentAmount=0};d.prototype.indent=function(){for(var a=[],b=0,e=this.indentAmount;b<e;)++b,a.push("  ");return a.join("")};d.prototype.printBlock=function(a){this.indentAmount++;for(var b=[],e=0;e<a.length;){var d=a[e++];b.push(this.indent()+this.printStmt(d))}a=
b.join("\n");this.indentAmount--;return"{\n"+a+"\n"+this.indent()+"}"};d.prototype.printStmt=function(a){switch(a._hx_index){case 0:return this.printBlock(a.statements);case 1:return"break;";case 2:return"continue;";case 3:return""+this.printExpr(a.e)+";";case 4:var c=a.name;c=null!=c?c.lexeme:"__i";return"for (var "+c+" = "+this.printExpr(a.from)+"; "+c+" < "+this.printExpr(a.to)+"; "+c+"++) "+this.printBlock(a.body);case 5:return"for ("+a.name.lexeme+" of "+this.printExpr(a.array)+") "+this.printBlock(a.body);
case 6:return c=a.cond,"while ("+(null!=c?this.printExpr(c):"true")+") "+this.printBlock(a.body);case 7:c=a.params;var e=a.body;if(a.foreign)return"";a="function "+a.name.lexeme;for(var d=[],f=0;f<c.length;)d.push(c[f++].name.lexeme);return""+a+"("+d.join(",")+") "+this.printStmt(b.Stmt.Block(e));case 8:return c=a.el,"if ("+this.printExpr(a.cond)+") "+this.printStmt(a.then)+(null!=c?" else "+this.printStmt(c):"");case 9:return"console.log("+this.printExpr(a.e)+");";case 10:return a=a.value,"return"+
(null!=a?" "+this.printExpr(a):"")+";";case 11:return"// "+a.name.lexeme+" struct";case 12:return c=a.init,a.foreign?"":""+(a.mut?"var":"const")+" "+a.name.lexeme+(null!=c?" = "+this.printExpr(c):"")+";"}};d.prototype.printExpr=function(a){switch(a._hx_index){case 0:var c=a.exprs;a=p(this,this.printExpr);for(var e=Array(c.length),d=0,f=c.length;d<f;){var g=d++;e[g]=a(c[g])}return"["+e.join(", ")+"]";case 1:return""+a.name.lexeme+" "+a.op.lexeme+" "+this.printExpr(a.value);case 2:return c=a.op,""+
this.printExpr(a.left)+" "+(21==c.type._hx_index?"===":c.lexeme)+" "+this.printExpr(a.right);case 3:c=a.$arguments;a=""+this.printExpr(a.callee)+"(";e=p(this,this.printExpr);d=Array(c.length);f=0;for(g=c.length;f<g;){var h=f++;d[h]=e(c[h])}return a+d.join(",")+")";case 4:return""+this.printExpr(a.obj)+"."+a.name.lexeme;case 5:return"("+this.printExpr(a.e)+")";case 6:return c=a.v,null==c?"null":"string"==typeof c?'"'+(null==c?"null":t.string(c))+'"':""+(null==c?"null":t.string(c));case 7:return""+
this.printExpr(a.left)+" "+(40==a.op.type._hx_index?"||":"&&")+" "+this.printExpr(a.right);case 8:return a.name.lexeme;case 9:return""+this.printExpr(a.obj)+"."+a.name.lexeme+" = "+this.printExpr(a.value);case 10:c=a.decls;a=[];for(e=0;e<c.length;)a.push(x.replace(this.printExpr(c[e++])," = ",": "));return"{ "+a.join(", ")+" }";case 11:return""+a.op.lexeme+this.printExpr(a.right);case 12:return a.name.lexeme;case 13:c=a.params;a=a.body;e=[];for(d=0;d<c.length;)e.push(c[d++].name.lexeme);return"function ("+
e.join(", ")+") "+this.printStmt(b.Stmt.Block(a))}};b.phases.JavaScriptPrinter=d;b.phases.JavaScriptPrinter.__name__=!0;Object.assign(b.phases.JavaScriptPrinter.prototype,{__class__:b.phases.JavaScriptPrinter});d=function(){this.astPrinter=new b.phases.AstPrinter};d.prototype.printStmt=function(a){if(7==a._hx_index){if(a.foreign)return"";var b="### `"+a.name.lexeme+"("+this.astPrinter.formatParams(a.params)+") "+t.string(a.returnType)+"`\n";return b+="<details>\n<summary>Code</summary>\n\n```js\n"+
this.astPrinter.printStmts(a.body)+"\n```\n</details>\n\n"}return""};b.phases.MarkdownPrinter=d;b.phases.MarkdownPrinter.__name__=!0;Object.assign(b.phases.MarkdownPrinter.prototype,{__class__:b.phases.MarkdownPrinter});d=function(){};d.prototype.optimizeStmts=function(a){for(var b=[],e=0;e<a.length;)b.push(this.optimizeStmt(a[e++]));return b};d.prototype.optimizeStmt=function(a){switch(a._hx_index){case 0:return b.Stmt.Block(this.optimizeStmts(a.statements));case 3:return b.Stmt.Expression(this.optimizeExpr(a.e));
case 8:var c=a.el;return b.Stmt.If(this.optimizeExpr(a.cond),this.optimizeStmt(a.then),null!=c?this.optimizeStmt(c):null);case 9:return b.Stmt.Print(a.keyword,this.optimizeExpr(a.e));case 10:return c=a.value,b.Stmt.Return(a.keyword,null!=c?this.optimizeExpr(c):null);case 12:return c=a.init,b.Stmt.Var(a.name,a.type,null!=c?this.optimizeExpr(c):c,a.mut,a.foreign);default:return a}};d.prototype.optimizeExpr=function(a){switch(a._hx_index){case 2:var c=a.op,e=this.optimizeExpr(a.left);a=this.optimizeExpr(a.right);
if(6==e._hx_index){var d=e.v;if(6==a._hx_index){var f=a.v;if("number"==typeof d&&"number"==typeof f){switch(c.type._hx_index){case 10:c=d-f;break;case 12:c=d+f;break;case 14:c=d/f;break;case 16:c=d*f;break;case 19:c=d!=f;break;case 21:c=d==f;break;case 22:c=d>f;break;case 23:c=d>=f;break;case 24:c=d<f;break;case 25:c=d<=f;break;default:return b.Cosy.error(b.ErrorDataType.Token(c),"Invalid operator."),b.Expr.Binary(e,c,a)}return b.Expr.Literal(c)}return"string"==typeof d&&"string"==typeof f?b.Expr.Literal(d+
f):b.Expr.Binary(e,c,a)}}return b.Expr.Binary(e,c,a);case 7:c=a.op;e=this.optimizeExpr(a.left);a=this.optimizeExpr(a.right);if(6==e._hx_index&&(d=e.v,6==a._hx_index&&(f=a.v,"boolean"==typeof d&&"boolean"==typeof f))){switch(c.type._hx_index){case 29:c=d&&f;break;case 40:c=d||f;break;default:return b.Cosy.error(b.ErrorDataType.Token(c),"Invalid operator."),b.Expr.Binary(e,c,a)}return b.Expr.Literal(c)}return b.Expr.Logical(e,c,a);default:return a}};b.phases.Optimizer=d;b.phases.Optimizer.__name__=
!0;Object.assign(b.phases.Optimizer.prototype,{__class__:b.phases.Optimizer});d=function(a){this.current=0;this.structNames=[];this.tokens=a};d.prototype.parse=function(){for(var a=[];!this.isAtEnd();)a.push(this.declaration());return a};d.prototype.expression=function(){return this.assignment()};d.prototype.declaration=function(){try{if(this.match([b.TokenType.Struct]))return this.structDeclaration();var a=this.match([b.TokenType.Foreign]);return this.match([b.TokenType.Fn])?this.func("function",
a):this.match([b.TokenType.Var])?this.varDeclaration(!1,a):this.match([b.TokenType.Mut])?this.varDeclaration(!0,a):this.statement()}catch(c){if(h.Exception.caught(c).unwrap()instanceof b.phases._Parser.ParseError)return this.synchronize(),null;throw c;}};d.prototype.statement=function(){return this.match([b.TokenType.For])?this.forStatement():this.match([b.TokenType.If])?this.ifStatement():this.match([b.TokenType.Print])?this.printStatement():this.match([b.TokenType.Return])?this.returnStatement():
this.match([b.TokenType.Break])?b.Stmt.Break(this.previous()):this.match([b.TokenType.Continue])?b.Stmt.Continue(this.previous()):this.match([b.TokenType.LeftBrace])?b.Stmt.Block(this.block()):this.expressionStatement()};d.prototype.forStatement=function(){if(this.checkUntil(b.TokenType.DotDot,b.TokenType.LeftBrace)){var a=this.previous(),c=null;this.check(b.TokenType.Identifier)&&(c=this.consume(b.TokenType.Identifier,"Expect variable name."),c.lexeme.startsWith("_")&&this.error(c,"Loop counters cannot be marked as unused. Use `for min...max` syntax instead."),
this.consume(b.TokenType.In,'Expect "in" after for loop identifier.'));var e=this.expression();this.consume(b.TokenType.DotDot,'Expect ".." between from and to numbers.');var d=this.expression();this.consume(b.TokenType.LeftBrace,'Expect "{" before loop body.');return b.Stmt.For(a,c,e,d,this.block())}if(this.checkUntil(b.TokenType.In,b.TokenType.LeftBrace))return a=this.consume(b.TokenType.Identifier,"Expect variable name."),this.consume(b.TokenType.In,'Expect "in" after for loop identifier.'),c=
this.expression(),this.consume(b.TokenType.LeftBrace,'Expect "{" before loop body.'),b.Stmt.ForArray(a,c,this.block());a=this.check(b.TokenType.LeftBrace)?null:this.expression();this.consume(b.TokenType.LeftBrace,'Expect "{" before loop body.');return b.Stmt.ForCondition(a,this.block())};d.prototype.ifStatement=function(){return b.Stmt.If(this.expression(),this.statement(),this.match([b.TokenType.Else])?this.statement():null)};d.prototype.printStatement=function(){return b.Stmt.Print(this.previous(),
this.expression())};d.prototype.returnStatement=function(){return b.Stmt.Return(this.previous(),this.match([b.TokenType.Underscore])?null:this.expression())};d.prototype.expressionStatement=function(){return b.Stmt.Expression(this.expression())};d.prototype.block=function(){for(var a=[];!this.check(b.TokenType.RightBrace)&&!this.isAtEnd();)a.push(this.declaration());this.consume(b.TokenType.RightBrace,'Expect "}" after block.');return a};d.prototype.varDeclaration=function(a,c){var e=this.consume(b.TokenType.Identifier,
"Expect variable name."),d=this.paramType(),f=null;!c&&this.match([b.TokenType.Equal])&&(f=this.expression());return b.Stmt.Var(e,d,f,a,c)};d.prototype.structDeclaration=function(){var a=this.consume(b.TokenType.Identifier,"Expect struct name");this.consume(b.TokenType.LeftBrace,'Expect "{" before struct body.');for(var c=[];!this.check(b.TokenType.RightBrace)&&!this.isAtEnd();)if(this.match([b.TokenType.Var]))c.push(this.varDeclaration(!1,!1));else if(this.match([b.TokenType.Mut]))c.push(this.varDeclaration(!0,
!1));else{b.Cosy.error(b.ErrorDataType.Token(this.tokens[this.current]),"Structs can only contain variable definitions.");break}this.structNames.push(a.lexeme);this.consume(b.TokenType.RightBrace,'Expect "}" after struct body.');return b.Stmt.Struct(a,c)};d.prototype.func=function(a,c){var e=this.consume(b.TokenType.Identifier,"Expect "+a+" name.");a=this.funcBody(a,c);if(13==a._hx_index)return b.Stmt.Function(e,a.params,a.body,a.returnType,c);throw h.Exception.thrown(new b.RuntimeError(e,"Invalid function declaration."));
};d.prototype.paramType=function(){if(this.match([b.TokenType.BooleanType]))return b.VariableType.Boolean;if(this.match([b.TokenType.NumberType]))return b.VariableType.Number;if(this.match([b.TokenType.StringType]))return b.VariableType.Text;if(this.match([b.TokenType.VoidType]))return b.VariableType.Void;if(this.match([b.TokenType.FunctionType])){this.consume(b.TokenType.LeftParen,'Expect "(" after Fun.');for(var a=[];!this.check(b.TokenType.RightParen)&&(a.push(this.paramType()),this.match([b.TokenType.Comma])););
this.consume(b.TokenType.RightParen,'Expect ")" after parameters.');var c=this.paramType();0==c._hx_index&&(c=b.VariableType.Void);return b.VariableType.Function(a,c)}return this.match([b.TokenType.ArrayType])?b.VariableType.Array(this.paramType()):this.check(b.TokenType.Identifier)&&-1!=this.structNames.indexOf(this.peek().lexeme)?b.VariableType.NamedStruct(this.advance().lexeme):b.VariableType.Unknown};d.prototype.funcBody=function(a,c){this.consume(b.TokenType.LeftParen,'Expect "(" after '+a+" name.");
var e=[];if(!this.check(b.TokenType.RightParen))for(;;){255<=e.length&&this.error(this.peek(),"Cannot have more than 255 parameters.");var d=this.match([b.TokenType.Mut]),f=this.consume(b.TokenType.Identifier,"Expect parameter name."),g=this.paramType();d&&(9!=g._hx_index&&0!=g._hx_index&&this.error(f,"Only struct parameters can be marked as `mut`."),g=b.VariableType.Mutable(g));e.push({name:f,type:g});if(!this.match([b.TokenType.Comma]))break}this.consume(b.TokenType.RightParen,'Expect ")" after parameters.');
d=this.paramType();if(c)return b.Expr.AnonFunction(e,[],d);this.consume(b.TokenType.LeftBrace,'Expect "{" before '+a+" body");return b.Expr.AnonFunction(e,this.block(),d)};d.prototype.assignment=function(){var a=this.or();if(this.match([b.TokenType.Equal,b.TokenType.PlusEqual,b.TokenType.MinusEqual,b.TokenType.SlashEqual,b.TokenType.StarEqual])){var c=this.previous(),e=this.assignment();switch(a._hx_index){case 4:return b.Expr.Set(a.obj,a.name,e);case 12:return b.Expr.Assign(a.name,c,e)}this.error(c,
"Invalid assignment target.")}return a};d.prototype.or=function(){for(var a=this.and();this.match([b.TokenType.Or]);)a=b.Expr.Logical(a,this.previous(),this.and());return a};d.prototype.and=function(){for(var a=this.equality();this.match([b.TokenType.And]);)a=b.Expr.Logical(a,this.previous(),this.equality());return a};d.prototype.equality=function(){for(var a=this.comparison();this.match([b.TokenType.BangEqual,b.TokenType.EqualEqual]);)a=b.Expr.Binary(a,this.previous(),this.comparison());return a};
d.prototype.comparison=function(){for(var a=this.addition();this.match([b.TokenType.Greater,b.TokenType.GreaterEqual,b.TokenType.Less,b.TokenType.LessEqual]);)a=b.Expr.Binary(a,this.previous(),this.addition());return a};d.prototype.addition=function(){for(var a=this.multiplication();this.match([b.TokenType.Minus,b.TokenType.Plus]);)a=b.Expr.Binary(a,this.previous(),this.multiplication());return a};d.prototype.multiplication=function(){for(var a=this.unary();this.match([b.TokenType.Star,b.TokenType.Slash]);)a=
b.Expr.Binary(a,this.previous(),this.multiplication());return a};d.prototype.unary=function(){return this.match([b.TokenType.Bang,b.TokenType.Minus])?b.Expr.Unary(this.previous(),this.unary()):this.call()};d.prototype.call=function(){for(var a=this.primary();;)if(this.match([b.TokenType.LeftParen]))a=this.finishCall(a);else if(this.match([b.TokenType.Dot]))a=b.Expr.Get(a,this.consume(b.TokenType.Identifier,'Expect property name after ".".'));else break;return a};d.prototype.finishCall=function(a){var c=
[];if(!this.check(b.TokenType.RightParen))for(;255<=c.length&&this.error(this.peek(),"Cannot have more than 255 arguments"),c.push(this.expression()),this.match([b.TokenType.Comma]););return b.Expr.Call(a,this.consume(b.TokenType.RightParen,'Expect ")" after arguments.'),c)};d.prototype.primary=function(){if(this.match([b.TokenType.False]))return b.Expr.Literal(!1);if(this.match([b.TokenType.True]))return b.Expr.Literal(!0);if(this.match([b.TokenType.Number,b.TokenType.String]))return b.Expr.Literal(this.previous().literal);
if(this.match([b.TokenType.Fn]))return this.funcBody("function",!1);if(this.match([b.TokenType.Identifier]))return this.identifier();if(this.match([b.TokenType.Mut]))return b.Expr.MutArgument(this.previous(),this.consume(b.TokenType.Identifier,'Expect variable name after "mut".'));if(this.match([b.TokenType.LeftParen])){var a=this.expression();this.consume(b.TokenType.RightParen,'Expect ")" after expression.');return b.Expr.Grouping(a)}if(this.match([b.TokenType.LeftBracket]))return this.arrayLiteral();
throw h.Exception.thrown(this.error(this.peek(),"Expect expression."));};d.prototype.arrayLiteral=function(){for(var a=this.previous(),c=[];!this.check(b.TokenType.RightBracket)&&!this.isAtEnd();)c.push(this.expression()),this.check(b.TokenType.RightBracket)||this.consume(b.TokenType.Comma,'Expect "," between array values.');this.consume(b.TokenType.RightBracket,'Expect "]" after array literal.');return b.Expr.ArrayLiteral(a,c)};d.prototype.identifier=function(){var a=this.previous();if(this.check(b.TokenType.LeftBrace)&&
-1!=this.structNames.indexOf(a.lexeme)){this.consume(b.TokenType.LeftBrace,'Expect "{" after struct name.');for(var c=[];!this.match([b.TokenType.RightBrace])&&!this.isAtEnd();)c.push(this.assignment()),this.check(b.TokenType.RightBrace)||this.consume(b.TokenType.Comma,'Expect "," between variable initializers.');return b.Expr.StructInit(a,c)}return b.Expr.Variable(a)};d.prototype.consume=function(a,b){if(this.check(a))return this.advance();throw h.Exception.thrown(this.error(this.peek(),b));};d.prototype.match=
function(a){for(var b=0;b<a.length;)if(this.check(a[b++]))return this.advance(),!0;return!1};d.prototype.check=function(a){return this.isAtEnd()?!1:this.peek().type==a};d.prototype.checkUntil=function(a,c){for(var e=this.current;;){if(this.tokens[e].type==a)return!0;++e;if(this.tokens[e].type==c||this.tokens[e].type==b.TokenType.Eof)break}return!1};d.prototype.advance=function(){this.isAtEnd()||this.current++;return this.previous()};d.prototype.isAtEnd=function(){return this.peek().type==b.TokenType.Eof};
d.prototype.peek=function(){return this.tokens[this.current]};d.prototype.previous=function(){return this.tokens[this.current-1]};d.prototype.error=function(a,c){b.Cosy.error(b.ErrorDataType.Token(a),c);return new b.phases._Parser.ParseError};d.prototype.synchronize=function(){for(this.advance();!this.isAtEnd();)switch(this.peek().type._hx_index){case 30:case 31:case 34:case 35:case 36:case 38:case 41:case 42:case 43:case 45:return;default:this.advance()}};b.phases.Parser=d;b.phases.Parser.__name__=
!0;Object.assign(b.phases.Parser.prototype,{__class__:b.phases.Parser});b.phases._Parser={};d=function(a){return b.Error.call(this,a)||this};$jscomp.inherits(d,b.Error);b.phases._Parser.ParseError=d;b.phases._Parser.ParseError.__name__=!0;b.phases._Parser.ParseError.__super__=b.Error;Object.assign(b.phases._Parser.ParseError.prototype,{__class__:b.phases._Parser.ParseError});d=function(a){this.currentStruct=b.phases._Resolver.StructType.None;this.currentFunction=b.phases._Resolver.FunctionType.None;
this.scopes=[];this.interpreter=a};d.prototype.resolveStmts=function(a){for(var c=null,e=0;e<a.length;){var d=a[e];++e;switch(d._hx_index){case 1:c=d.keyword;break;case 2:c=d.keyword;break;case 10:c=d.keyword;break;default:null!=c&&(b.Cosy.error(b.ErrorDataType.Token(c),"Unreachable code after return statement."),c=null)}this.resolveStmt(d)}};d.prototype.resolveStmt=function(a){switch(a._hx_index){case 0:this.beginScope();this.resolveStmts(a.statements);this.endScope();break;case 3:this.resolveExpr(a.e);
break;case 4:var c=a.name,e=a.body;this.resolveExpr(a.from);this.resolveExpr(a.to);this.beginScope();null!=c&&(this.declare(c),this.define(c));0==e.length&&b.Cosy.error(b.ErrorDataType.Token(a.keyword),"Loop body is empty.");this.resolveStmts(e);this.endScope();break;case 5:c=a.name;e=a.body;this.resolveExpr(a.array);this.beginScope();this.declare(c);this.define(c);0==e.length&&b.Cosy.error(b.ErrorDataType.Token(c),"Loop body is empty.");this.resolveStmts(e);this.endScope();break;case 6:c=a.cond;
null!=c&&this.resolveExpr(c);this.beginScope();this.resolveStmts(a.body);this.endScope();break;case 7:c=a.name;(e=a.foreign)&&!Object.prototype.hasOwnProperty.call(b.Cosy.foreignFunctions.h,c.lexeme)&&b.Cosy.error(b.ErrorDataType.Token(c),"Foreign function not set.");this.declare(c);this.define(c);this.resolveFunction(c,a.params,a.body,b.phases._Resolver.FunctionType.Function,e);break;case 8:c=a.el;this.resolveExpr(a.cond);this.resolveStmt(a.then);null!=c&&this.resolveStmt(c);break;case 9:this.resolveExpr(a.e);
break;case 10:c=a.keyword;a=a.value;this.currentFunction==b.phases._Resolver.FunctionType.None&&b.Cosy.error(b.ErrorDataType.Token(c),"Cannot return from top-level code.");null!=a&&(this.currentFunction==b.phases._Resolver.FunctionType.Initializer&&b.Cosy.error(b.ErrorDataType.Token(c),"Cannot return value from an initializer."),this.resolveExpr(a));break;case 11:c=a.name;this.declare(c);this.define(c);this.currentStruct=b.phases._Resolver.StructType.Struct;this.beginScope();this.resolveStmts(a.declarations);
this.endScope();this.currentStruct=b.phases._Resolver.StructType.None;break;case 12:c=a.name;e=a.init;var d=a.mut;a.foreign&&!Object.prototype.hasOwnProperty.call(b.Cosy.foreignVariables.h,c.lexeme)&&b.Cosy.error(b.ErrorDataType.Token(c),"Foreign variable not set.");var f=1==this.currentStruct._hx_index;this.markTypeAsRead(a.type);this.declare(c,d,f);null!=e?this.resolveExpr(e):d||f||b.Cosy.error(b.ErrorDataType.Token(c),"Non-mutable variables must be initialized.");this.define(c,d,f)}};d.prototype.resolveExpr=
function(a){switch(a._hx_index){case 0:a=a.exprs;for(var c=0;c<a.length;)this.resolveExpr(a[c++]);break;case 1:c=a.name;var e=this.findInScopes(c);null==e||e.mutable||b.Cosy.error(b.ErrorDataType.Token(c),"Cannot reassign non-mutable variable.");this.resolveExpr(a.value);this.resolveLocal(a,c,!1);break;case 2:this.resolveExpr(a.left);this.resolveExpr(a.right);break;case 3:c=a.$arguments;this.resolveExpr(a.callee);for(a=0;a<c.length;)this.resolveExpr(c[a++]);break;case 4:this.resolveExpr(a.obj);break;
case 5:this.resolveExpr(a.e);break;case 7:this.resolveExpr(a.left);this.resolveExpr(a.right);break;case 8:this.resolveLocal(a,a.name,!0);break;case 9:e=a.obj;c=a.name;this.resolveExpr(a.value);this.resolveExpr(e);switch(e._hx_index){case 4:break;case 12:a=this.findInScopes(e.name);null==a||a.mutable||b.Cosy.error(b.ErrorDataType.Token(c),"Cannot reassign properties on non-mutable struct.");break;default:throw h.Exception.thrown("this is unexpected");}break;case 10:c=a.name;e=a.decls;for(var d=0;d<
e.length;){var f=e[d];++d;1==f._hx_index&&this.resolveExpr(f.value)}this.resolveLocal(a,c,!0);break;case 11:this.resolveExpr(a.right);break;case 12:c=a.name;e=this.scopes;Object.prototype.hasOwnProperty.call(e[e.length-1].h,c.lexeme)?(e=this.scopes,e=0==e[e.length-1].h[c.lexeme].state._hx_index):e=!1;e&&b.Cosy.error(b.ErrorDataType.Token(c),"Cannot read local variable in its own initializer");c.lexeme.startsWith("_")&&b.Cosy.error(b.ErrorDataType.Token(c),"Variables starting with _ are considered unused.");
this.resolveLocal(a,c,!0);break;case 13:this.resolveFunction(null,a.params,a.body,b.phases._Resolver.FunctionType.Function,!1)}};d.prototype.markTypeAsRead=function(a){switch(a._hx_index){case 7:this.markTypeAsRead(a.type);break;case 9:a=a.name;for(var c=this.scopes.length-1;0<=c;){var e=this.scopes[c];if(Object.prototype.hasOwnProperty.call(e.h,a)){e.h[a].state=b.phases._Resolver.VariableState.Read;break}--c}}};d.prototype.resolveFunction=function(a,b,e,d,f){a=this.currentFunction;this.currentFunction=
d;this.beginScope();for(d=0;d<b.length;){var c=b[d];++d;var g=10==c.type._hx_index;this.declare(c.name,g);f||this.define(c.name,g)}this.resolveStmts(e);this.endScope();this.currentFunction=a};d.prototype.beginScope=function(){this.scopes.push(new h.ds.StringMap)};d.prototype.endScope=function(){for(var a=this.scopes.pop().h,c=Object.keys(a),e=c.length,d=0;d<e;){var f=a[c[d++]];f.name.lexeme.startsWith("_")||f.member||1!=f.state._hx_index||b.Cosy.error(b.ErrorDataType.Token(f.name),"Local variable is not used.")}};
d.prototype.declare=function(a,c,e){null==e&&(e=!1);null==c&&(c=!1);var d=this.scopes;d=d[d.length-1];Object.prototype.hasOwnProperty.call(d.h,a.lexeme)?b.Cosy.error(b.ErrorDataType.Token(a),"Variable with this name already declared in this scope."):null!=this.findInScopes(a)&&b.Cosy.error(b.ErrorDataType.Token(a),"Shadows existing variable.");d.h[a.lexeme]={name:a,state:b.phases._Resolver.VariableState.Declared,mutable:c,member:e}};d.prototype.define=function(a,c,e){null==e&&(e=!1);null==c&&(c=!1);
var d=this.scopes;d[d.length-1].h[a.lexeme]={name:a,state:b.phases._Resolver.VariableState.Defined,mutable:c,member:e}};d.prototype.resolveLocal=function(a,c,e){for(var d=[],f=this.scopes.length-1;0<=f;){var g=this.scopes[f];if(Object.prototype.hasOwnProperty.call(g.h,c.lexeme)){this.interpreter.resolve(a,this.scopes.length-1-f);e&&(g.h[c.lexeme].state=b.phases._Resolver.VariableState.Read);return}g=Object.keys(g.h);for(var h=g.length,k=0;k<h;)d.push(g[k++]);--f}if("clock"!=c.lexeme&&"random"!=c.lexeme){a=
b.EditDistance.bestMatches(c.lexeme,d);e="Variable not declared in this scope.";if(0<a.length){e=Array(a.length);d=0;for(f=a.length;d<f;)g=d++,e[g]='"'+a[g]+'"';a=e.pop();e="Variable not declared in this scope."+(" Did you mean "+(0<e.length?e.join(", ")+" or "+a:a)+"?")}b.Cosy.error(b.ErrorDataType.Token(c),e)}};d.prototype.findInScopes=function(a){a=a.lexeme;for(var b=this.scopes.length-1;0<=b;){var e=this.scopes[b];if(Object.prototype.hasOwnProperty.call(e.h,a))return e.h[a];--b}return null};b.phases.Resolver=
d;b.phases.Resolver.__name__=!0;Object.assign(b.phases.Resolver.prototype,{__class__:b.phases.Resolver});b.phases._Resolver={};b.phases._Resolver.VariableState=v["cosy.phases._Resolver.VariableState"]={__ename__:!0,__constructs__:null,Declared:{_hx_name:"Declared",_hx_index:0,__enum__:"cosy.phases._Resolver.VariableState",toString:g},Defined:{_hx_name:"Defined",_hx_index:1,__enum__:"cosy.phases._Resolver.VariableState",toString:g},Read:{_hx_name:"Read",_hx_index:2,__enum__:"cosy.phases._Resolver.VariableState",
toString:g}};b.phases._Resolver.VariableState.__constructs__=[b.phases._Resolver.VariableState.Declared,b.phases._Resolver.VariableState.Defined,b.phases._Resolver.VariableState.Read];b.phases._Resolver.FunctionType=v["cosy.phases._Resolver.FunctionType"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",_hx_index:0,__enum__:"cosy.phases._Resolver.FunctionType",toString:g},Method:{_hx_name:"Method",_hx_index:1,__enum__:"cosy.phases._Resolver.FunctionType",toString:g},Initializer:{_hx_name:"Initializer",
_hx_index:2,__enum__:"cosy.phases._Resolver.FunctionType",toString:g},Function:{_hx_name:"Function",_hx_index:3,__enum__:"cosy.phases._Resolver.FunctionType",toString:g}};b.phases._Resolver.FunctionType.__constructs__=[b.phases._Resolver.FunctionType.None,b.phases._Resolver.FunctionType.Method,b.phases._Resolver.FunctionType.Initializer,b.phases._Resolver.FunctionType.Function];b.phases._Resolver.StructType=v["cosy.phases._Resolver.StructType"]={__ename__:!0,__constructs__:null,None:{_hx_name:"None",
_hx_index:0,__enum__:"cosy.phases._Resolver.StructType",toString:g},Struct:{_hx_name:"Struct",_hx_index:1,__enum__:"cosy.phases._Resolver.StructType",toString:g}};b.phases._Resolver.StructType.__constructs__=[b.phases._Resolver.StructType.None,b.phases._Resolver.StructType.Struct];d=function(a){this.line=1;this.start=this.current=0;this.tokens=[];this.source=a};d.prototype.scanTokens=function(){for(;this.current<this.source.length;){this.start=this.current;var a=this.advance();switch(a){case 10:this.line++;
break;case 9:case 13:case 32:break;case 33:a=this.match(61)?b.TokenType.BangEqual:b.TokenType.Bang;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 39:this.string();break;case 40:this.tokens.push(new b.Token(b.TokenType.LeftParen,this.source.substring(this.start,this.current),null,this.line));break;case 41:this.tokens.push(new b.Token(b.TokenType.RightParen,this.source.substring(this.start,this.current),null,this.line));break;case 42:a=this.match(61)?
b.TokenType.StarEqual:b.TokenType.Star;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 43:a=this.match(61)?b.TokenType.PlusEqual:b.TokenType.Plus;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 44:this.tokens.push(new b.Token(b.TokenType.Comma,this.source.substring(this.start,this.current),null,this.line));break;case 45:a=this.match(61)?b.TokenType.MinusEqual:b.TokenType.Minus;this.tokens.push(new b.Token(a,
this.source.substring(this.start,this.current),null,this.line));break;case 46:a=this.match(46)?b.TokenType.DotDot:b.TokenType.Dot;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 47:if(this.match(47))for(;10!=(this.current>=this.source.length?0:r.cca(this.source,this.current))&&this.current<this.source.length;)this.advance();else a=this.match(61)?b.TokenType.SlashEqual:b.TokenType.Slash,this.tokens.push(new b.Token(a,this.source.substring(this.start,
this.current),null,this.line));break;case 60:a=this.match(61)?b.TokenType.LessEqual:b.TokenType.Less;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 61:a=this.match(61)?b.TokenType.EqualEqual:b.TokenType.Equal;this.tokens.push(new b.Token(a,this.source.substring(this.start,this.current),null,this.line));break;case 62:a=this.match(61)?b.TokenType.GreaterEqual:b.TokenType.Greater;this.tokens.push(new b.Token(a,this.source.substring(this.start,
this.current),null,this.line));break;case 91:this.tokens.push(new b.Token(b.TokenType.LeftBracket,this.source.substring(this.start,this.current),null,this.line));break;case 93:this.tokens.push(new b.Token(b.TokenType.RightBracket,this.source.substring(this.start,this.current),null,this.line));break;case 95:var c=this.current>=this.source.length?0:r.cca(this.source,this.current);97<=c&&122>=c||65<=c&&90>=c||95==c?48<=a&&57>=a?this.number():97<=a&&122>=a||65<=a&&90>=a||95==a?this.identifier():b.Cosy.error(b.ErrorDataType.Line(this.line),
"Unexpected character: "+String.fromCodePoint(a)):this.tokens.push(new b.Token(b.TokenType.Underscore,this.source.substring(this.start,this.current),null,this.line));break;case 123:this.tokens.push(new b.Token(b.TokenType.LeftBrace,this.source.substring(this.start,this.current),null,this.line));break;case 125:this.tokens.push(new b.Token(b.TokenType.RightBrace,this.source.substring(this.start,this.current),null,this.line));break;default:48<=a&&57>=a?this.number():97<=a&&122>=a||65<=a&&90>=a||95==
a?this.identifier():b.Cosy.error(b.ErrorDataType.Line(this.line),"Unexpected character: "+String.fromCodePoint(a))}}this.tokens.push(new b.Token(b.TokenType.Eof,"",null,this.line));return this.tokens};d.prototype.identifier=function(){for(;;){var a=this.current>=this.source.length?0:r.cca(this.source,this.current);if(!(97<=a&&122>=a||65<=a&&90>=a||95==a||48<=a&&57>=a))break;this.advance()}a=b.phases.Scanner.keywords.h[this.source.substring(this.start,this.current)];this.tokens.push(new b.Token(null==
a?b.TokenType.Identifier:a,this.source.substring(this.start,this.current),null,this.line))};d.prototype.string=function(){for(;(39!=(this.current>=this.source.length?0:r.cca(this.source,this.current))||92==(this.current-1>=this.source.length?0:r.cca(this.source,this.current-1)))&&this.current<this.source.length;)10==(this.current>=this.source.length?0:r.cca(this.source,this.current))&&this.line++,this.advance();if(this.current>=this.source.length)b.Cosy.error(b.ErrorDataType.Line(this.line),"Unterminated string.");
else{this.advance();var a=this.source.substring(this.start+1,this.current-1);a=x.replace(a,"\\n","\n");a=x.replace(a,"\\'","'");this.tokens.push(new b.Token(b.TokenType.String,this.source.substring(this.start,this.current),a,this.line))}};d.prototype.number=function(){for(;;){var a=this.current>=this.source.length?0:r.cca(this.source,this.current);if(!(48<=a&&57>=a))break;this.advance()}46==(this.current>=this.source.length?0:r.cca(this.source,this.current))?(a=this.current+1>=this.source.length?
0:r.cca(this.source,this.current+1),a=48<=a&&57>=a):a=!1;if(a)for(this.advance();;){a=this.current>=this.source.length?0:r.cca(this.source,this.current);if(!(48<=a&&57>=a))break;this.advance()}a=parseFloat(this.source.substring(this.start,this.current));this.tokens.push(new b.Token(b.TokenType.Number,this.source.substring(this.start,this.current),a,this.line))};d.prototype.match=function(a){if(this.current>=this.source.length||r.cca(this.source,this.current)!=a)return!1;this.current++;return!0};d.prototype.advance=
function(){this.current++;return r.cca(this.source,this.current-1)};b.phases.Scanner=d;b.phases.Scanner.__name__=!0;Object.assign(b.phases.Scanner.prototype,{__class__:b.phases.Scanner});d=function(){this.inferredReturnType=b.VariableType.Void;this.typedReturnType=b.VariableType.Unknown;this.variableTypes=new h.ds.StringMap;this.structsMeta=new h.ds.StringMap;this.variableTypes.h.clock=b.VariableType.Function([],b.VariableType.Number);this.variableTypes.h.random=b.VariableType.Function([],b.VariableType.Number)};
d.prototype.typeStmt=function(a){switch(a._hx_index){case 0:a=a.statements;for(var c=0;c<a.length;)this.typeStmt(a[c++]);break;case 3:this.typeExpr(a.e);break;case 4:var e=a.keyword,d=a.name,f=a.to;c=a.body;switch(this.typeExpr(a.from)._hx_index){case 0:b.Cosy.warning(b.ErrorDataType.Token(e),'"From" clause has type Unknown');break;case 3:break;default:b.Cosy.error(b.ErrorDataType.Token(e),'"From" clause must evaluate to a number')}switch(this.typeExpr(f)._hx_index){case 0:b.Cosy.warning(b.ErrorDataType.Token(e),
'"To" clause has type Unknown');break;case 3:break;default:b.Cosy.error(b.ErrorDataType.Token(e),'"To" clause must evaluate to a number')}null!=d&&(this.variableTypes.h[d.lexeme]=b.VariableType.Number);for(a=0;a<c.length;)this.typeStmt(c[a++]);break;case 5:e=a.name;c=a.body;a=this.typeExpr(a.array);switch(a._hx_index){case 0:this.variableTypes.h[e.lexeme]=b.VariableType.Unknown;break;case 7:this.variableTypes.h[e.lexeme]=a.type;break;case 10:a=a.type;7==a._hx_index?this.variableTypes.h[e.lexeme]=
a.type:b.Cosy.error(b.ErrorDataType.Token(e),"Can only loop over value of type array.");break;default:b.Cosy.error(b.ErrorDataType.Token(e),"Can only loop over value of type array.")}for(a=0;a<c.length;)this.typeStmt(c[a++]);break;case 6:a=a.body;for(c=0;c<a.length;)this.typeStmt(a[c++]);break;case 7:this.handleFunc(a.name,a.params,a.body,a.returnType,a.foreign);break;case 8:c=a.el;this.typeStmt(a.then);null!=c&&this.typeStmt(c);break;case 9:1==this.typeExpr(a.e)._hx_index&&b.Cosy.error(b.ErrorDataType.Token(a.keyword),
"Cannot print values of type void.");break;case 10:c=a.value;this.inferredReturnType=null!=c?this.typeExpr(c):b.VariableType.Void;this.matchType(this.inferredReturnType,this.typedReturnType)||b.Cosy.error(b.ErrorDataType.Token(a.keyword),"Function expected to return "+this.formatType(this.typedReturnType)+" but got "+this.formatType(this.inferredReturnType));break;case 11:c=a.name;a=a.declarations;e={members:new h.ds.StringMap};d=new h.ds.StringMap;for(f=0;f<a.length;){var g=a[f];++f;if(12==g._hx_index){var k=
g.name,q=g.init,n=g.mut;e.members.h[k.lexeme]={mutable:n,initialized:null!=q};g=this.typeVar(k,g.type,q);n&&(g=b.VariableType.Mutable(g));d.h[k.lexeme]=g}else throw h.Exception.thrown("structs can only have var and mut");}this.structsMeta.h[c.lexeme]=e;this.variableTypes.h[c.lexeme]=b.VariableType.Struct(d);break;case 12:c=a.name,e=this.typeVar(c,a.type,a.init),a.mut&&(e=b.VariableType.Mutable(e)),this.variableTypes.h[c.lexeme]=e}};d.prototype.typeVar=function(a,c,e){var d=null!=e?this.typeExpr(e):
b.VariableType.Unknown;1==d._hx_index&&b.Cosy.error(b.ErrorDataType.Token(a),"Cannot assign Void to a variable");null==e||this.matchType(d,c)||b.Cosy.error(b.ErrorDataType.Token(a),"Expected variable to have type "+this.formatType(c)+" but got "+this.formatType(d)+".");return 0!=c._hx_index?c:d};d.prototype.typeExpr=function(a){switch(a._hx_index){case 0:var c=a.keyword;a=a.exprs;for(var e=b.VariableType.Unknown,d=0,f=a.length;d<f;){var g=d++,k=this.typeExpr(a[g]);0!=k._hx_index&&(0==e._hx_index?
e=k:this.matchType(k,e)||b.Cosy.error(b.ErrorDataType.Token(c),"Array values expected to be "+this.formatType(e)+" but got "+this.formatType(k)+" at index "+g+"."))}return b.VariableType.Array(e);case 1:return c=a.name,a=this.typeExpr(a.value),e=this.variableTypes.h[c.lexeme],(null==e?0:0==e._hx_index)||(null==e?0:10==e._hx_index&&0==e.type._hx_index)?this.variableTypes.h[c.lexeme]=a:this.matchType(e,a)||b.Cosy.error(b.ErrorDataType.Token(c),"Cannot assign "+this.formatType(a)+" to "+this.formatType(e,
!1)),a;case 2:e=a.left;c=a.right;switch(a.op.type._hx_index){case 10:case 14:case 16:c=b.VariableType.Number;break;case 12:e=this.typeExpr(e);c=this.typeExpr(c);if(4==e._hx_index||4==c._hx_index)return b.VariableType.Text;if(3==e._hx_index||3==c._hx_index)return b.VariableType.Number;c=b.VariableType.Unknown;break;case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:c=b.VariableType.Boolean;break;default:throw h.Exception.thrown("should never happen");}break;case 3:c=a.paren;g=a.$arguments;
f=this.typeExpr(a.callee);10==f._hx_index&&(f=f.type);e=b.VariableType.Unknown;switch(f._hx_index){case 0:b.Cosy.strict&&b.Cosy.error(b.ErrorDataType.Token(c),"[strict] Undefined type.");break;case 6:d=f.paramTypes;e=f.returnType;f=[];for(k=0;k<g.length;)f.push(this.typeExpr(g[k++]));if(g.length!=d.length)b.Cosy.error(b.ErrorDataType.Token(c),"Expected "+d.length+" argument(s) but got "+g.length+".");else for(g=0,k=d.length;g<k;){var q=g++;0==f[q]._hx_index&&b.Cosy.warning(b.ErrorDataType.Token(c),
"Argument "+(q+1)+" has type Unknown.");this.matchType(f[q],d[q])||b.Cosy.error(b.ErrorDataType.Token(c),"Expected argument "+(q+1)+" to be "+this.formatType(d[q])+" but got "+this.formatType(f[q])+".")}}c=e;break;case 4:switch(c=a.name,a=this.typeExpr(a.obj),a._hx_index){case 4:switch(c.lexeme){case "charAt":return b.VariableType.Function([b.VariableType.Number],b.VariableType.Text);case "length":return b.VariableType.Number;case "replace":return b.VariableType.Function([b.VariableType.Text,b.VariableType.Text],
b.VariableType.Text);case "split":return b.VariableType.Function([b.VariableType.Text],b.VariableType.Array(b.VariableType.Text));case "substr":return b.VariableType.Function([b.VariableType.Number,b.VariableType.Number],b.VariableType.Text);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),b.VariableType.Void}case 7:switch(a=a.type,c.lexeme){case "concat":return b.Cosy.error(b.ErrorDataType.Token(c),"Cannot call mutating method on immutable array."),b.VariableType.Void;
case "count":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Boolean)],b.VariableType.Number);case "filter":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Boolean)],b.VariableType.Array(a));case "get":return b.VariableType.Function([b.VariableType.Number],a);case "length":return b.VariableType.Number;case "map":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Unknown)],b.VariableType.Array(b.VariableType.Unknown));case "pop":return b.Cosy.error(b.ErrorDataType.Token(c),
"Cannot call mutating method on immutable array."),b.VariableType.Void;case "push":return b.Cosy.error(b.ErrorDataType.Token(c),"Cannot call mutating method on immutable array."),b.VariableType.Void;case "sort":return b.VariableType.Function([b.VariableType.Function([a,a],b.VariableType.Number)],b.VariableType.Array(a));case "sum":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Number)],b.VariableType.Number);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),
b.VariableType.Void}case 8:e=a.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 9:e=this.variableTypes.h[a.name];if(null==e)throw h.Exception.thrown("Get on unknown type "+t.string(a));switch(e._hx_index){case 8:e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),
'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 10:e=e.type;if(8==e._hx_index){e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown}throw h.Exception.thrown("Get on unknown type "+t.string(a));default:throw h.Exception.thrown("Get on unknown type "+t.string(a));
}case 10:switch(e=a.type,e._hx_index){case 4:switch(c.lexeme){case "charAt":return b.VariableType.Function([b.VariableType.Number],b.VariableType.Text);case "length":return b.VariableType.Number;case "replace":return b.VariableType.Function([b.VariableType.Text,b.VariableType.Text],b.VariableType.Text);case "split":return b.VariableType.Function([b.VariableType.Text],b.VariableType.Array(b.VariableType.Text));case "substr":return b.VariableType.Function([b.VariableType.Number,b.VariableType.Number],
b.VariableType.Text);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),b.VariableType.Void}case 7:switch(a=e.type,c.lexeme){case "concat":return b.VariableType.Function([b.VariableType.Array(a)],b.VariableType.Void);case "count":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Boolean)],b.VariableType.Number);case "filter":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Boolean)],b.VariableType.Array(a));
case "get":return b.VariableType.Function([b.VariableType.Number],a);case "length":return b.VariableType.Number;case "map":return b.VariableType.Function([b.VariableType.Function([a],b.VariableType.Unknown)],b.VariableType.Array(b.VariableType.Unknown));case "pop":return b.VariableType.Function([],a);case "push":return b.VariableType.Function([a],b.VariableType.Void);case "sort":return b.VariableType.Function([b.VariableType.Function([a,a],b.VariableType.Number)],b.VariableType.Array(a));case "sum":return b.VariableType.Function([b.VariableType.Function([a],
b.VariableType.Number)],b.VariableType.Number);default:return b.Cosy.error(b.ErrorDataType.Token(c),"Unknown array property or function."),b.VariableType.Void}case 8:e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 9:e=this.variableTypes.h[e.name];if(null==e)throw h.Exception.thrown("Get on unknown type "+t.string(a));
switch(e._hx_index){case 8:e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown;case 10:e=e.type;if(8==e._hx_index){e=e.variables;if(Object.prototype.hasOwnProperty.call(e.h,c.lexeme))return e.h[c.lexeme];b.Cosy.error(b.ErrorDataType.Token(c),'No member named "'+c.lexeme+'" in struct of type '+this.formatType(a,!1));return b.VariableType.Unknown}throw h.Exception.thrown("Get on unknown type "+
t.string(a));default:throw h.Exception.thrown("Get on unknown type "+t.string(a));}default:throw h.Exception.thrown('Get "'+c.lexeme+'" on unknown type '+t.string(a));}default:throw h.Exception.thrown('Get "'+c.lexeme+'" on unknown type '+t.string(a));}case 5:c=this.typeExpr(a.e);break;case 6:c=a.v;c="number"==typeof c?b.VariableType.Number:"string"==typeof c?b.VariableType.Text:"boolean"==typeof c?b.VariableType.Boolean:b.VariableType.Unknown;break;case 7:c=b.VariableType.Boolean;break;case 8:c=
a.name;e=b.VariableType.Mutable(this.variableTypes.h[c.lexeme]);d=e.type;10==d._hx_index?8!=d.type._hx_index&&b.Cosy.error(b.ErrorDataType.Token(c),'Only mutable structs can be passed as "mut". You passed '+this.formatType(e,!1)+"."):b.Cosy.error(b.ErrorDataType.Token(c),'Only mutable structs can be passed as "mut". You passed '+this.formatType(e,!1)+".");c=e;break;case 9:c=a.name;e=a.value;d=this.typeExpr(a.obj);switch(d._hx_index){case 9:d=this.variableTypes.h[d.name];break;case 10:switch(f=d.type,
f._hx_index){case 8:d=b.VariableType.Struct(f.variables);break;case 9:d=this.variableTypes.h[f.name]}}8==d._hx_index&&(f=d.variables,Object.prototype.hasOwnProperty.call(f.h,c.lexeme)?(e=this.typeExpr(e),d=f.h[c.lexeme],f=null==d?d:10==d._hx_index?d.type:d,(null==d?0:10==d._hx_index)?this.matchType(e,f)||b.Cosy.error(b.ErrorDataType.Token(c),"Expected value of type "+this.formatType(f)+" but got "+this.formatType(e)):b.Cosy.error(b.ErrorDataType.Token(c),"Member is not mutable.")):b.Cosy.error(b.ErrorDataType.Token(c),
'No member named "'+c.lexeme+'" in struct of type '+this.formatType(d,!1)));c=b.VariableType.Unknown;break;case 10:c=a.name;f=a.decls;e=this.variableTypes.h[c.lexeme];d=[];if(null==e)throw h.Exception.thrown("unexpected");if(8==e._hx_index)g=e.variables;else throw h.Exception.thrown("unexpected");for(k=0;k<f.length;){var n=f[k];++k;if(1==n._hx_index){q=n.name;if(!Object.prototype.hasOwnProperty.call(g.h,q.lexeme)){b.Cosy.error(b.ErrorDataType.Token(q),'No member named "'+q.lexeme+'" in struct '+c.lexeme);
break}else if(-1!=d.indexOf(q.lexeme)){b.Cosy.error(b.ErrorDataType.Token(q),"Member already assigned in initializer.");break}n=this.typeExpr(n.value);var p=g.h[q.lexeme];p=null==p?p:10==p._hx_index?p.type:p;d.push(q.lexeme);this.matchType(n,p)||b.Cosy.error(b.ErrorDataType.Token(q),"Expected value to be of type "+this.formatType(p)+" but got "+this.formatType(n))}else throw h.Exception.thrown("unexpected");}f=this.structsMeta.h[c.lexeme].members.h;g=Object.keys(f);k=g.length;for(q=0;q<k;)n=g[q++],
f[n].initialized||-1==d.indexOf(n)&&b.Cosy.error(b.ErrorDataType.Token(c),'Member "'+n+'" not initialized.');c=e;break;case 11:switch(a.op.type._hx_index){case 10:c=b.VariableType.Number;break;case 18:c=b.VariableType.Boolean;break;default:throw h.Exception.thrown("should never happen");}break;case 12:return a=a.name,Object.prototype.hasOwnProperty.call(this.variableTypes.h,a.lexeme)?this.variableTypes.h[a.lexeme]:b.VariableType.Unknown;case 13:c=this.handleFunc(null,a.params,a.body,a.returnType,
!1)}b.Cosy.strict&&(null==c?0:0==c._hx_index)&&(3==a._hx_index?b.Cosy.error(b.ErrorDataType.Token(a.paren),"[strict] "+v[a.__enum__].__constructs__[a._hx_index]._hx_name+" has unknown type."):b.Cosy.warning(b.ErrorDataType.Line(-1),"[strict] "+v[a.__enum__].__constructs__[a._hx_index]._hx_name+" has unknown type."));return c};d.prototype.handleFunc=function(a,c,e,d,f){if(b.Cosy.strict)for(var g=0,h=c.length;g<h;){var l=g++;0==c[l].type._hx_index&&b.Cosy.error(b.ErrorDataType.Token(c[l].name),"[strict] Parameter has unknown type.")}g=
[];for(h=0;h<c.length;)g.push(c[h++].type);for(h=0;h<c.length;)l=c[h],++h,this.variableTypes.h[l.name.lexeme]=l.type;this.typedReturnType=d;this.inferredReturnType=b.VariableType.Void;for(c=0;c<e.length;)this.typeStmt(e[c++]);e=0==d._hx_index?f?d:this.inferredReturnType:d;null!=a&&(this.variableTypes.h[a.lexeme]=b.VariableType.Function(g,e));return b.VariableType.Function(g,e)};d.prototype.matchType=function(a,b){switch(b._hx_index){case 0:return!0;case 6:var c=b.paramTypes,d=b.returnType;switch(a._hx_index){case 6:b=
a.paramTypes;a=a.returnType;if(b.length!=c.length)return!1;for(var f=0,g=b.length;f<g;){var h=f++;if(!this.matchType(b[h],c[h]))return!1}return this.matchType(a,d);case 10:return this.matchType(a.type,b);default:return a==b}case 7:switch(c=b.type,a._hx_index){case 7:return d=a.type,0==d._hx_index?!0:this.matchType(d,c);case 10:return this.matchType(a.type,b);default:return a==b}case 8:switch(d=b.variables,a._hx_index){case 8:c=a.variables;a=c.h;b=Object.keys(a);f=b.length;for(g=0;g<f;){h=b[g++];var k=
a[h];if(!Object.prototype.hasOwnProperty.call(d.h,h)||d.h[h]!=k)return!1}d=d.h;a=Object.keys(d);b=a.length;for(f=0;f<b;)if(g=a[f++],h=d[g],!Object.prototype.hasOwnProperty.call(c.h,g)||c.h[g]!=h)return!1;return!0;case 10:return this.matchType(a.type,b);default:return a==b}case 9:switch(c=b.name,a._hx_index){case 9:return this.matchType(this.variableTypes.h[a.name],this.variableTypes.h[c]);case 10:return this.matchType(a,this.variableTypes.h[c]);default:return this.matchType(a,this.variableTypes.h[c])}case 10:return 10==
a._hx_index?this.matchType(a.type,b.type):a==b;default:return 10==a._hx_index?this.matchType(a.type,b):a==b}};d.prototype.formatType=function(a,b){null==b&&(b=!0);switch(a._hx_index){case 2:return"Bool";case 3:return"Num";case 4:return"Str";case 6:var c=a.paramTypes;b=a.returnType;a=[];for(var d=0;d<c.length;)a.push(this.formatType(c[d++]));c=1==b._hx_index?"":" -> "+this.formatType(b);c="Fn("+a.join(", ")+")"+c;return 1==b._hx_index?c:"("+c+")";case 7:return b=a.type,0==b._hx_index?"Array":"Array("+
this.formatType(b)+")";case 8:b=[];c=a.variables.h;a=Object.keys(c);d=a.length;for(var f=0;f<d;){var g=a[f++];b.push(""+g+" "+this.formatType(c[g]))}b.sort(function(a,b){return a<b?-1:b<a?1:0});return"Struct { "+b.join(", ")+" }";case 9:return this.formatType(this.variableTypes.h[a.name]);case 10:return c=a.type,b?"Mut("+this.formatType(c)+")":this.formatType(c);default:return""+t.string(a)}};b.phases.Typer=d;b.phases.Typer.__name__=!0;Object.assign(b.phases.Typer.prototype,{__class__:b.phases.Typer});
var h={IMap:function(){}};h.IMap.__name__=!0;d=function(a,b,d){var c=Error.call(this,a);this.message=c.message;"stack"in c&&(this.stack=c.stack);this.message=a;this.__previousException=b;this.__nativeException=null!=d?d:this};$jscomp.inherits(d,Error);d.prototype.unwrap=function(){return this.__nativeException};d.prototype.get_native=function(){return this.__nativeException};d.caught=function(a){return a instanceof h.Exception?a:a instanceof Error?new h.Exception(a.message,null,a):new h.ValueException(a,
null,a)};d.thrown=function(a){return a instanceof h.Exception?a.get_native():a instanceof Error?a:new h.ValueException(a)};h.Exception=d;h.Exception.__name__=!0;h.Exception.__super__=Error;Object.assign(h.Exception.prototype,{__class__:h.Exception});d=function(a,b,d){b=h.Exception.call(this,String(a),b,d)||this;b.value=a;return b};$jscomp.inherits(d,h.Exception);d.__super__=h.Exception.__super__;d.prototype.unwrap=function(){return this.value};h.ValueException=d;h.ValueException.__name__=!0;h.ValueException.__super__=
h.Exception;Object.assign(h.ValueException.prototype,{__class__:h.ValueException});h.ds={};d=function(){this.h={__keys__:{}}};d.prototype.set=function(a,b){var c=a.__id__;null==c&&(c=a.__id__=n.$haxeUID++);this.h[c]=b;this.h.__keys__[c]=a};h.ds.ObjectMap=d;h.ds.ObjectMap.__name__=!0;h.ds.ObjectMap.__interfaces__=[h.IMap];Object.assign(h.ds.ObjectMap.prototype,{__class__:h.ds.ObjectMap});h.ds.StringMap=function(){this.h=Object.create(null)};h.ds.StringMap.__name__=!0;h.ds.StringMap.__interfaces__=
[h.IMap];Object.assign(h.ds.StringMap.prototype,{__class__:h.ds.StringMap});h.io={};d=function(){};d.prototype.toString=function(){return"Eof"};h.io.Eof=d;h.io.Eof.__name__=!0;Object.assign(h.io.Eof.prototype,{__class__:h.io.Eof});h.iterators={};d=function(a){this.current=0;this.array=a};d.prototype.hasNext=function(){return this.current<this.array.length};d.prototype.next=function(){return this.array[this.current++]};h.iterators.ArrayIterator=d;h.iterators.ArrayIterator.__name__=!0;Object.assign(h.iterators.ArrayIterator.prototype,
{__class__:h.iterators.ArrayIterator});var w={};d=function(){};d.getClass=function(a){if(null==a)return null;if(a instanceof Array)return Array;var b=a.__class__;if(null!=b)return b;a=w.Boot.__nativeClassName(a);return null!=a?w.Boot.__resolveNativeClass(a):null};d.__string_rec=function(a,b){if(null==a)return"null";if(5<=b.length)return"<...>";var c=typeof a;"function"==c&&(a.__name__||a.__ename__)&&(c="object");switch(c){case "function":return"<function>";case "object":if(a.__enum__){var d=v[a.__enum__].__constructs__[a._hx_index];
c=d._hx_name;if(d.__params__){b+="\t";var f=[],g=0;for(d=d.__params__;g<d.length;){var h=d[g];g+=1;f.push(w.Boot.__string_rec(a[h],b))}return c+"("+f.join(",")+")"}return c}if(a instanceof Array){c="[";b+="\t";f=0;for(g=a.length;f<g;)d=f++,c+=(0<d?",":"")+w.Boot.__string_rec(a[d],b);return c+"]"}try{f=a.toString}catch(q){return"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f&&(c=a.toString(),"[object Object]"!=c))return c;c="{\n";b+="\t";f=null!=a.hasOwnProperty;g=null;for(g in a)f&&!a.hasOwnProperty(g)||
"prototype"==g||"__class__"==g||"__super__"==g||"__interfaces__"==g||"__properties__"==g||(2!=c.length&&(c+=", \n"),c+=b+g+" : "+w.Boot.__string_rec(a[g],b));b=b.substring(1);return c+("\n"+b+"}");case "string":return a;default:return String(a)}};d.__interfLoop=function(a,b){for(;;){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c&&(null==a.__super__||a.__super__.__interfaces__!=c))for(var d=0,f=c.length;d<f;){var g=c[d++];if(g==b||w.Boot.__interfLoop(g,b))return!0}a=a.__super__}};
d.__implements=function(a,b){return w.Boot.__interfLoop(w.Boot.getClass(a),b)};d.__nativeClassName=function(a){a=w.Boot.__toStr.call(a).slice(8,-1);return"Object"==a||"Function"==a||"Math"==a||"JSON"==a?null:a};d.__resolveNativeClass=function(a){return n[a]};w.Boot=d;w.Boot.__name__=!0;n.$haxeUID|=0;"undefined"!=typeof performance&&"function"==typeof performance.now&&(r.now=performance.now.bind(performance));null==String.fromCodePoint&&(String.fromCodePoint=function(a){return 65536>a?String.fromCharCode(a):
String.fromCharCode((a>>10)+55232)+String.fromCharCode((a&1023)+56320)});String.prototype.__class__=String;String.__name__=!0;Array.__name__=!0;h.ds.ObjectMap.count=0;w.Boot.__toStr={}.toString;b.phases.Interpreter.__meta__={fields:{evaluate:{SuppressWarnings:["checkstyle:CyclomaticComplexity","checkstyle:NestedControlFlow","checkstyle:MethodLength"]}}};b.phases.Interpreter.uninitialized={};b.Cosy.interpreter=new b.phases.Interpreter;b.Cosy.foreignFunctions=new h.ds.StringMap;b.Cosy.foreignVariables=
new h.ds.StringMap;b.Cosy.hadError=!1;b.Cosy.hadRuntimeError=!1;b.Cosy.outputPrettyPrint=!1;b.Cosy.outputJavaScript=!1;b.Cosy.outputMarkdown=!1;b.Cosy.validateOnly=!1;b.Cosy.outputTimes=!1;b.Cosy.noColors=!1;b.Cosy.strict=!1;b.Cosy.measureStarts=new h.ds.StringMap;b.Cosy.measureOutput="";b.phases.Scanner.keywords=function(a){a=new h.ds.StringMap;a.h.and=b.TokenType.And;a.h["break"]=b.TokenType.Break;a.h["continue"]=b.TokenType.Continue;a.h["else"]=b.TokenType.Else;a.h["false"]=b.TokenType.False;a.h["for"]=
b.TokenType.For;a.h.foreign=b.TokenType.Foreign;a.h.fn=b.TokenType.Fn;a.h["in"]=b.TokenType.In;a.h["if"]=b.TokenType.If;a.h.mut=b.TokenType.Mut;a.h.or=b.TokenType.Or;a.h.print=b.TokenType.Print;a.h["return"]=b.TokenType.Return;a.h.struct=b.TokenType.Struct;a.h["true"]=b.TokenType.True;a.h["var"]=b.TokenType.Var;a.h.Bool=b.TokenType.BooleanType;a.h.Num=b.TokenType.NumberType;a.h.Str=b.TokenType.StringType;a.h.Void=b.TokenType.VoidType;a.h.Fn=b.TokenType.FunctionType;a.h.Array=b.TokenType.ArrayType;
return a}(this);b.Cosy.main()})("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);
